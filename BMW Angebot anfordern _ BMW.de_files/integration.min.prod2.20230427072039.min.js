var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var a=0;return function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var a="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};
(function(b){b&&(b.on("bridgeInitializeComplete",function(){var b=document.getElementById("loadingPage"),d=b.classList.contains("guideLoading");(new MutationObserver(function(b,a){b.filter(function(b){return"class"===b.attributeName}).map(function(b){return b.target.classList.contains("guideLoading")}).forEach(function(b){b!==d&&(performance.mark("form:done"),performance.measure("form","form:start","form:done"),a.disconnect())})})).observe(b,{attributes:!0,childList:!1,subtree:!1})}),performance.mark("form:start"))})(window.guideBridge||
null);(function(b,a){b.bf=b.bf||{};try{var d=a.getElementById(b.bf.configElementId).dataset,e=a.getElementById("business.context.pdh").dataset;b.bf.pdh=Object.freeze(JSON.parse(e.pdhConfig));b.bf.form=Object.freeze(JSON.parse(d.formConfig));b.bf.context=Object.freeze(JSON.parse(d.contextConfig));b.bf.tracking=Object.assign({isReady:!1},JSON.parse(d.trackingConfig));b.bf.runmode=Object.freeze(JSON.parse(d.runmodeConfig));delete b.bf.configElementId}catch(g){console.log(g)}})(window.guidelib,window.document);
guidelib.bf=guidelib.bf||{};guidelib.bf.ws=guidelib.bf.ws||{};
guidelib.bf.ws.Registry={BUSINESS_FORMS_BROCHURE_POOL$GET_BROCHURES_LIST:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/brochure-pool",operationTitle:"GET /brochures/list",operationName:"GET /brochures/list"},BUSINESS_FORMS_GCDM_CURRENT_VEHICLE$GET_CLIENTID_CLIENTVARIANTID_METADATA_VEHICLEBRANDS:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/gcdm-current-vehicle",operationTitle:"GET /{clientId}/{clientVariantId}/metadata/vehicleBrands",operationName:"GET /{clientId}/{clientVariantId}/metadata/vehicleBrands"},
BUSINESS_FORMS_GCDM_CURRENT_VEHICLE$GET_CLIENTID_CLIENTVARIANTID_METADATA_VEHICLEMODELS:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/gcdm-current-vehicle",operationTitle:"GET /{clientId}/{clientVariantId}/metadata/vehicleModels",operationName:"GET /{clientId}/{clientVariantId}/metadata/vehicleModels"},BUSINESS_FORMS_GCDM_CURRENT_VEHICLE$GET_CLIENTID_CLIENTVARIANTID_METADATA_VEHICLETYPES:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/gcdm-current-vehicle",
operationTitle:"GET /{clientId}/{clientVariantId}/metadata/vehicleTypes",operationName:"GET /{clientId}/{clientVariantId}/metadata/vehicleTypes"},BUSINESS_FORMS_GCDM_CUSTOMERS$GET_V4_CLIENTID_CLIENTVARIANTID_CUSTOMERS:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/gcdm-customers",operationTitle:"GET /v4/{clientId}/{clientVariantId}/customers",operationName:"GET /v4/{clientId}/{clientVariantId}/customers"},BUSINESS_FORMS_GCDM_METADATA$GET_CLIENTID_CLIENTVARIANTID_METADATA_VALUELISTS:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/gcdm-metadata",
operationTitle:"GET /{clientId}/{clientVariantId}/metadata/valuelists",operationName:"GET /{clientId}/{clientVariantId}/metadata/valuelists"},BUSINESS_FORMS_GCDM_MORE$POST_V4_CLIENTID_CLIENTVARIANTID_REQUESTS_MORE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/gcdm-more",operationTitle:"POST /v4/{clientId}/{clientVariantId}/requests/more",operationName:"POST /v4/{clientId}/{clientVariantId}/requests/more"},BUSINESS_FORMS_GCDM_POLICY_MANAGER$GET_DOCUMENTS_POLICYDOCUMENTNAME_COUNTRY:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/gcdm-policy-manager",
operationTitle:"GET /documents/{policyDocumentName}/{country}",operationName:"GET /documents/{policyDocumentName}/{country}"},BUSINESS_FORMS_PDH_ANALYTICS$GET_DATAVERSION_TENANT_TIMESTAMP:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-analytics",operationTitle:"GET /dataversion/{tenant}/{timestamp}",operationName:"GET /dataversion/{tenant}/{timestamp}"},BUSINESS_FORMS_PDH_ANALYTICS$GET_MATRIX_TENANT_DATAVERSION:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-analytics",
operationTitle:"GET /matrix/{tenant}/{dataversion}",operationName:"GET /matrix/{tenant}/{dataversion}"},BUSINESS_FORMS_PDH_ANALYTICS$GET_MODEL_TENANT_DATAVERSION_MODEL:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-analytics",operationTitle:"GET /model/{tenant}/{dataversion}/{model}",operationName:"GET /model/{tenant}/{dataversion}/{model}"},BUSINESS_FORMS_PDH_SERVICES$GET_MATRIX_TENANT_DATAVERSION:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-services",
operationTitle:"GET /matrix/{tenant}/{dataversion}",operationName:"GET /matrix/{tenant}/{dataversion}"},BUSINESS_FORMS_PDH_SERVICES$GET_DATAVERSION_TENANT_TIMESTAMP:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-services",operationTitle:"GET /dataversion/{tenant}/{timestamp}",operationName:"GET /dataversion/{tenant}/{timestamp}"},BUSINESS_FORMS_PDH_SERVICES$GET_MARKETOVERVIEW_TENANT_DATAVERSION:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-services",
operationTitle:"GET /marketOverview/{tenant}/{dataversion}",operationName:"GET /marketOverview/{tenant}/{dataversion}"},BUSINESS_FORMS_PDH_SERVICES$GET_SERIESOVERVIEW_TENANT_DATAVERSION_SERIE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-services",operationTitle:"GET /seriesOverview/{tenant}/{dataversion}/{serie}",operationName:"GET /seriesOverview/{tenant}/{dataversion}/{serie}"},BUSINESS_FORMS_PDH_SERVICES$GET_RANGEOVERVIEW_TENANT_DATAVERSION_RANGE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-services",
operationTitle:"GET /rangeOverview/{tenant}/{dataversion}/{range}",operationName:"GET /rangeOverview/{tenant}/{dataversion}/{range}"},BUSINESS_FORMS_PDH_SERVICES$GET_RANGEAGGREGATED_TENANT_DATAVERSION_RANGE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-services",operationTitle:"GET /rangeAggregated/{tenant}/{dataversion}/{range}",operationName:"GET /rangeAggregated/{tenant}/{dataversion}/{range}"},BUSINESS_FORMS_PDH_SERVICES$GET_MODEL_TENANT_DATAVERSION_MODEL:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/pdh-services",
operationTitle:"GET /model/{tenant}/{dataversion}/{model}",operationName:"GET /model/{tenant}/{dataversion}/{model}"},BUSINESS_FORMS_SF_CONFIGURATION_V2$GET_BRANDS_BRAND_COUNTRIES_MARKET_LANGUAGES_LANGUAGE_CONFIGIDS_CONFIGID:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/sf-configuration-v2",operationTitle:"GET /brands/{brand}/countries/{market}/languages/{language}/configids/{configid}",operationName:"GET /brands/{brand}/countries/{market}/languages/{language}/configids/{configid}"},
BUSINESS_FORMS_SF_CONFIGURATION$GET_GARAGEID:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/sf-configuration",operationTitle:"GET /{garageId}",operationName:"GET /{garageId}"},BUSINESS_FORMS_TOLERANT_DATA_QUALITY_SERVICES$GET_PROJECT_PROFILE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/tolerant-data-quality-services",operationTitle:"GET /{project}/{profile}",operationName:"GET /{project}/{profile}"},BUSINESS_FORMS_UCP_GARAGE$GET_CONFIGID:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/ucp-garage",
operationTitle:"GET /{configId}",operationName:"GET /{configId}"},BUSINESS_FORMS_UCP_LOCALISATIONS$GET_MERGED_PHRASES_SOURCES_SOURCE_BRANDS_BRAND_COUNTRIES_COUNTRY_EFFECT_DATES_EFFECTDATE_APPLICATIONS_APPLICATION_MODELS_LANGUAGES_LANGUAGE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/ucp-localisations",operationTitle:"GET /merged-phrases/sources/{source}/brands/{brand}/countries/{country}/effect-dates/{effectDate}/applications/{application}/models/languages/{language}",operationName:"GET /merged-phrases/sources/{source}/brands/{brand}/countries/{country}/effect-dates/{effectDate}/applications/{application}/models/languages/{language}"},
BUSINESS_FORMS_UCP_LOCALISATIONS$GET_OVERRIDDEN_VEHICLE_DATA_SOURCES_SOURCE_BRANDS_BRAND_COUNTRIES_COUNTRY_EFFECT_DATES_EFFECTDATE_ORDER_DATES_ORDERDATE_APPLICATIONS_APPLICATION_MODELS_MODELCODE_OPTIONS_LANGUAGES_LANGUAGE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/ucp-localisations",operationTitle:"GET /overridden-vehicle-data/sources/{source}/brands/{brand}/countries/{country}/effect-dates/{effectDate}/order-dates/{orderDate}/applications/{application}/models/{modelCode}/options/languages/{language}",
operationName:"GET /overridden-vehicle-data/sources/{source}/brands/{brand}/countries/{country}/effect-dates/{effectDate}/order-dates/{orderDate}/applications/{application}/models/{modelCode}/options/languages/{language}"},BUSINESS_FORMS_UCP_PRICING$POST_PRICELISTSIDENTIFIERS_BRANDS_BRAND_COUNTRIES_COUNTRY:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/ucp-pricing",operationTitle:"POST /{priceListsIdentifiers}/brands/{brand}/countries/{country}",operationName:"POST /{priceListsIdentifiers}/brands/{brand}/countries/{country}"},
BUSINESS_FORMS_UCP_SETTINGS$GET_TENANT:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/ucp-settings",operationTitle:"GET /{tenant}",operationName:"GET /{tenant}"},BUSINESS_FORMS_UCP_VEHICLES$GET_SOURCE_BRANDS_BRAND_COUNTRIES_COUNTRY_EFFECT_DATES_EFFECTDATE_ORDER_DATES_ORDERDATE_MODELS_MODELCODE:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/ucp-vehicles",operationTitle:"GET /{source}/brands/{brand}/countries/{country}/effect-dates/{effectDate}/order-dates/{orderDate}/models/{modelCode}",
operationName:"GET /{source}/brands/{brand}/countries/{country}/effect-dates/{effectDate}/order-dates/{orderDate}/models/{modelCode}"},BUSINESS_FORMS_UCP_VEHICLES$GET_SOURCE_BRANDS_BRAND_COUNTRIES_COUNTRY_MODELS:{formDataModelId:"/content/dam/formsanddocuments-fdm/business-forms/ucp-vehicles",operationTitle:"GET /{source}/brands/{brand}/countries/{country}/models",operationName:"GET /{source}/brands/{brand}/countries/{country}/models"}};guidelib.bf=guidelib.bf||{};guidelib.bf.ws=guidelib.bf.ws||{};
guidelib.bf.ws.RemoteUtil=function(b,a,d,e){return{executeFDMOperation:function(g,r,p,q,h,l){g=e.extend({functionToExecute:"invokeFDMOperation",input:JSON.stringify(r)},g);return d.ajax(e.extend({type:"POST",url:a.HTTP.externalize(b.bf.form.resource+".af.dermis"),data:g,dataType:"json",success:p,error:q,context:h},l))}}}(window.guidelib,Granite,$,window.xfalib._);
(function(b,a){function d(b){var a=new Intl.Collator,f=null;return b.filter(function(b){return"MARKETING"===b.purposeId&&-1!==n.indexOf(b.usageId)}).map(function(b){b.consentDateObj=new Date(b.consentDate);b.groupBy=[b.country,b.legalEntityId,b.usageId].join("|");return b}).sort(function(b,c){return a.compare(b.groupBy,c.groupBy)||c.consentDateObj-b.consentDateObj}).filter(function(b){var a=f!==b.groupBy;f=b.groupBy;return a&&-1!==c.indexOf(b.consent)}).filter(function(b){var a=f!==b.country;f=b.country;
return a}).map(function(b){return b.country})}function e(b){var a=b.vehicles.vehicles[0];a&&(delete b.vehicles,b.currentVehicle=a)}function g(b,a,c,f){c=c||"";f=f||{};var d=v[b];d&&(a=d(a,c));(d=z[b])&&(b=d(a,c));d=c+"/"+b;if(null===a)f[d]=null;else{switch(typeof a){case "string":case "number":case "boolean":f[d]=a;break;case "object":if(Array.isArray(a)){d=A[b];var e=B[b];if(d)for(var n=$jscomp.makeIterator(a),u=n.next();!u.done;u=n.next()){u=u.value;var m=d(u,c);e&&(u=e(u,c));g(m,u,c,f)}(d=x[b])&&
0<a.length&&(a=a.sort(d)[0],e&&(a=e(a,c)),g(b,a,c,f))}else for(e in a)g(e,a[e],d,f)}return f}}function r(a){function c(){window.dloass&&window.dloaas.api&&window.dloaas.api.triggerEvent(f,d)}if(null==b.bf.ParameterUtils.getQueryParams("dealer",window.location.href)){var f=a.dealers?"setFirstDealerInList":"searchLocation";if(a.dealers)var d={dealers:a.dealers};else if(a.bindRefMap["/businessPartner/addresses/addresses/city"])d={searchTerm:((a.bindRefMap["/businessPartner/addresses/addresses/street"]||
"")+" "+((a.bindRefMap["/businessPartner/addresses/addresses/houseNumber"]||"")+" ")+((a.bindRefMap["/businessPartner/addresses/addresses/postalCode"]||"")+" ")+((a.bindRefMap["/businessPartner/addresses/addresses/city"]||"")+" ")+(""+(a.bindRefMap["/businessPartner/addresses/addresses/country"]||""))).trim()};else return;"undefined"!==typeof require?c():document.addEventListener("DOMContentLoaded",function(){c()})}}function p(){return new Promise(function(b,a){var c=document.cookie.match(/(^| )gcdmToken=([^;]+)/);
c?b(c[2]):a(Error("No prefill, as GCDM token is not available."))})}function q(b){y.then(function(){return h(!0)});b=w(b).then(function(b){return t(b)});return Promise.all([y,b]).then(function(b){var a=b[1];a&&((a.bindRefMap||a.existingMarketingConsentCountries)&&l(b[0],a.bindRefMap,a.existingMarketingConsentCountries),(a.bindRefMap||a.dealers)&&r(a))}).finally(function(){h(!1)})}function h(b){var a=document.getElementById("loadingPage");a&&a.classList.toggle("guideBusinessPartnerLoading",b)}function l(b,
a,c){k(b,a,c);b.on("elementLazyLoaded",function(b,f){k(f.target,a,c)})}function k(c,f,d){var e=!1;c.visit(function(a){a instanceof b.model.Scriptable&&a.cssClassName&&-1<a.cssClassName.split(/\s+/).indexOf("hideIfLoggedIn")&&(a.visible=!1);if(a instanceof b.model.Field||a instanceof b.model.GuideCompositeField)if(a.bindRef){var c=a.bindRef.substring(a.bindRef.indexOf("/",1)),g=f[c];void 0!==g&&null!==g&&(a.value=g,a.executeExpression("valueCommit"),-1!==c.indexOf("/businessPartner/addresses/")&&(e=
!0));d&&-1<m.indexOf(c)&&(a.existingMarketingConsentCountries=d)}else if("dropdownPlannedPurchase"===a.cssClassName&&(g=f["/businessPartner/profile/plannedPurchase"],c=g&&new Date<=new Date(g)?!0:!1,c)){c=a.items.slice();g=new Date(g);var n=g.toLocaleDateString(b.bf.context.lang.replace("_","-"),{month:"long",year:"numeric"});g=g.getFullYear()+"-"+(g.getMonth()+1)+"-"+g.getDate()+"\x3d"+n;c.unshift(g);a.items=c;a.value=g.split("\x3d")[0];a.executeExpression("valueCommit")}});e&&a._guide.trigger("AddressValidation")}
function f(){p().then(q,console.debug).catch(console.error)}var c=["REJECT","ACCEPT"],n="IN_CAR EMAIL PHONE_MESSENGER_SERVICES MAIL PHONE SMS".split(" "),m=["/contactPolicyConsents/policy1","/contactPolicyConsents/policy2","/contactPolicyConsents/policy3"],w=function(a){return new Promise(function(c,f){if(a&&""!==a){var g=b.bf.ws.Registry.BUSINESS_FORMS_GCDM_CUSTOMERS$GET_V4_CLIENTID_CLIENTVARIANTID_CUSTOMERS,d={clientId:b.bf.context.clientId,clientVariantId:b.bf.context.clientVariantId,locales:b.bf.context.clientVariantId.split("-")[1],
serviceType:"GCDM_CUSTOMER",currentResource:b.bf.form.resource,currentBrowserLanguage:b.bf.context.lang,Authorization:"Bearer "+a,timestamp:(new Date).getTime()};b.bf.ws.RemoteUtil.executeFDMOperation(g,d,function(a){return c(a)},function(a){return f(a)})}})},t=function(a){var b={};if(a&&0<a.length&&a[0].businessPartner){a[0].contactPolicyConsents&&(b.existingMarketingConsentCountries=d(a[0].contactPolicyConsents));a[0].businessPartner.vehicles&&e(a[0].businessPartner);var c=a[0].businessPartner;
c.customExtension&&c.customExtension.parameters&&c.customExtension.parameters.forEach(function(a){"alternateLastName"===a.key?c.alternateLastName=a.value:"alternateFirstName"===a.key&&(c.alternateFirstName=a.value)});b.bindRefMap=g("businessPartner",c);b.dealers=c.dealers&&c.dealers.dealers?c.dealers.dealers.map(function(a){return a.distributionPartnerId+"_"+a.outletId}):null}return b},v={},z={},A={communicationEMails:function(a){return a.communicationStatus+"_EMAIL"},communicationPhones:function(a){return a.communicationStatus+
"_"+a.communicationType}},B={communicationEMails:function(a){return a.value},communicationPhones:function(a){return a.value?a.value.replaceAll(/\s/g,""):null}},x={addresses:function(a,b){return a.preferred?-1:b.preferred?1:0},vehicles:function(){return 0}},y=new Promise(function(a,b){window.guideBridge?window.guideBridge.connect(function(){a(window.guideBridge)}):b(Error("GuideBridge is not available."))});f();y.then(function(a){a._guide.on("loginSuccess",f)})})(window.guidelib,window.guideBridge);
guidelib.bf.gcdm=guidelib.bf.gcdm||{};
guidelib.bf.gcdm.MetadataProvider=function(b){function a(a,g){var d=Array.prototype.slice.call(arguments,2);if(c)return e(g,a,d),!0;n.push({callback:a,func:g,params:d});f||(f=!0,b.bf.ws.RemoteUtil.executeFDMOperation(b.bf.ws.Registry.BUSINESS_FORMS_GCDM_METADATA$GET_CLIENTID_CLIENTVARIANTID_METADATA_VALUELISTS,{clientId:b.bf.context.clientId,clientVariantId:b.bf.context.clientVariantId,currentResource:b.bf.form.resource,serviceType:"GCDM_METADATA"},q,h));return!1}function d(){for(;0<n.length;){var a=
n.shift();e(a.func,a.callback,a.params)}}function e(a,b,c){try{var f=a.apply(null,c);b.call(null,null,f)}catch(x){b.call(null,{message:x})}}function g(a){for(;0<n.length;)n.shift().callback.call(null,a)}function r(a){var b;if(!(b=k[a])){(b=l[a])||console.error("GCDM MetaData does not provide entries for key "+a);var c=void 0===m[a]?w:m[a];b=c?b.sort(c):b;k[a]=b.map(t);b=k[a]}return b}function p(){return Object.keys(l).sort(function(a,b){return a.localeCompare(b)})}function q(a){if(a.originCode&&"200"!==
a.originCode)a={code:a.originCode,message:"Unable to retrieve metadata.",origin:"MetaDataInitialization",details:operationArguments},b.runtime&&b.runtime.guide.executeExpression("submitError",{error:a}),g(a);else{l={};try{a.valueListEntries.filter(function(a){return!!a.list.keyValueListEntries}).forEach(function(a){l[a.attribute]=a.list.keyValueListEntries})}catch(z){console.error("Unresolveabele Error in GCDM Metadata processing")}c=!0;f=!1;d()}}function h(a,c){a={code:a.status,message:"Unable to retrieve metadata.",
origin:"MetaDataInitialization",details:c};b.runtime&&b.runtime.guide.executeExpression("submitError",{error:a});g(a)}var l=null,k={},f=!1,c=!1,n=[],m={},w=function(a,b){return a.value.localeCompare(b.value)},t=function(a){return a.key+"\x3d"+a.value};return{getValueList:function(b,c){return a(c,r,b)},getValueListKeys:function(b){return a(b,p)}}}(window.guidelib);
window.guideBridge&&window.guideBridge.registerConfig("widgetConfig",{formTitle:"bfHeadline",guideButton:"bfButton",guideCheckBox:"bfCheckBox",guideDatePicker:"bfDateTimeEditWidget",guideDropDownList:"bfDropDownList",guideRadioButton:"bfRadioButton",guideSwitch:"bfSwitch",guideTextBox:"bfTextbox"});
(function(b){if(b.i18n)switch(b.bf.context.lang){case "de":b.i18n.strings.datatypeMessage="Der angegebene Wert entspricht nicht dem erwarteten Format.";break;case "de_DE":b.i18n.strings.datatypeMessage="Der angegebene Wert entspricht nicht dem erwarteten Format."}})(guidelib);
$(document).ready(function(){"undefined"!==typeof Granite&&"undefined"!==typeof Granite.author||"undefined"===typeof requirejs||requirejs(["postal.aem-form"],function(b){var a=b.channel("af");b.fedx.signalReady({xframe:[{target:window}]},function(){window.guideBridge.connect(function(){a.publish({topic:"formReady",data:{location:"windowlocation"},headers:{preserve:!0}})})})})});
(function(b,a){var d=function(){var a={requestImage:function(a){return this.performRequest({endpoint:"/bin/forms/cosy.cosy-image-forms.html",invokeData:a})},performRequest:function(a){return b.ajax({type:"GET",url:a.endpoint,data:a.invokeData,dataType:"json"}).promise()},execute:function(b){return a[b]&&a[b].apply(a,[].slice.call(arguments,1))}};return{execute:a.execute}}();a.bf&&(a.bf.cosy=a.bf.cosy||{},a.bf.cosy.dataProvider=d)})($,window.guidelib);
window.guidelib.bf&&(window.guidelib.bf.PostalUtils=function(){function b(){return new Promise(function(a){$(document).ready(function(){requirejs(["postal.aem-form"],function(b){a({af:b.channel("af")})})})})}return{publish:function(a){a&&a.isContentCRM&&window.guideBridge.connect(function(){window.guideBridge._guide.trigger("bfCoSyData",{modelName:a.modelName,url:a.cosyData.cosyImageUrl});window.guideBridge._guide.trigger("vehicleConfig",a)});return b().then(function(b){if(a){b.af&&a.isContentCRM&&
b.af.publish({topic:"vehicleConfig",data:a,headers:{preserve:!0}});var d=!(!b.dlo||!a.dealerNumber);d&&b.dlo.publish({topic:"setSelectDealer",data:{dealerId:a.dealerNumber},headers:{preserve:!0}});guideBridge&&guideBridge.visit(function(a){a.cssClassName&&-1<a.cssClassName.split(/\s+/).indexOf("hideIfDealerPreset")&&(a.visible=!d)})}return!0})}}}());
window.guidelib.bf&&(window.guidelib.bf.ParameterUtils=function(){function b(){return window.guidelib.bf.context&&window.guidelib.bf.context.clientId?window.guidelib.bf.context.clientId.startsWith("mini"):!1}return{isThisBmwHost:function(){return window.guidelib.bf.context&&window.guidelib.bf.context.clientId?window.guidelib.bf.context.clientId.startsWith("bmw"):!1},isThisMiniHost:b,getQueryParams:function(a,d){d=decodeURIComponent(d);if(b()&&window.mini&&window.mini.digital&&window.mini.digital.comp&&
window.mini.digital.comp.ctas){var e=window.mini.digital.comp.ctas.getCurrentOverlay();null!=e&&(d=decodeURIComponent(e.options.source))}return(a=(new RegExp("([?\x26]|#/|#)"+a+"\x3d([^\x26#]*)","i")).exec(d))?a[2]:null},isQueryParameterExisting:function(a,b){return(new RegExp("([?\x26]|#/|#)"+a+"\x3d([^\x26#]*)","i")).test(b)}}}());
window.guidelib.bf&&(window.guidelib.bf.VehicleConfigurationUtils=function(){function b(){guidelib.bf.vehicleSelection?guidelib.bf.vehicleSelection.isPrefilledByApp=!0:guidelib.bf.vehicleSelection={isPrefilledByApp:!0}}guidelib.bf.ParameterUtils.isQueryParameterExisting("ucpBaseurl",top.window.location.href)&&b();guidelib.bf.ParameterUtils.isQueryParameterExisting("optionalEquipment",top.window.location.href)&&b();return{markAsPrefilled:b}}());
window.guidelib&&window.guidelib.bf&&(window.guidelib.bf.BrandUtils=function(){var b=["BMW","BMW_I","MINI","BMW_MOTORRAD","ROLLS_ROYCE"],a=["WBBM","WBBI","WBMI"],d=["BM","BI","MI"],e=["bmwCar","bmwi","mini","bmwBike","rr"];return{convertGcdmToCosy:function(d){return a[b.indexOf(d)]},convertGcdmToPdh:function(a){return d[b.indexOf(a)]},convertGcdmToUcp:function(a){return e[b.indexOf(a)]},convertCosyToGcdm:function(d){return b[a.indexOf(d)]},convertCosyToPdh:function(b){return d[a.indexOf(b)]},convertCosyToUcp:function(b){return e[a.indexOf(b)]},
convertPdhToGcdm:function(a){return b[d.indexOf(a)]},convertPdhToCosy:function(b){return a[d.indexOf(b)]},convertPdhToUcp:function(a){return e[d.indexOf(a)]},convertUcpToGcdm:function(a){return b[e.indexOf(a)]},convertUcpToCosy:function(b){return a[e.indexOf(b)]},convertUcpToPdh:function(a){return d[e.indexOf(a)]}}}());
window.guidelib.bf&&(window.guidelib.bf.VehicleConfigurationBuilder=function(){var b={Data:{},TopDrive:function(){this.Data.bodyCode=null;this.Data.bodyStyle=null;return this.dataWithoutEmpties()},Carmen:function(){this.Data.bodyCode=this.resolveBodyCode();this.Data.bodyCode=this.adjustBodyCode();this.Data.modelRange=null;this.Data.seriesCode=null;this.Data.bodyStyle=null;return this.dataWithoutEmpties()},Carmen_UK:function(){this.Data.bodyCode=this.resolveBodyCode();this.Data.modelRange=null;this.Data.seriesCode=
null;this.Data.bodyStyle=null;return this.dataWithoutEmpties()},SEM_Deep:function(){this.Data.bodyCode=this.resolveBodyCode(this.Data.bodyType);this.Data.modelRange=null;this.Data.seriesCode=null;this.Data.bodyStyle=null;return this.dataWithoutEmpties()},SEM_Light:function(){this.Data.bodyCode=this.resolveBodyCode();this.Data.modelRange=null;this.Data.seriesCode=null;this.Data.bodyStyle=null;return this.dataWithoutEmpties()},ELAINE:function(){this.Data.bodyName=null;this.Data.bodyCode=this.resolveBodyCode();
this.Data.modelRange=null;this.Data.bodyStyle=null;return this.dataWithoutEmpties()},dataWithoutEmpties:function(){var a={},b=this.Data;Object.keys(b).forEach(function(d){null!=b[d]&&(a[d]=b[d])});return a},resolveBodyCode:function(a){return null!==this.Data.bodyCode?this.Data.bodyCode:a||this.Data.modelRange},adjustBodyCode:function(){return this.Data.bodyStyle?"".concat(this.Data.bodyCode).concat("-").concat(this.Data.bodyStyle):this.Data.bodyCode}};return{requestVehicle:function(a){b.Data.requestVehicle=
a;return this},bodyCode:function(a){b.Data.bodyCode=a;return this},bodyName:function(a){b.Data.bodyName=a;return this},bodyStyle:function(a){b.Data.bodyStyle=a;return this},bodyType:function(a){b.Data.bodyType=a;return this},circulationConsent:function(a){b.Data.circulationConsent=a;return this},configId:function(a){b.Data.configId=a;return this},configUrl:function(a){b.Data.configUrl=a;return this},deeplink:function(a){b.Data.deeplink=a;return this},lastChange:function(a){b.Data.lastChange=a;return this},
modelBaseCode:function(a){b.Data.modelBaseCode=a;return this},modelCode:function(a){b.Data.modelCode=a;return this},modelName:function(a){b.Data.modelName=a;return this},modelPrice:function(a){b.Data.modelPrice=a;return this},modelRange:function(a){b.Data.modelRange=a;return this},notInterestedInFinance:function(a){b.Data.notInterestedInFinance=a;return this},seriesCode:function(a){b.Data.seriesCode=a;return this},seriesName:function(a){b.Data.seriesName=a;return this},totalEquipmentPrice:function(a){b.Data.totalEquipmentPrice=
a;return this},totalPrice:function(a){b.Data.totalPrice=a;return this},vin:function(a){b.Data.vin=a;return this},optionalEquipments:function(a){b.Data.optionalEquipments=a;return this},packages:function(a){b.Data.packages=a;return this},financeCalculation:function(a){if(a){b.Data.financeCalculation={names:{value:null,language:null},code:null,calculationType:null,parameterValues:[]};var d=guidelib.bf.context.lang.split("_")[0];b.Data.financeCalculation.names.value=a.productName;b.Data.financeCalculation.names.language=
d;b.Data.financeCalculation.code=a.offerId;b.Data.financeCalculation.calculationType=a.productType;a.parameters.forEach(function(a){var e={};e.code=a.key;e.names={};e.names.value=a.label;e.names.language=d;e.value=a.value;e.units={};e.units.value=a.unit;e.units.language=d;b.Data.financeCalculation.parameterValues.push(e)})}return this},cosyData:function(a){b.Data.cosyData=a;return this},customExtension:function(a){b.Data.customExtension=a;return this},prices:function(a){b.Data.prices=a;return this},
orderNumber:function(a){b.Data.orderNumber=a;return this},additionalSAcodes:function(a){b.Data.additionalSaCodes=a;return this},defaultSaCodes:function(a){b.Data.defaultSaCodes=a;return this},paintCode:function(a){b.Data.paintCode=a;return this},fabricCode:function(a){b.Data.fabricCode=a;return this},build:function(a){return b[a]&&b[a].apply(b,[].slice.call(arguments,1))}}}());
window.guidelib.bf&&(window.guidelib.bf.StockLocatorHandler=function(b,a,d,e,g){function r(){var a=d.getQueryParams("konfiguratorData",top.window.location.href);window.consentcontroller.api.deletePersistence(a)}function p(a,f){if((a=JSON.parse(a))&&a.configData){b.bf.VehicleConfigurationUtils.markAsPrefilled();var c={bodyCode:a.configData.modelRange,brand:a.configData.brand,cosyImageUrl:a.configData.cosyImageUrls.FRONTSIDE_VIEW,dealerNumber:a.configData.dealerId,vgCode:a.configData.vgCode,agCode:a.configData.agCode,
modelName:a.configData.modelName,modelRange:a.configData.modelRange,modelCode:a.configData.modelCode,seriesCode:a.configData.series,totalPrice:a.configData.prices.totalGross,outletNumber:a.configData.outletId,vin:a.configData.vin,financeCalculation:a.configData.sfOfferDetails,prices:a.configData.prices,orderNumber:a.configData.orderNumber,additionalSAcodes:a.additionalSaCodes,defaultSaCodes:a.configData.defaultSaCodes,paintCode:a.configData.paintCode,fabricCode:a.configData.fabricCode,bodyType:a.configData.bodyType},
d=Object.assign({isRangeRequest:!1},a.configData),e=new CustomEvent("trackingDataPassthrough",{detail:d});a.configData&&(b.bf.tracking.trackingData=a.configData);b&&b.bf&&b.bf.tracking&&b.bf.tracking.isReady?document.dispatchEvent(e):document.addEventListener("trackingFormsReady",function(){document.dispatchEvent(e)});f(c)}}function q(a){var b=a;try{b=String(a).replaceAll(f,h)}catch(m){console.error(m)}return b}function h(a,b,f,d,e,g){a=g;b&&f&&(a="".concat(b).concat(f));b&&f&&d&&(a=a.concat(".").concat(d));
return a}function l(a){return d.isThisMiniHost()?a.bodyType:a.modelRange}function k(c){return new Promise(function(f){var d=a.bodyCode(l(c)).bodyStyle(c.bodyStyle).requestVehicle(!0).customExtension({parameters:[{key:"MODEL_NAME",value:c.modelName}]}).cosyData({cosyImageUrl:c.cosyImageUrl,cosyBeautyshot:""}).modelCode(c.modelCode?c.modelCode:c.vgCode).modelBaseCode(c.agCode).modelName(c.modelName).modelRange(c.modelRange).seriesCode(c.seriesCode).totalPrice(q(c.totalPrice)).vin(c.vin).financeCalculation(c.financeCalculation).prices(c.prices).orderNumber(c.orderNumber).additionalSAcodes(c.additionalSAcodes).defaultSaCodes(c.defaultSaCodes).paintCode(c.paintCode).fabricCode(c.fabricCode).build(b.bf.context.crmSystem),
e="\x3ch4\x3e"+c.modelName+"\x3c/h4\x3e",n=g.convertPdhToGcdm(c.brand),h=null;null!=c.dealerNumber&&(h=c.dealerNumber);null!=c.dealerNumber&&null!=c.outletNumber&&(h=c.dealerNumber.concat("_").concat(c.outletNumber));e={modelNamePrint:e,brandGcdm:n,dealerNumber:h};d.isContentVisual=!0;d.isContentCRM=!0;f(Object.assign(d,e))})}var f=new RegExp(/^(\d{1,3})\.(\d{3}),?(\d{0,2}).*/,"g");return{handleConfiguration:function(a){k(a).then(e.publish).then(r)},getStockLocatorData:function(){return new Promise(function(a){var b=
d.getQueryParams("konfiguratorData",top.window.location.href);b=window.consentcontroller.api.getPersistence(b);p(b,a)})}}}(window.guidelib,window.guidelib.bf.VehicleConfigurationBuilder,window.guidelib.bf.ParameterUtils,window.guidelib.bf.PostalUtils,window.guidelib.bf.BrandUtils));
window.guidelib.bf&&(window.guidelib.bf.VehicleConfigurationMediator=function(b,a){function d(b){b&&a.handleConfiguration(b)}return{execute:function(){a.getStockLocatorData().then(d)}}}(window.guidelib.bf.ParameterUtils,window.guidelib.bf.StockLocatorHandler),(window.epaas&&(window.epaas.api||window)).addEventListener("consentcontroller.api.initialized",window.guidelib.bf.VehicleConfigurationMediator.execute));
(function(b){function a(){a:{var a=null;if(window.consentcontroller)try{var c=a=JSON.parse(window.consentcontroller.api.getCookie("clc_campaign_lead_context"));break a}catch(w){console.log(w)}c=void 0}if(c){a=[];var d=[];c.campaignId&&(a.push(p),d.push(c.campaignId));0===b.bf.context.brand.localeCompare("bmw",void 0,{sensitivity:"accent"})&&c.leadContext&&(a.push(g),d.push(c.leadContext));0===b.bf.context.brand.localeCompare("MINI",void 0,{sensitivity:"accent"})&&c.leadSource&&(a.push(g),d.push(c.leadSource));
c.treatmentId&&(a.push(r),d.push(c.treatmentId));if("none"!==b.bf.context.monitoringTLParameter&&c.trackingLink){var e={adobeChannel:"",campaignName:"",leadContextOrigin:""};switch(b.bf.context.monitoringTLParameter){case "fr":e=window.guidelib.bf.func.campaign.trackingLink.handleFR(c.trackingLink);break;default:e.adobeChannel="",e.campaignName="",e.leadContextOrigin=""}q&&e.campaignName&&(a.push(q),d.push(e.campaignName));h&&e.leadContextOrigin&&(a.push(h),d.push(e.leadContextOrigin))}0<d.length&&
a.length===d.length&&window.guideBridge.setProperty(a,"value",d);return!0}return!1}function d(){guideBridge.off("validationComplete",d);guideBridge.visit(function(a){0<=e.indexOf(a.bindRef)?l.push(a.somExpression):"/MultiOfferResponse/requestsCommon/leadContext"===a.bindRef?g=a.somExpression:"/MultiOfferResponse/campaignResponse/treatmentId"===a.bindRef?r=a.somExpression:"/MultiOfferResponse/campaignResponse/campaignId"===a.bindRef?p=a.somExpression:"/MultiOfferResponse/campaignResponse/campaignName"===
a.bindRef?q=a.somExpression:"/MultiOfferResponse/requestsCommon/leadContextOrigin"===a.bindRef&&(h=a.somExpression)})}var e=["/MultiOfferResponse/contactPolicyConsents/policy1/policyChoices","/MultiOfferResponse/contactPolicyConsents/policy2/policyChoices","/MultiOfferResponse/contactPolicyConsents/policy3/policyChoices"],g,r,p,q,h,l=[],k=!1;window.guideBridge&&window.guideBridge.on("submitStart",function(){var d=window.guideBridge.getElementProperty({somExpressions:l,propertyName:"value"});(k=b.bf.context.isDLCEnabled||
d.data.some(function(a){return a&&Object.values(JSON.parse(a)).some(function(a){return!!a.ANALYTICS})}))&&a()&&window.consentcontroller&&window.consentcontroller.api.deletePersistence("clc_campaign_lead_context")});window.guideBridge&&window.guideBridge.on("validationComplete",d)})(guidelib);
window.guidelib.bf.func&&(void 0===window.guidelib.bf.func.campaign&&(window.guidelib.bf.func.campaign={}),window.guidelib.bf.func.campaign.trackingLink=function(){var b={adobeChannel:"",campaignName:"",leadContextOrigin:""};return{handleFR:function(a){a=a.match(/(.*-)|(.*?_){10}|.*$/gm);3<=a.length&&(b.adobeChannel=a[0].slice(0,-1),b.campaignName=a[1].slice(0,-1),b.leadContextOrigin=a[2]);return b}}}());
(function(b,a,d,e){function g(a,c){b(".bf-progress-back",a).toggleClass("hidden",!c)}function r(a,c){0<=c&&b(".bf-progress-steps__active",a).text(c+1)}function p(a,c){b(".bf-progress-steps__total",a).text(c)}function q(a,b,d){a.toggleClass("is-disabled",b).toggleClass("hidden",d)}function h(a){var b=a.ownerDocument.body.getBoundingClientRect();a=a.getBoundingClientRect();return{left:a.left-b.left,top:a.top-b.top}}d.bf.tracking.multistep={isMultistep:!1};var l=null;if(a){a.on("elementNavigationChanged",
function(f,c){if((f=c.target)&&"guideToolbar"!==f.className&&l!==f&&"business/forms/custom/wizard"===f.getOrElse(f,"parent.jsonModel.layout.sling:resourceType",null)){l&&(c=(c=a._getGuideDomElement(f.parent.somExpression))&&c.get(0)&&h(c.get(0)),e.scrollTo(0,c?c.top:0),e.parent!==e&&e.parent.document&&(c=(c=e.parent.document.getElementById("aemFormFrame"))&&h(c),e.parent.scrollTo(0,c?c.top:0)));l=f;c=f.parent;var n=c.navigationContext,m=n._getNavigableItems(),k=m.indexOf(f);d.bf.tracking.multistep=
{isMultistep:!0,name:f.name,step:k+1,stepAmounts:m.length};var t=b("#"+c.templateId+d.util.GuideUtil.GUIDE_ITEM_NAV_CONTAINER_SUFFIX);g(t,!n.isFirstItem);r(t,m.indexOf(f));p(t,m.length);if(!c.bfNavInitialized){c.bfNavInitialized=!0;q(t,!!c.jsonModel.progressDisable,!!c.jsonModel.progressHide);var v=c.items;a.on("elementVisibleChanged",function(b,c){var d=v.indexOf(c.target);if(0<=d&&(b=n._getNavigableItems(),p(t,b.length),!c.newText&&a.getFocus({focusOption:"navigablePanel"})===c.target.somExpression)){for(c=
d+1;c<v.length;c++){var e=v[c];if(-1<=b.indexOf(e)){var f=e;break}}if(f)a.setFocus(f.somExpression,"firstItem",!1);else{for(--d;0<=d;d--)if(c=v[d],-1<=b.indexOf(c)){f=c;break}f&&a.setFocus(f.somExpression,"lastItem",!1)}}})}}});var k=function(a){this.element=b(a)};k.prototype.show=function(){var a=this.element,b=a.data("bf-toggle"),g=a.attr("data-guide-id");b="tab"===b;var m=a.parent("li"),h=!0;if(l)var k=l.parent.navigationContext,p=k.hasPrevItem&&a[0].children[0].dataset.guideId===k.prevItem.jsonModel.templateId,
q=k.hasNextItem&&a[0].children[0].dataset.guideId===k.nextItem.jsonModel.templateId;p&&m.hasClass("stepped")||(h=e.guideBridge.validate([],k.currentItem.somExpression));(h&&p||h&&q||m.hasClass("stepped"))&&!g&&(b=b||m.hasClass("stepped"),(g=m.attr("id")||m.attr("data-guide-id"))&&(g=g.substring(0,g.length-d.util.GuideUtil.GUIDE_ITEM_NAV_SUFFIX.length)));g&&b?e.guideBridge?(a=e.guideBridge._resolveId(g))&&e.guideBridge.setFocus(a.somExpression):e.parent._afAuthorHook&&e.parent.guidelib.author.AuthorUtils?
e.parent.guidelib.author.AuthorUtils.setAuthoringFocus(g,e.document):d.author.AuthorUtils&&d.author.AuthorUtils.setAuthoringFocus(g,e.document):b&&console&&console.log&&console.log("could not execute setFocus for:"+g)};b.fn.guidetab=function(a){return this.each(function(){var c=b(this),d=c.data("guidetab");d||c.data("guidetab",d=new k(this));if("string"===typeof a)d[a]()})};b.fn.guidetab.Constructor=k();b(e.document).on("click.guidetab.data-api",'[data-bf-toggle$\x3d"tab"]',function(a){a.preventDefault();
b(this).guidetab("show")}).on("keydown.guidetab.data-api",'[data-bf-toggle$\x3d"tab"], [id$\x3d"'+d.util.GuideUtil.GUIDE_ITEM_NAV_SUFFIX+'"]',function(a){d.util.GuideUtil.isSpaceBarPressed(a)&&(a.preventDefault(),a.stopPropagation(),0<b(a.target).find('[data-bf-toggle$\x3d"tab"]').length?b(this).find('[data-bf-toggle$\x3d"tab"]').guidetab("show"):b(this).guidetab("show"))});document.addEventListener("scroll",function(){var a=document.querySelector(".wizard-sticky-placeholder"),c=document.querySelector(".wizard-sticky"),
d=b(".aemformcontainer"),g=b(".aemformcontainer.wizard-sticky__enabled").length?b(".wizard-sticky__enabled"):b("body");if(!d.length||d.hasClass("wizard-sticky__enabled"))e.scrollY>=a.offsetTop?(g.addClass("wizard-sticky__active"),""===a.style.height&&(a.style.height=c.offsetHeight+"px")):(g.removeClass("wizard-sticky__active"),a.style.height="")})}})($,window.guideBridge,guidelib,window);window._||(window._=window.xfalib._);window._.VERSION||(window._=window.xfalib._);