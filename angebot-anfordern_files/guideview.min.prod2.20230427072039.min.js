/*
 http://www.opensource.org/licenses/mit-license.php (The MIT License)
*/
var toHankaku=function(d,b){function f(e){return b(e.charCodeAt(0)-65248)}return function(b){return d(b).replace(/\u2019/g,"'").replace(/\u201D/g,'"').replace(/\u3000/g," ").replace(/\uFFE5/g,"\u00a5").replace(/\u30FC/g,"-").replace(/[\uFF01\uFF03-\uFF06\uFF08\uFF09\uFF0C-\uFF19\uFF1C-\uFF1F\uFF21-\uFF3B\uFF3D\uFF3F\uFF41-\uFF5B\uFF5D\uFF5E]/g,f)}}(String,String.fromCharCode);
(function(d){d.model.mixin.HideByClass={normalProperties:{hideComponentWithClass:function(b,d){this._guide().visit(function(e){e.cssClassName&&-1<e.cssClassName.split(/\s+/).indexOf(d)&&(e.visible=!b)},window)}}}})(guidelib);
(function(d,b,f){var e=d.view.GuideCosyImageView=d.view.GuideBaseView.extend({isFullWidth:!1,$backgroundImage:null,postInitialize:function(){e._super.postInitialize.call(this);this._adjustView();this._syncGuideNodeToHtml(!0)},_adjustView:function(){var a=this.$element.closest(".panel").parent();a.length&&!a.hasClass("col-md-12")&&a.css({position:"unset"});var c=this.$element.closest(".row");this.$backgroundImage=b(".bf-vehicle-cosy-image__background",this.$element);a.length&&a.hasClass("col-md-12")&&
(this.$backgroundImage.addClass("bf-vehicle-cosy-image__background--full-width hidden"),this.isFullWidth=!0);c.append(this.$backgroundImage)},handleVisibleChanged:function(a){e._super.handleVisibleChanged.apply(this,arguments);this.$backgroundImage.toggleClass("hidden",!a.newText)},handleModelChanged:function(a){e._super.handleModelChanged.apply(this,arguments);switch(a._property){case "url":var c=a.newText,k=b("img",this.$element).attr({src:c}),g=b(".user-notification-cosy-image");this.isFullWidth&&
this.$backgroundImage.toggleClass("hidden",!c);c?(b("body").css({"overflow-x":"hidden"}),k.show(),g&&g.show()):(k.hide(),g&&g.hide());break;case "altText":b("img",this.$element).attr({alt:a.newText});break;case "loading":this.$element.toggleClass("loading",a.newText)}}})})(guidelib,$,window._);
(function(d,b){var f=b.model.GuideSchema=b.model.GuideSchema.extend({initialize:function(){f._super.initialize.call(this);this.addSchema("guideCosyImage",[["modelCode","string",null],["brand","string",null],["paint","string",null],["fabric","string",null],["sa","string",null],["altText","string",null],["url","string",null]],"scriptable")}})})(_,guidelib);
(function(d,b){var f=b.model.GuideCosyImage=b.model.Scriptable.extend({msClassName:"guideCosyImage",loading:!1,vehicleConfigChangeHandler:null,initialize:function(){f._super.initialize.apply(this);this.vehicleConfigChangeHandler=this._handleVehicleConfigChange.bind(this);this._guide().on("bfCoSyData",this.vehicleConfigChangeHandler)},_unloadModel:function(){this._guide().off("bfCoSyData",this.vehicleConfigChangeHandler);this.vehicleConfigChangeHandler=null;f._super._unloadModel.apply(this)},_collectExpressions:function(){f._super._collectExpressions.apply(this);
this._compiledScripts.validateAllExp=this._compileExpression("this._retrieveCosyUrl()",null)},prepare:function(){f._super.prepare.apply(this);this.executeExpression("validateAllExp")},_retrieveCosyUrl:function(){if(this.modelCode&&this.brand&&b.bf&&b.bf.cosy&&b.bf.cosy.dataProvider){this.loading||(this.loading=!0,this._triggerEvent(b.event.GuideModelEvent.MODEL_CHANGED,"loading",!1,!0));var a=b.bf.cosy.dataProvider.execute("requestImage",{modelCode:this.modelCode,brand:this.brand,paint:this.paint?
this.paint:"",fabric:this.fabric?this.fabric:"",sa:this.sa?this.sa:"",agCode:this.jsonModel.agCode?this.jsonModel.agCode:""});this.latestPromise=a;var c=this;a.then(function(e){a===c.latestPromise&&(c.url=e.cosyImageUrl,b.bf.cosy.dataProvider.imageURL=e.cosyImageUrl)}).always(function(){a===c.latestPromise&&(c.loading=!1,c.latestPromise=null,c._triggerEvent(b.event.GuideModelEvent.MODEL_CHANGED,"loading",!0,!1))})}else this.url=null},_handleVehicleConfigChange:function(a){this.altText=a.modelName;
this.jsonModel.modelCode=a.modelCode;this.jsonModel.brand=a.cosyBrand;this.jsonModel.paint=a.paint;this.jsonModel.fabric=a.fabric;this.jsonModel.sa=a.sa;this.jsonModel.agCode=a.agCode;a.url?this.url=a.url:this._retrieveCosyUrl()}}),e={};["modelCode","brand","paint","fabric","sa"].forEach(function(a){e[a]={get:function(){return this.getAttribute(a)},set:function(c){this.getAttribute(a)!==c&&(this.setAttribute(c,a),this._guide().queueExpressions(this,["validateAllExp"]))}}});e.isLoading={get:function(){return this.loading}};
e.url={get:function(){return this.getAttribute("url")},set:function(a){var c=this,b=this;if(a){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(this.readyState===this.HEADERS_RECEIVED){var c=parseInt(e.getResponseHeader("errorcode"));10640===c||10260===c?b.setAttribute(null,"url"):b.setAttribute(a,"url")}};e.onerror=function(){return c.setAttribute(null,"url")};e.open("HEAD",a);e.send()}else this.setAttribute(a,"url")}};e.altText={get:function(){return this.getAttribute("altText")},set:function(a){this.setAttribute(a,
"altText")}};f.defineProps(e)})(window._,guidelib);(function(d,b){var f=b.view.GuideFieldView.prototype.handleErrorReset;b.view.GuideFieldView.prototype.handleErrorReset=function(b){f.apply(this,arguments);this.updateWidgetOption("isValid",!0)}})($,guidelib);
(function(d,b){var f=d.view.GuideButtonView=d.view.GuideButtonView.extend({createWidgetOptions:function(){var e=f._super.createWidgetOptions.apply(this,arguments);return b.extend({},e,{showRightIcon:this._model.getAttribute("showIcon")})}})})(guidelib,_);
(function(d){var b=d.model.GuideButton=d.model.GuideButton.extend({defaultSubmitNavigationExpression:"if(this.panel.isNavigable) {this.visible \x3d !this.panel.navigationContext.hasNextItem;}",_collectExpressions:function(){b._super._collectExpressions.apply(this);this.navigationChangeExp||"submit"!==this.type||(this.jsonModel.navigationChangeExp=this.defaultSubmitNavigationExpression,this._compiledScripts.navigationChangeExp=this._compileExpression(this.defaultSubmitNavigationExpression,null))}})})(guidelib);
(function(d,b){var f=b.model.GuideDatePicker=b.model.GuideDatePicker.extend({_runValidations:function(b){f._super._runValidations.apply(this,arguments);b.validFlag&&"fd/af/components/guidedateinput"===this.getAttribute("sling:resourceType")&&(this.requestDateBeforeToday||this.requestDateBeforeToday||!this.excludeToday||(b.validFlag=this._runTodayTest()),this.requestDateBeforeToday&&(b.validFlag=this._runFutureDateTest(this.excludeToday)),this.requestDateAfterToday&&(b.validFlag=this._runPastDateTest(this.excludeToday)),
b.validFlag||(this._errorText=this.validateExpMessage,this._failedTest=this.guideUtil.SCRIPT_TEST));b.validFlag&&(this.minimumAge||this.maximumAge)&&(b.validFlag=this._runMinimumAgeTest(),b.validFlag?(b.validFlag=this._runMaximumAgeTest(),b.validFlag||(this._errorText=this.maximumAgeValidationMessage||this.validateExpMessage,this._failedTest=this.guideUtil.MINIMUM_VALUE_TEST)):(this._errorText=this.minimumAgeValidationMessage||this.validateExpMessage,this._failedTest=this.guideUtil.MINIMUM_VALUE_TEST))},
_runFutureDateTest:function(b){var a=this._getValue(),c=!0;this.checkIfNull(a)||(c=new Date,c=Date.UTC(c.getFullYear(),c.getMonth(),c.getDate()),c=b?(new Date(a)).getTime()<c:(new Date(a)).getTime()<=c);return c},_runPastDateTest:function(b){var a=this._getValue(),c=!0;this.checkIfNull(a)||(c=new Date,c=Date.UTC(c.getFullYear(),c.getMonth(),c.getDate()),c=b?(new Date(a)).getTime()>c:(new Date(a)).getTime()>=c);return c},_runTodayTest:function(){var b=this._getValue(),a=!0;this.checkIfNull(b)||(a=
new Date,a=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),a=(new Date(b)).getTime()!==a);return a},_runMinimumAgeTest:function(){var b=this._getValue(),a=!0;!this.checkIfNull(b)&&this.minimumAge&&(a=this._getFullYearDifference(new Date(b),new Date)>=this.minimumAge);return a},_runMaximumAgeTest:function(){var b=this._getValue(),a=!0;!this.checkIfNull(b)&&this.maximumAge&&(a=this._getFullYearDifference(new Date(b),new Date)<=this.maximumAge);return a},_getFullYearDifference:function(b,a){var c=
a.getFullYear()-b.getFullYear(),e=a.getMonth()-b.getMonth();(0>e||0===e&&b.getDate()>a.getDate())&&c--;return c}});f.defineProps({autocomplete:{get:function(){return this.getAttribute("autocomplete")}},minimumAge:{get:function(){return this.getAttribute("minimumAge")}},maximumAge:{get:function(){return this.getAttribute("maximumAge")}},minimumAgeValidationMessage:{get:function(){return this.getAttribute("minimumAgeValidationMessage")}},maximumAgeValidationMessage:{get:function(){return this.getAttribute("maximumAgeValidationMessage")}},
minDate:{get:function(){return this.getAttribute("minimumDate")}},maxDate:{get:function(){return this.getAttribute("maximumDate")}},requestDateBeforeToday:{get:function(){return this.getAttribute("requestDateBeforeToday")}},requestDateAfterToday:{get:function(){return this.getAttribute("requestDateAfterToday")}},excludeToday:{get:function(){return this.getAttribute("excludeToday")}},minDaysAhead:{get:function(){return this.getAttribute("minDaysAhead")}},maxDaysAhead:{get:function(){return this.getAttribute("maxDaysAhead")}},
weekStartsWithSunday:{get:function(){return this.getAttribute("weekStartsWithSunday")}},excludeMonday:{get:function(){return this.getAttribute("excludeMonday")}},excludeTuesday:{get:function(){return this.getAttribute("excludeTuesday")}},excludeWednesday:{get:function(){return this.getAttribute("excludeWednesday")}},excludeThursday:{get:function(){return this.getAttribute("excludeThursday")}},excludeFriday:{get:function(){return this.getAttribute("excludeFriday")}},excludeSaturday:{get:function(){return this.getAttribute("excludeSaturday")}},
excludeSunday:{get:function(){return this.getAttribute("excludeSunday")}},datePatternLong:{get:function(){return b.i18n.datePatterns.long}},datePatternShort:{get:function(){return b.i18n.datePatterns.short}}})})($,guidelib);
(function(d,b){var f=d.view.GuideDatePickerView=d.view.GuideDatePickerView.extend({createWidgetOptions:function(){var e=f._super.createWidgetOptions.apply(this,arguments);return b.extend({},e,{autocomplete:this._model.autocomplete,minDate:this._model.minDate,maxDate:this._model.maxDate,requestDateBeforeToday:this._model.requestDateBeforeToday,requestDateAfterToday:this._model.requestDateAfterToday,excludeToday:this._model.excludeToday,minDaysAhead:this._model.minDaysAhead,maxDaysAhead:this._model.maxDaysAhead,
weekStartsWithSunday:this._model.weekStartsWithSunday,excludeMonday:this._model.excludeMonday,excludeTuesday:this._model.excludeTuesday,excludeWednesday:this._model.excludeWednesday,excludeThursday:this._model.excludeThursday,excludeFriday:this._model.excludeFriday,excludeSaturday:this._model.excludeSaturday,excludeSunday:this._model.excludeSunday,datePatternLong:this._model.datePatternLong,datePatternShort:this._model.datePatternShort})}})})(guidelib,_);
(function(d,b){var f=d.view.GuideDropDownListView=d.view.GuideDropDownListView.extend({createWidgetOptions:function(){var e=f._super.createWidgetOptions.apply(this,arguments);return b.extend({},e,{required:this._model.mandatory,autocomplete:this._model.jsonModel.autocomplete?this._model.jsonModel.autofillFieldKeyword:"off",maxItems:this._model.jsonModel.maxItems,selectedItemsAlignment:this._model.jsonModel.selectedItemsAlignment})},_markMandatory:function(){f._super._markMandatory.apply(this,arguments);
this.jqwidget&&this.jqwidget.option("required",this._model.mandatory)}})})(guidelib,window._);
(function(d){function b(b){b.defineProps({gcdmMetadata:{get:function(){return this.getAttribute("gcdmMetadata")}},gcdmIsFiltered:{get:function(){return this.getAttribute("gcdmMetadataIsFiltered")}}});var a=b.extend({_postInitialize:function(){a._super._postInitialize.call(this);if(this.gcdmMetadata&&this.getOrElse(d,"bf.gcdm.MetadataProvider.getValueList",!1)){var c=null,b=this._getOptionsArray();0<b.length&&(c={},b.forEach(function(a,b){return c[a.saveValue]=b+1}));d.bf.gcdm.MetadataProvider.getValueList(this.gcdmMetadata,
function(a,b){a?this.items=[]:(c&&(this.gcdmIsFiltered&&(b=b.filter(function(a){return c[a.split("\x3d",1)[0]]})),b=f(b,function(a,b){a=c[a.split("\x3d",1)[0]];b=c[b.split("\x3d",1)[0]];return a&&b?a-b:a||b?a?-1:1:0})),this.items=b)}.bind(this))}}});return a}var f=function(b,a){return b.map(function(a,b){return{item:a,index:b}}).sort(function(b,e){return a(b.item,e.item)||b.index-e.index}).map(function(a){return a.item})};d.model.GuideDropDownList=b(d.model.GuideDropDownList);d.model.GuideRadioButton=
b(d.model.GuideRadioButton);d.model.GuideCheckBox=b(d.model.GuideCheckBox)})(guidelib);
(function(d,b){var f=d.view.GuideTextBoxView=d.view.GuideTextBoxView.extend({createWidgetOptions:function(){var e=f._super.createWidgetOptions.apply(this,arguments);return b.extend({},e,{keyboardType:this._model.getAttribute("keyboardType"),numericKeyboard:this._model.getAttribute("numericKeyboard"),counterText:this._model.getAttribute("counterText")})},commitValue:function(b){var a=xfalib.ut.XfaUtil.prototype;this._model.value=toHankaku(b);b=this._model._guide().version;b.isOn(b.Flags.RUN_VALUE_COMMMIT_ON_SCRIPT_CHANGE)||
this._model.executeExpression("valueCommitScript");this.getCommitEvent()===a.XFA_CHANGE_EVENT?this._model.executeExpression("change"):this._model.executeExpression("exit")}})})(guidelib,_);
(function(d,b){d.view.GuideNumericBoxView=d.view.GuideNumericBoxView.extend({commitValue:function(b){var e=xfalib.ut.XfaUtil.prototype;this._model.value=toHankaku(b);b=this._model._guide().version;b.isOn(b.Flags.RUN_VALUE_COMMMIT_ON_SCRIPT_CHANGE)||this._model.executeExpression("valueCommitScript");this.getCommitEvent()===e.XFA_CHANGE_EVENT?this._model.executeExpression("change"):this._model.executeExpression("exit")}})})(guidelib,_);
(function(d,b){var f=d.view.GuideTelephoneView=d.view.GuideTelephoneView.extend({commitValue:function(b){f._super.commitValue.call(this,toHankaku(b))}})})(guidelib,_);
(function(d,b){var f=b.model.GuideTelephone=b.model.GuideTelephone.extend({msClassName:"GuideTelephoneModel",_runValidations:function(b){f._super._runValidations.apply(this,arguments);window.libphonenumber&&b.validFlag&&this.useLibPhone&&this.libPhoneLanguageCode&&(this._validateWithLibPhone(this.value)?b.validFlag=!0:!1===this.mandatory&&null===this.value?b.validFlag=!0:(b.validFlag=!1,this._errorText=this.validateExpMessage,this._failedTest=this.guideUtil.SCRIPT_TEST))},_getFormattedValue:function(b){return null!==
b?this._formatWithLibPhone(b):f._super._getFormattedValue.apply(this,arguments)},_triggerDisplayFormatChange:function(){var e=this.userInputValue;this._triggerEvent(b.event.GuideModelEvent.VALUE_CHANGED,"value",e,this._getFormattedValue(e))},_setGuideValue:function(b){this.userInputValue=b;f._super._setGuideValue.call(this,this._formatWithLibPhone(b,"E164"))},_validateWithLibPhone:function(b){try{var a=libphonenumber.parsePhoneNumber(b,this.libPhoneLanguageCode),c=a&&a.isPossible()&&a.isValid();return this.forceNationalNumbers?
c&&a.country===this.libPhoneLanguageCode:c}catch(k){return!1}},_formatWithLibPhone:function(b,a){if(window.libphonenumber&&this.useLibPhone){try{var c=libphonenumber.parsePhoneNumber(b,this.libPhoneLanguageCode)}catch(k){return b}switch(a||this.libPhoneFormat){case "E164":return c.format("E.164");case "national":return c.format("NATIONAL");case "international":return c.format("INTERNATIONAL");case "idd":return c.format("IDD",{fromCountry:this.libPhoneLanguageCode})}}return b}});f.defineProps({libPhoneLanguageCode:{get:function(){return b.bf.context.googlePhoneLibNation}},
useLibPhone:{get:function(){return b.bf.context.useGooglePhoneLib}},libPhoneFormat:{get:function(){return this.getAttribute("libPhoneFormat")}},forceNationalNumbers:{get:function(){return this.getAttribute("forceNationalNumbers")}},userInputValue:{get:function(){return this._userInputValue},set:function(b){this._userInputValue!==b&&(this._userInputValue=b)}}})})(window._,guidelib);
(function(d,b){var f=b.model.GuideSchema=b.model.GuideSchema.extend({initialize:function(){f._super.initialize.call(this);this.addSchema("guidePolicyConsent",[["policyId","string",null],["countryOverride","string",null],["localeOverride","string",null],["_value","string",null,"rawValue"],["mandatoryMessage","string",b.util.GuideUtil.getLocalizedMessage("",b.i18n.LogMessages["AEM-AF-901-005"]),"mandatoryMessage"],["validationState","boolean",!1],["usageToggleText","string",null]],"guideCompositeField")}})})(_,
guidelib);
(function(d,b,f){b.event.BusinessFormsEvent=b.event.BusinessFormsEvent||{};b.event.BusinessFormsEvent.POLICY_SPEC_CHANGED="bf.policySpecChanged";b.event.BusinessFormsEvent.POLICY_CHANNELS_CHANGED="bf.policyChannelsChanged";var e=b.model.GuidePolicyConsent=b.model.GuideCompositeField.extend({msClassName:"guidePolicyConsent",_contactChannelMap:{EMAIL:"INT",PHONE:"TEL",PHONE_MESSENGER_SERVICES:"MOB",MAIL:"LET",IN_CAR:"INCAR"},initialize:function(){e._super.initialize.call(this);this.isValid=!0;this.forceErrorShow=
!1;this._failedTest=null;this._errorText="";this._channelParameters=null;this._channelItems=[];this._channelFirstImplicit=this._showChannelRadios=!1;d.isEmpty(this.policySpecification.value)?this._updatePolicySpec():this._extractChannelParameters(this.policySpecification.value)},_updatePolicySpec:function(){var a=b.bf.ws.Registry.BUSINESS_FORMS_GCDM_POLICY_MANAGER$GET_DOCUMENTS_POLICYDOCUMENTNAME_COUNTRY,c={country:this.countryOverride||b.bf.context.market,policyDocumentName:this.policyId,currentResource:b.bf.form.resource,
KeyId:b.bf.context.pm2ApiKey,serviceType:"GCDM_POLICY"};b.bf&&b.bf.ws&&b.bf.ws.RemoteUtil&&b.bf.ws.RemoteUtil.executeFDMOperation(a,c,function(a,g,d){this.logger().trace("AF","response from policy service: {0}",[d]);a.originCode&&"200"!==a.originCode||a.errorCode?this._guide().executeExpression("submitError",{error:{code:a.originCode||a.errorCode,message:a.errorMessage||"Unable to retrieve policy data.",origin:"PolicyConsentInitialization",details:c}}):(a=this._transformPolicySpec(a),this.policySpecification.value=
JSON.stringify(a),this.channelParameters=this._extractChannelParameters(a),this._triggerEvent(b.event.BusinessFormsEvent.POLICY_SPEC_CHANGED),this._enforceImplicitUsages(),this._handleExistingMarketingConsents())}.bind(this),function(a,b){this.logger().error("AF","Error retrieving policy via FDM: {0}",[b]);this._guide().executeExpression("submitError",{error:{code:a.status,message:"Unable to retrieve policy data.",origin:"PolicyConsentInitialization",details:b}})}.bind(this),this)},_transformPolicySpec:function(a){for(var c=
this.localeOverride||b.bf.context.lang,e=c.split("_")[0],g=null,f=0;f<a.textBlocks.length;f++){var l=a.textBlocks[f];if(l.language===c||l.language===e)if(g=l,l.language===c)break}if(!g)throw this._guide().executeExpression("submitError",{error:{message:"Unable to retrieve policy data for given language.",origin:"PolicyConsentInitialization",details:c}}),Error("Language not contained in policy specification: "+c+"\n"+a);this._embedDisplayOptions(g);g.usageDefinitions=d.chain(g.usageDefinitions).sortBy("ordinalNumber").map(function(a){a.usages=
d.sortBy(a.usages,"ordinalNumber");return a}).value();a.textBlocks=[g];return a},_embedDisplayOptions:function(a){var b=this.jsonModel.usageDefinitions,e={};d.chain(b).filter(function(a,c){return b.hasOwnProperty(c)&&f.isPlainObject(a)}).each(function(a){e[a.usageDefinitionId]=a.displayPolicyUsages}).value();d.each(a.usageDefinitions,function(a){a.display=e[a.id]})},_extractChannelParameters:function(a){var b={};if(a&&this.showPreferredContactChannel){a=a.textBlocks[0].usageDefinitions;var e=[],g=
{},f=null;b.hasDropdown=a.some(function(a){return"NEVER"!==a.display?!1:1<a.usages.filter(function(a){return this._contactChannelMap[a.usage.name]}.bind(this)).length}.bind(this));a.forEach(function(a){a.usages.forEach(function(b){var c=b.usage.name;this._contactChannelMap[c]&&!g[c]&&(e.push(this._contactChannelMap[c]+"\x3d"+b.usage.label),g[c]=!0,f=a)}.bind(this))}.bind(this));b[f.id]={suffixDropdown:!0};a.forEach(function(a){var c=0,g=null;a.usages.forEach(function(e){var d=this._contactChannelMap[e.usage.name];
d&&(g={label:e.usage.label,value:d},this._setDeep(b,[a.id,"usages",e.id],g),c++)}.bind(this));if(1===c&&(!a.display||"NEVER"===a.display||("MORE_THAN_ONE"===a.display||"ON_DEMAND"===a.display)&&1===a.usages.length)){var e=b[a.id];d.extend(e,g);delete e.usages}}.bind(this));if(a.every(function(a){var c=b[a.id];return!c||void 0===c.value&&"ON_DEMAND"===a.display}))d.chain(a).filter({display:"ON_DEMAND"}).each(function(a){var c=b[a.id];c&&d.find(a.usages,function(a){if(a=c.usages[a.id])return a.prefixGroupLabel=
!0,a.groupLabel=this.channelRadioLabel,!0}.bind(this))}.bind(this)).value();else for(var l=this,n=0;n<a.length;n++){var p=a[n],h=b[p.id];if(h){if(void 0!==h.value){h.prefixGroupLabel=!0;h.groupLabel=this.channelRadioLabel;break}if("ON_DEMAND"===h.display){h.prefixGroupLabelBeforeUsageArea=!0;h.groupLabel=this.channelRadioLabel;break}if(d.find(p.usages,function(a){if(a=this.usages&&this.usages[a.id])return a.prefixGroupLabel=!0,a.groupLabel=l.channelRadioLabel,!0},h))break}}this.channelParameters=
b;this.channelItems=e;var q=[];d.each(JSON.parse(this.policyChoices.value||"{}"),function(){d.each(p,function(a,b){a&&this._contactChannelMap[b]&&q.push(this)},this)},this);this._setAvailableChannels(q)}return this.channelParameters=b},_setDeep:function(a,b,e){b.reduce(function(a,c,d){return"undefined"===typeof a[c]&&d!==b.length-1?(a[c]={},a[c]):d===b.length-1?a[c]=e:a[c]},a)},_enforceImplicitUsages:function(){var a=JSON.parse(this.policyChoices.value||"{}"),b=!1;d.each(JSON.parse(this.policySpecification.value).textBlocks[0].usageDefinitions,
function(c){d.chain(c.usages).filter(function(a){return"IMPLICIT"===a.variant},this).each(function(e){a[c.id]&&a[c.id][e.usage.name]||(b=!0,a[c.id]=a[c.id]||{},a[c.id][e.usage.name]=!0)},this).value()},this);b&&(this.policyChoices.value=JSON.stringify(a));return b},_handleExistingMarketingConsents:function(){if(this.policySpecification&&this.policySpecification.value&&this.existingMarketingConsentCountries&&0<this.existingMarketingConsentCountries.length){var a=JSON.parse(this.policySpecification.value),
b=a.country;a=this.getOrElse(a,"textBlocks.0.usageDefinitions",[]);var e=!1;-1<this.existingMarketingConsentCountries.indexOf(b)&&(e=a.some(function(a){if(a.purposes.some(function(a){return a.purpose&&"MARKETING"===a.purpose.name}))return!0}));e&&(this.visible=!1,this.hideComponentWithClass(e,"hideIfMarketingConsentExists"))}},_setAvailableChannels:function(a){var c=this.preferredContactChannel.value,e=!1,d=this.channelItems.filter(function(b){b=b.split("\x3d",2)[0];var d=-1<a.indexOf(b);d&&b===c&&
(e=!0);return d});this.preferredContactChannel.items=d;e||(c=null);!c&&0<d.length&&(this.channelMandatory||this.channelFirstImplicit&&!this.channelSelectedManually)&&(c=d[0].split("\x3d",2)[0]);(d=1<d.length&&this.showPreferredContactChannel)||this.channelMandatory||this.channelFirstImplicit||(c=null);this.preferredContactChannel.visible=d&&this.channelParameters.hasDropdown;this.showChannelRadios=d&&!this.channelParameters.hasDropdown;c!==this.preferredContactChannel.value&&(this.preferredContactChannel.value=
c);this._triggerEvent(b.event.BusinessFormsEvent.POLICY_CHANNELS_CHANGED)},_collectExpressions:function(){e._super._collectExpressions.apply(this);this._compiledScripts.validateAllExp=this._compileExpression("this._runTests()",null)},validate:function(a){if(!this.visible)return!0;d.isUndefined(a)&&(a=[]);var b=!0;this._runTests(!0);this._errorText&&(a.push({som:this.somExpression,errorText:this._errorText}),b=!1);return b},_runTests:function(a){var c=this._errorText,e=this.validationState,d={validFlag:!0,
forceRun:a};if(!0===this.validationsDisabled)return!0;this._runValidations(d);d.validFlag?(this._errorText="",this.validationState=!0,this._failedTest=null):this.validationState=!1;if(c!==this._errorText||e!==this.validationState||a)a&&(this.forceErrorShow=!0),this._triggerEvent(b.event.GuideModelEvent.ERROR_CHANGED,"validationStatus",this.validationState,this._errorText);return this.validationState},_runValidations:function(a){a.validFlag=this._runMandatoryTest();a.validFlag||(this._errorText=this.mandatoryMessage,
this._failedTest=this.guideUtil.MANDATORY_TEST);a.validFlag&&this.validateExp&&(a.validFlag=this.executeExpression("validateExp"),a.validFlag||(this._errorText=this.validateExpMessage,this._failedTest=this.guideUtil.SCRIPT_TEST))},_runMandatoryTest:function(){if(!this.policySpecification||!this.policyChoices)return!0;var a=JSON.parse(this.policySpecification.value),b=JSON.parse(this.policyChoices.value||"{}"),e=!0;d.each(a.textBlocks[0].usageDefinitions,function(a){d.chain(a.usages).filter(function(a){return"IMPLICIT"===
a.variant||"MANDATORY"===a.variant},this).each(function(c){b[a.id]&&b[a.id][c.usage.name]||(e=!1)},this).value()},this);return e}});e.defineProps({policyId:{get:function(){return this.getAttribute("policyId")}},countryOverride:{get:function(){return this.getAttribute("countryOverride")}},localeOverride:{get:function(){return this.getAttribute("localeOverride")}},usageToggleText:{get:function(){return this.getAttribute("policyUsageToggleText")}},placeholderText:{get:function(){return this.getAttribute("placeholderText")}},
showPreferredContactChannel:{get:function(){return this.getAttribute("showPreferredContactChannel")}},channelRadioLabel:{get:function(){return this.getAttribute("channelRadioLabel")}},channelMandatory:{get:function(){return this.preferredContactChannel.getAttribute("mandatory")}},validationState:{get:function(){return this.isValid},set:function(a){var b=this.isValid;b!==a&&(this.isValid=a,this._triggerOnBridge("elementValidationStatusChanged",this,"validationStatus",b,a))}},mandatory:{get:function(){return this.getAttribute("mandatory")},
set:function(a){var c=this.getAttribute("mandatory");void 0!==a&&c!==a&&(this.bindNode?this._setXFAMandatory(a):this.jsonModel.mandatory=!!a,this._triggerEvent(b.event.GuideModelEvent.MODEL_CHANGED,"mandatory",c,a))}},mandatoryMessage:{get:function(){return this.getAttribute("mandatoryMessage")}},channelParameters:{get:function(){return this._channelParameters},set:function(a){this._channelParameters!==a&&(this._channelParameters=a)}},channelItems:{get:function(){return this._channelItems},set:function(a){this._channelItems!==
a&&(this._channelItems=a)}},channelFirstImplicit:{get:function(){return this._channelFirstImplicit}},channelSelectedManually:{get:function(){return!!this.jsonModel.channelSelectedManually},set:function(a){this.jsonModel.channelSelectedManually!==a&&(this.jsonModel.channelSelectedManually=!!a)}},showChannelRadios:{get:function(){return this._showChannelRadios},set:function(a){this._showChannelRadios!==a&&(this._showChannelRadios=a)}},existingMarketingConsentCountries:{get:function(){return this.getAttribute("existingMarketingConsentCountries")},
set:function(a){var b=this.jsonModel.existingMarketingConsentCountries!==a;this.setAttribute(a,"existingMarketingConsentCountries");b&&this._handleExistingMarketingConsents()}}});e.addMixins([b.model.mixin.HideByClass])})(_,guidelib,$);
(function(d,b,f){var e=f.view.GuidePolicyConsentView=f.view.GuideCompositeFieldView.extend({_defaultWidgetName:"policyConsent",initialize:function(){e._super.initialize.apply(this,arguments);this._model&&(this._model.on(f.event.BusinessFormsEvent.POLICY_SPEC_CHANGED,this.handleSpecificationModelChanged,this),this._model.on(f.event.BusinessFormsEvent.POLICY_CHANNELS_CHANGED,this.handleChannelModelChanged,this));this.channelDropdown=this._createChild(d("#"+this._model.preferredContactChannel.id))},
_unloadView:function(){this._model.off(f.event.BusinessFormsEvent.POLICY_SPEC_CHANGED,this.handleSpecificationModelChanged,this);this._model.off(f.event.BusinessFormsEvent.POLICY_CHANNELS_CHANGED,this.handleChannelModelChanged,this);e._super._unloadView.apply(this,arguments)},_initializeWidget:function(){this.$element.find("div.guideFieldWidget").length?this.$widget=this.$element.find("div.guideFieldWidget").first():this.$widget=null;if(this.$widget){var a=xfalib.ut.XfaUtil.prototype;d(this.$widget).on(this.getCommitEvent(),
this.handleCommit.bind(this)).on(a.XFA_CLICK_EVENT,this.handleClick.bind(this)).on(a.XFA_EXIT_EVENT,this.handleFocusOut.bind(this)).on(a.XFA_ENTER_EVENT,this.handleEnter.bind(this)).on("preferredChannelChange",this.handlePreferredChannelWidgetChange.bind(this)).on("availableChannelsChange",this.handleAvailableChannelsWidgetChange.bind(this))}},tempXfaFixes:function(){},getModelNameOptionsMap:function(){var a=e._super.getModelNameOptionsMap.apply(this,arguments);return d.extend({},a,{policyChoices:"value",
policySpecification:"specification",preferredContactChannel:"channel"})},_createChild:function(a){a=f.view.GuideViewRegistry.prototype.createView(a,this);a.postInitialize();return a},createWidgetOptions:function(){var a=e._super.createWidgetOptions.apply(this,arguments);return d.extend({},a,{value:this._model.policyChoices.value,specification:this._model.policySpecification.value,channel:this._model.preferredContactChannel.value,channelParameters:this._model.channelParameters,$channelDropdown:d(".gcdm-policy__preferred-contact-channel",
this.$element),policyId:this._model.policyId,required:this._model.mandatory,enabled:this._model.enabled,usageToggleText:this._model.usageToggleText,placeholder:this._model.placeholderText,showChannelRadios:this._model.showChannelRadios,showPreferredContactChannel:this._model.showPreferredContactChannel})},handleChannelModelChanged:function(){this.jqwidget&&this.jqwidget.option({showChannelRadios:this._model.showChannelRadios,channel:this._model.preferredContactChannel.value})},handleSpecificationModelChanged:function(){this.jqwidget&&
this.jqwidget.option({specification:this._model.policySpecification.value,channelParameters:this._model.channelParameters})},handleCommit:function(){var a=!1;b.each(this.getModelNameOptionsMap(),function(c,e){var d=this._model[e];b.isUndefined(d)||"preferredContactChannel"===e&&this._model.channelParameters.hasDropdown||(c=this.jqwidget.option(c),void 0===c||this.checkIfNull(c)&&this.checkIfNull(d.value)||c===d.value||(d.value=c,a=!0))}.bind(this));(a=a||this._model._enforceImplicitUsages())&&this._guide.queueExpressions(this._model,
["validateAllExp"]);this._model.executeExpression("valueCommitScript");this.execCommitExpression()},checkIfNull:function(a){return null==a||""===a},_propagatePreferredChannel:function(a){this._model.channelSelectedManually=!0;this.channelDropdown._model.value=a},handlePreferredChannelWidgetChange:function(a,b){this._propagatePreferredChannel(b)},handleAvailableChannelsWidgetChange:function(a,b){this._model._setAvailableChannels(b)}})})($,_,guidelib);
(function(d,b,f){var e=d.view.GuideEmissionConsumptionView=d.view.GuideFieldView.extend({postInitialize:function(){this._syncGuideNodeToHtml();this._setupReferenceLink()},setActive:function(a,b,d){e._super.setActive.call(this,a,b,d);b&&(this.$element&&this.$element.focus(),this._guideView.currentFocusItemSom=this._model.somExpression);return!0},handleValueChanged:function(a){switch(a._property){case "value":var b=null;null!==a.newText&&(b=JSON.parse(a.newText));this._handleEmissionConsumptionDataChanged(b)}},
_setupReferenceLink:function(){var a=b(".afHeader"),c=0<a.length?a:b(".md-component.md-navigation",parent.document);if(-1<window.navigator.userAgent.indexOf("Edge/"))if(b(".md-custom-overlay-main-selector").children().length||c===a)b(".bmw-disclaimer-reference").on("click",function(){b("html, body").animate({scrollTop:b(".bmw-disclaimer-text").offset().top-c.height()},600)});else if(b(".md-custom-overlay-main-selector",parent.document).children().length)b(".bmw-disclaimer-reference").on("click",function(){b("html, body").animate({scrollTop:b(".bmw-disclaimer-text").offset().top-
c.height()},600)});else b(".bmw-disclaimer-reference").on("click",function(){b("html, body",parent.document).animate({scrollTop:b(".bmw-disclaimer-text").offset().top-c.height()},600)});else if(b(".md-custom-overlay-main-selector").children().length||c===a)b(".bmw-disclaimer-reference").on("click",function(){b("html").animate({scrollTop:b(".bmw-disclaimer-text").offset().top-c.height()},600)});else if(b(".md-custom-overlay-main-selector",parent.document).children().length)b(".bmw-disclaimer-reference").on("click",
function(){b("html").animate({scrollTop:b(".bmw-disclaimer-text").offset().top-c.height()},600)});else b(".bmw-disclaimer-reference").on("click",function(){b("html",parent.document).animate({scrollTop:b(".bmw-disclaimer-text").offset().top-c.height()},600)})},_resetMarkup:function(){this._updateMarkup("","","","")},_updateMarkup:function(a,c,e,d){console.log(d);d?"repeatable"===d?console.log(this.$element):(d="repeatable"===d?b("img"):b('img[data-name\x3d"'+d+'"'),0!==d.length&&null!==d.attr("src")&&
(b(".bmw-emission-box",this.$element).text(a),b(".bmw-disclaimer-text").html(c),b(".bmw-disclaimer-reference").empty().append("\x3csup\x3e"+e+"\x3c/sup\x3e"))):(b(".bmw-emission-box",this.$element).text(a),b(".bmw-disclaimer-text").html(c),b(".bmw-disclaimer-reference").empty().append("\x3csup\x3e"+e+"\x3c/sup\x3e"))},_hasDisclaimerMarkup:function(){return 0<b(".bmw-disclaimer-text").length},_createDisclaimerText:function(a,b){return(a="NEDCCorrelated"===a?this._model[b+"_nedcCorrWltpDisclaimer"]:
this._model[b+"_nedcDisclaimer"])&&a.replaceAll(/\S+(?=<\/a>)/g,function(a){var b=a.replace(/^(https:\/\/|http:\/\/|)/,"https://");try{return new URL(b),'\x3ca rel\x3d"nofollow" href\x3d"'+encodeURI(b)+'" target\x3d"_blank" title\x3d"'+a+'"\x3e'+a}catch(m){return a}})},_raiseUnresolvableError:function(a){window.guideBridge.trigger("unresolveableErrorEvent",[d.bf.form.defaultErrorPage,{error:"VehicleSelectionError",message:"Form data not submitted - Data was send to GCDM but replied with an error - Error not resolveable by enduser.",
extra:""+a}])},_createMeasurementMatrix:function(a,b,d){d=void 0===d?!1:d;var c={petrolEquivalent:{Max:"technicalDataMax.consumptionMax.petrolEquivalentOverall",Min:"technicalDataMin.consumptionMin.petrolEquivalentOverall"},CO2EmissionProduction:{Max:"technicalDataMax.consumptionMax.co2EquivalentOverall",Min:"technicalDataMin.consumptionMin.co2EquivalentOverall"}};if("nedc"===b)f.extend(c,{CO2Emission:{Max:"technicalDataMax.consumptionMax.co2Overall",Min:"technicalDataMin.consumptionMin.co2Overall"}}),
"nohy"!==a&&"hybr"!==a&&"phev"!==a||f.extend(c,{fuelConsumption:{Max:"technicalDataMax.consumptionMax.consumptionOverall",Min:"technicalDataMin.consumptionMin.consumptionOverall"}}),"phev"!==a&&"beve"!==a||f.extend(c,{electricConsumption:{Max:"technicalDataMax.electric.electricConsumptionMax",Min:"technicalDataMin.electric.electricConsumptionMin"}}),"phev"===a&&f.extend(c,{electricRange:{Max:"technicalDataMax.electric.electricRangeMax",Min:"technicalDataMin.electric.electricRangeMin"}}),"beve"===
a&&f.extend(c,{electricRange:{Max:"technicalDataMax.electric.electricRangeMax",Min:"technicalDataMin.electric.electricRangeMin"}});else if("wltp"===b)switch(a){case "hybr":f.extend(c,{CO2Emission:{Max:"technicalDataMax.emissionDataWltpMax.co2ChargeSustaining.combined",Min:"technicalDataMin.emissionDataWltpMin.co2ChargeSustaining.combined"},fuelConsumption:{Max:"technicalDataMax.emissionDataWltpMax.fuelConsumptionChargeSustaining.combined",Min:"technicalDataMin.emissionDataWltpMin.fuelConsumptionChargeSustaining.combined"}});
break;case "nohy":f.extend(c,{CO2Emission:{Max:d?"technicalDataMax.emissionDataWltpMax.co2ChargeSustaining.combined":"technicalDataMax.emissionDataWltpMax.co2.combined",Min:d?"technicalDataMin.emissionDataWltpMin.co2ChargeSustaining.combined":"technicalDataMin.emissionDataWltpMin.co2.combined"},fuelConsumption:{Max:d?"technicalDataMax.emissionDataWltpMax.fuelConsumptionChargeSustaining.combined":"technicalDataMax.emissionDataWltpMax.fuelConsumption.combined",Min:d?"technicalDataMin.emissionDataWltpMin.fuelConsumptionChargeSustaining.combined":
"technicalDataMin.emissionDataWltpMin.fuelConsumption.combined"}});break;case "phev":f.extend(c,{CO2Emission:{Max:"technicalDataMax.emissionDataWltpMax.co2Weighted",Min:"technicalDataMin.emissionDataWltpMin.co2Weighted"},fuelConsumption:{Max:"technicalDataMax.emissionDataWltpMax.fuelConsumptionWeighted",Min:"technicalDataMin.emissionDataWltpMin.fuelConsumptionWeighted"},electricConsumption:{Max:"technicalDataMax.emissionDataWltpMax.electricConsumptionAcWeighted",Min:"technicalDataMin.emissionDataWltpMin.electricConsumptionAcWeighted"},
electricRange:{Max:"technicalDataMin.emissionDataWltpMax.equivalentAllElectricRange.combined",Min:"technicalDataMin.emissionDataWltpMin.equivalentAllElectricRange.combined"}});break;case "beve":f.extend(c,{CO2Emission:{isLiteralMaxMin:!0,Max:"0",Min:"0"},electricConsumption:{Max:"technicalDataMax.emissionDataWltpMax.electricConsumption.combined",Min:"technicalDataMin.emissionDataWltpMin.electricConsumption.combined"},electricRange:{Max:"technicalDataMax.emissionDataWltpMax.pureElectricRange.combined",
Min:"technicalDataMin.emissionDataWltpMin.pureElectricRange.combined"}})}"beve"===a&&f.extend(c,{zero:{literal:"0 "}});return c},_formatNumber:function(a){return a.toString().replace(".",d.i18n.numberSymbols.decimal).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d.i18n.numberSymbols.grouping)},_extractValue:function(a,b,d,e,f){if(!a)return"";var c=!1,g=/^(.*?)(Min|Max)?$/.exec(a);if(g){var k=b[g[1]];if(k)if(void 0!==k.literal)var h=k.literal;else{var m=k[g[2]];if(m)if(k.isLiteralMaxMin)h=m;else if(h=this.getOrElse(d,
m,null),null===h)if(f)h=void 0;else if("nedc"===this._model.measurementtype)h="-",console.warn("One of the emission or consumption data values requested was null on NEDC: "+a);else throw Error("One of the emission or consumption data values requested was null: "+a);else h=e+this._formatNumber(h)}}return void 0!==h?(f&&(g[2]?(a=this._extractValue(g[1]+("Min"===g[2]?"Max":"Min"),b,d,e,!1),c=h===a):c=!0),c?"":h):""},_handleEmissionConsumptionDataChanged:function(a){if(a&&"none"!==a.source)if(this._model.whereToDisplay===
a.source||"both"===this._model.whereToDisplay)try{if(a.hybridCode){var b=a.hybridCode.toLowerCase(),d=this._createMeasurementMatrix(b,this._model.measurementtype,!!a.technicalDataMax.volt48);b="hybr"===b?"nohy":b;var e=[];this._model[b+"_consumptionemissionvalues"].forEach(function(b){var c=b.description+" ";c+=this._extractValue(b.minValue,d,a,"",!1);c+=this._extractValue(b.maxValue,d,a," - ",!0);b.unit&&(c+=" "+b.unit);c.length&&e.push(c)}.bind(this));var f="";this._hasDisclaimerMarkup()&&(f=this._createDisclaimerText(a.drivingCycle,
b));this._updateMarkup(e.join(", "),f,f?"[1]":"",this._model.linkCosy)}else this._raiseUnresolvableError(Error("No hybrid code specified. Cannot determine which type of consumption/emission data to display."))}catch(l){this._raiseUnresolvableError(l)}else this._resetMarkup();else this._resetMarkup()}})})(guidelib,$,window._);
(function(d,b){var f=b.model.GuideSchema=b.model.GuideSchema.extend({initialize:function(){f._super.initialize.call(this);this.addSchema("guideEmissionConsumption",[["whereToDisplay","string",null],["linkCosy","string",null],["measurementtype","string",null],["nohy_consumptionemissionvalues","object",null],["nohy_nedcDisclaimer","string",null],["nohy_nedcCorrWltpDisclaimer","string",null],["phev_consumptionemissionvalues","object",null],["phev_nedcDisclaimer","string",null],["phev_nedcCorrWltpDisclaimer",
"string",null],["beve_consumptionemissionvalues","object",null],["beve_nedcDisclaimer","string",null],["beve_nedcCorrWltpDisclaimer","string",null]],"scriptable")}})})(_,guidelib);
(function(d,b){var f=b.model.GuideEmissionConsumption=b.model.Field.extend({msClassName:"guideEmissionConsumption",emissionConsumptionDataHandler:null,initialize:function(){f._super.initialize.apply(this);this.emissionConsumptionDataHandler=this._handleEmissionConsumptionDataEvent.bind(this);this._guide().on("emissionConsumptionData",this.emissionConsumptionDataHandler)},_unloadModel:function(){this._guide().off("emissionConsumptionData",this.emissionConsumptionDataHandler);this.emissionConsumptionDataHandler=
null;f._super._unloadModel.apply(this)},convertConsumptionEmissionList:function(b){var a=[],c=/^item(\d+)$/,d=/_(.*)$/;Object.keys(b).forEach(function(d){var e=c.exec(d);e&&a.push({order:parseInt(e[1],10),obj:b[d]})});return a.sort(function(a,b){return a.order-b.order}).map(function(a){var b={};Object.keys(a.obj).forEach(function(c){var e=d.exec(c);e&&(b[e[1]]=a.obj[c])});return b})},_handleEmissionConsumptionDataEvent:function(b){this.value="object"===typeof b&&null!==b?JSON.stringify(b):b?b:null}});
f.defineProps({whereToDisplay:{get:function(){return this.getAttribute("whereToDisplay")}},linkCosy:{get:function(){return this.getAttribute("linkCosy")}},measurementtype:{get:function(){return this.getAttribute("measurementtype")}},nohy_consumptionemissionvalues:{get:function(){return this.convertConsumptionEmissionList(this.getAttribute("nohy_consumptionemissionvalues"))}},phev_consumptionemissionvalues:{get:function(){return this.convertConsumptionEmissionList(this.getAttribute("phev_consumptionemissionvalues"))}},
beve_consumptionemissionvalues:{get:function(){return this.convertConsumptionEmissionList(this.getAttribute("beve_consumptionemissionvalues"))}},nohy_nedcDisclaimer:{get:function(){return this.getAttribute("nohy_nedcDisclaimer")}},phev_nedcDisclaimer:{get:function(){return this.getAttribute("phev_nedcDisclaimer")}},beve_nedcDisclaimer:{get:function(){return this.getAttribute("beve_nedcDisclaimer")}},nohy_nedcCorrWltpDisclaimer:{get:function(){return this.getAttribute("nohy_nedcCorrWltpDisclaimer")}},
phev_nedcCorrWltpDisclaimer:{get:function(){return this.getAttribute("phev_nedcCorrWltpDisclaimer")}},beve_nedcCorrWltpDisclaimer:{get:function(){return this.getAttribute("beve_nedcCorrWltpDisclaimer")}}})})(window._,guidelib);
(function(d,b,f){var e=d.view.GuideGenericImageView=d.view.GuideBaseView.extend({handleModelChanged:function(a){e._super.handleModelChanged.apply(this,arguments);switch(a._property){case "imageUrl":b("img",this.$element).attr({src:a.newText});break;case "altText":b("img",this.$element).attr({alt:a.newText})}}})})(guidelib,$,window._);
(function(d,b){var f=b.model.GuideSchema=b.model.GuideSchema.extend({initialize:function(){f._super.initialize.call(this);this.addSchema("guideGenericImage",[["altText","string",null],["imageUrl","string",null]],"scriptable")}})})(_,guidelib);
(function(d,b){var f=b.model.GuideGenericImage=b.model.Scriptable.extend({msClassName:"guideGenericImage",loading:!1,initialize:function(){f._super.initialize.apply(this);this._guide().on("bfImageData",this._handleDynamicImageChange.bind(this))},_handleDynamicImageChange:function(b){this.altText=b.altText;this.imageUrl=b.imageUrl}});f.defineProps({imageUrl:{get:function(){return this.getAttribute("imageUrl")},set:function(b){var a=this,c=this;if(b){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(this.readyState==
this.HEADERS_RECEIVED){var a=parseInt(d.getResponseHeader("errorcode"));10640==a||10260==a?c.setAttribute(null,"imageUrl"):c.setAttribute(b,"imageUrl")}};d.onerror=function(){return a.setAttribute(null,"imageUrl")};d.open("HEAD",b);d.send()}else this.setAttribute(b,"imageUrl")}},altText:{get:function(){return this.getAttribute("altText")},set:function(b){this.setAttribute(b,"altText")}}})})(window._,guidelib);