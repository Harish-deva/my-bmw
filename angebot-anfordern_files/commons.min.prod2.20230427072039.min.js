/*
 regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(f){var y=0;return function(){return y<f.length?{done:!1,value:f[y++]}:{done:!0}}};$jscomp.arrayIterator=function(f){return{next:$jscomp.arrayIteratorImpl(f)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,y,I){f!=Array.prototype&&f!=Object.prototype&&(f[y]=I.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var f=0;return function(y){return $jscomp.SYMBOL_PREFIX+(y||"")+f++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.asyncIterator;f||(f=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};
$jscomp.makeIterator=function(f){var y="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];return y?y.call(f):$jscomp.arrayIterator(f)};
(function(){function f(B){var l=I[B];if(void 0!==l)return l.exports;l=I[B]={exports:{}};y[B](l,l.exports,f);return l.exports}var y={591:function(f,l,v){function t(){function l(c,e,r){return Object.defineProperty(c,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),c[e]}function v(p,e,r,f){e=Object.create((e&&e.prototype instanceof c?e:c).prototype);f=new M(f||[]);return e._invoke=function(e,c,p){var d="suspendedStart";return function(k,r){if("executing"===d)throw Error("Generator is already running");
if("completed"===d){if("throw"===k)throw r;return U()}p.method=k;for(p.arg=r;;){if(k=p.delegate)if(k=I(k,p)){if(k===A)continue;return k}if("next"===p.method)p.sent=p._sent=p.arg;else if("throw"===p.method){if("suspendedStart"===d)throw d="completed",p.arg;p.dispatchException(p.arg)}else"return"===p.method&&p.abrupt("return",p.arg);d="executing";k=x(e,c,p);if("normal"===k.type){if(d=p.done?"completed":"suspendedYield",k.arg===A)continue;return{value:k.arg,done:p.done}}"throw"===k.type&&(d="completed",
p.method="throw",p.arg=k.arg)}}}(p,r,f),e}function x(c,e,r){try{return{type:"normal",arg:c.call(e,r)}}catch(L){return{type:"throw",arg:L}}}function c(){}function y(){}function w(){}function Z(c){["next","throw","return"].forEach(function(e){l(c,e,function(c){return this._invoke(e,c)})})}function H(c,e){function p(r,k,f,d){r=x(c[r],c,k);if("throw"!==r.type){var l=r.arg;return(r=l.value)&&"object"==B(r)&&C.call(r,"__await")?e.resolve(r.__await).then(function(c){p("next",c,f,d)},function(c){p("throw",
c,f,d)}):e.resolve(r).then(function(d){l.value=d;f(l)},function(c){return p("throw",c,f,d)})}d(r.arg)}var f;this._invoke=function(c,k){function r(){return new e(function(d,e){p(c,k,d,e)})}return f=f?f.then(r,r):r()}}function I(c,e){var p=c.iterator[e.method];if(void 0===p){if(e.delegate=null,"throw"===e.method){if(c.iterator["return"]&&(e.method="return",e.arg=void 0,I(c,e),"throw"===e.method))return A;e.method="throw";e.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}p=
x(p,c.iterator,e.arg);return"throw"===p.type?(e.method="throw",e.arg=p.arg,e.delegate=null,A):(p=p.arg)?p.done?(e[c.resultName]=p.value,e.next=c.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,A):p:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,A)}function aa(c){var e={tryLoc:c[0]};1 in c&&(e.catchLoc=c[1]);2 in c&&(e.finallyLoc=c[2],e.afterLoc=c[3]);this.tryEntries.push(e)}function O(c){var e=c.completion||{};e.type="normal";
delete e.arg;c.completion=e}function M(c){this.tryEntries=[{tryLoc:"root"}];c.forEach(aa,this);this.reset(!0)}function ka(c){if(c){var e=c[P];if(e)return e.call(c);if("function"==typeof c.next)return c;if(!isNaN(c.length)){var p=-1;e=function z(){for(;++p<c.length;)if(C.call(c,p))return z.value=c[p],z.done=!1,z;return z.value=void 0,z.done=!0,z};return e.next=e}}return{next:U}}function U(){return{value:void 0,done:!0}}f.exports=t=function(){return D};f.exports.__esModule=!0;f.exports["default"]=f.exports;
$jscomp.initSymbol();$jscomp.initSymbol();var D={},V=Object.prototype,C=V.hasOwnProperty,J="function"==typeof Symbol?Symbol:{},P=J.iterator||"@@iterator",na=J.asyncIterator||"@@asyncIterator",W=J.toStringTag||"@@toStringTag";try{l({},"")}catch(p){l=function(c,p,f){return c[p]=f}}D.wrap=v;var A={};J={};l(J,P,function(){return this});var F=Object.getPrototypeOf;(F=F&&F(F(ka([]))))&&F!==V&&C.call(F,P)&&(J=F);var G=w.prototype=c.prototype=Object.create(J);return y.prototype=w,l(G,"constructor",w),l(w,
"constructor",y),y.displayName=l(w,W,"GeneratorFunction"),D.isGeneratorFunction=function(c){c="function"==typeof c&&c.constructor;return!!c&&(c===y||"GeneratorFunction"===(c.displayName||c.name))},D.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,w):(c.__proto__=w,l(c,W,"GeneratorFunction")),c.prototype=Object.create(G),c},D.awrap=function(c){return{__await:c}},Z(H.prototype),l(H.prototype,na,function(){return this}),D.AsyncIterator=H,D.async=function(c,e,r,f,l){void 0===l&&
(l=Promise);var k=new H(v(c,e,r,f),l);return D.isGeneratorFunction(e)?k:k.next().then(function(c){return c.done?c.value:k.next()})},Z(G),l(G,W,"Generator"),l(G,P,function(){return this}),l(G,"toString",function(){return"[object Generator]"}),D.keys=function(c){var e=[],p;for(p in c)e.push(p);return e.reverse(),function z(){for(;e.length;){var k=e.pop();if(k in c)return z.value=k,z.done=!1,z}return z.done=!0,z}},D.values=ka,M.prototype={constructor:M,reset:function(c){if(this.prev=0,this.next=0,this.sent=
this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!c)for(var e in this)"t"===e.charAt(0)&&C.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var c=this.tryEntries[0].completion;if("throw"===c.type)throw c.arg;return this.rval},dispatchException:function(c){function e(d,e){return k.type="throw",k.arg=c,p.next=d,e&&(p.method="next",p.arg=void 0),!!e}if(this.done)throw c;for(var p=this,f=this.tryEntries.length-
1;0<=f;--f){var l=this.tryEntries[f],k=l.completion;if("root"===l.tryLoc)return e("end");if(l.tryLoc<=this.prev){var t=C.call(l,"catchLoc"),d=C.call(l,"finallyLoc");if(t&&d){if(this.prev<l.catchLoc)return e(l.catchLoc,!0);if(this.prev<l.finallyLoc)return e(l.finallyLoc)}else if(t){if(this.prev<l.catchLoc)return e(l.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return e(l.finallyLoc)}}}},abrupt:function(c,e){for(var l=this.tryEntries.length-
1;0<=l;--l){var p=this.tryEntries[l];if(p.tryLoc<=this.prev&&C.call(p,"finallyLoc")&&this.prev<p.finallyLoc){var f=p;break}}f&&("break"===c||"continue"===c)&&f.tryLoc<=e&&e<=f.finallyLoc&&(f=null);l=f?f.completion:{};return l.type=c,l.arg=e,f?(this.method="next",this.next=f.finallyLoc,A):this.complete(l)},complete:function(c,e){if("throw"===c.type)throw c.arg;return"break"===c.type||"continue"===c.type?this.next=c.arg:"return"===c.type?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):
"normal"===c.type&&e&&(this.next=e),A},finish:function(c){for(var e=this.tryEntries.length-1;0<=e;--e){var f=this.tryEntries[e];if(f.finallyLoc===c)return this.complete(f.completion,f.afterLoc),O(f),A}},"catch":function(c){for(var e=this.tryEntries.length-1;0<=e;--e){var f=this.tryEntries[e];if(f.tryLoc===c){c=f.completion;if("throw"===c.type){var l=c.arg;O(f)}return l}}throw Error("illegal catch attempt");},delegateYield:function(c,e,f){return this.delegate={iterator:ka(c),resultName:e,nextLoc:f},
"next"===this.method&&(this.arg=void 0),A}},D}var B=v(8)["default"];f.exports=t;f.exports.__esModule=!0;f.exports["default"]=f.exports},8:function(f){function l(v){"@babel/helpers - typeof";$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return f.exports=l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(f){return typeof f}:function(f){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return f&&"function"==typeof Symbol&&f.constructor===Symbol&&
f!==Symbol.prototype?"symbol":typeof f},f.exports.__esModule=!0,f.exports["default"]=f.exports,l(v)}f.exports=l;f.exports.__esModule=!0;f.exports["default"]=f.exports},757:function(f,l,v){l=v(591)();f.exports=l;try{regeneratorRuntime=l}catch(t){"object"===typeof globalThis?globalThis.regeneratorRuntime=l:Function("r","regeneratorRuntime \x3d r")(l)}}},I={};(function(){f.n=function(B){var l=B&&B.__esModule?function(){return B["default"]}:function(){return B};f.d(l,{a:l});return l}})();(function(){f.d=
function(B,l){for(var v in l)f.o(l,v)&&!f.o(B,v)&&Object.defineProperty(B,v,{enumerable:!0,get:l[v]})}})();(function(){f.o=function(f,l){return Object.prototype.hasOwnProperty.call(f,l)}})();(function(){function y(c,b){for(var a=0;a<b.length;a++){var n=b[a];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(c,n.key,n)}}function l(c,b,a){b&&y(c.prototype,b);a&&y(c,a);Object.defineProperty(c,"prototype",{writable:!1});return c}function v(c,b){if(!(c instanceof
b))throw new TypeError("Cannot call a class as a function");}function t(c,b,a){b in c?Object.defineProperty(c,b,{value:a,enumerable:!0,configurable:!0,writable:!0}):c[b]=a;return c}function I(c,b){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(c);b&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}));a.push.apply(a,n)}return a}function oa(c){for(var b=1;b<arguments.length;b++){var a=null!=arguments[b]?arguments[b]:{};b%2?I(Object(a),
!0).forEach(function(b){t(c,b,a[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach(function(b){Object.defineProperty(c,b,Object.getOwnPropertyDescriptor(a,b))})}return c}function R(){return z>new Date?3E3:0}function x(c,b){try{c=c||"";var a=";na;not set;n/a;not available;not yet available;not selected;unknown".split(";"),n=c.split(".");a:{try{var d=window.digitals2&&window.digitals2.tracking&&window.digitals2.tracking.api;if("undefined"!=
typeof d){var m=d.getCurrentPageIndex();for(c=m;0<c;c--)if("object"==typeof d.getPageObject(c).page&&"VCO"==d.getPageObject(c).page.category.primaryCategory){m=c;break}var g=d.getPageObject(m);if("undefined"==typeof g.pageInstanceId||""==g.pageInstanceId||-1!=g.pageInstanceId.indexOf("need-analyzer"))"undefined"!=typeof g.component&&g&&g.component[0]&&g.component[0].category&&"stock locator"==g.component[0].category.subCategory01||"undefined"!=typeof g.component&&g&&g.component[0]&&g.component[0].componentInfo&&
"digital checkout solution"==g.component[0].componentInfo.componentName||"undefined"!=typeof g.pageInstanceId&&""!=g.pageInstanceId&&0<g.product.length||"undefined"!=typeof g.pageInstanceId&&""!=g.pageInstanceId&&(g=m&&0<m?d.getPageObject(m):d.getPageObject(0))}else if("undefined"!=typeof BMWdataLayer)g=JSON.parse(JSON.stringify(BMWdataLayer));else if("undefined"!=typeof mnm&&""!=((((mnm||"").mnmnsc||"").page||"").currentPage||"")&&"undefined"!=typeof mnm.mnmnsc.page.currentPage.getTrackingService)g=
mnm.mnmnsc.page.currentPage.getTrackingService().getDigitalData();else if("undefined"!=typeof datalayer_localForms){var q=(datalayer_localForms||"").event||[];g=0<q.length?q[q.length-1]:""}else if(window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&"undefined"==typeof window.digitalData&&window.dataLayer){var e=digital.tracking.getInstance(window.dataLayer),sa=e.getCurrentPageIndex()||0,f=e.getPageObject(sa);g=JSON.parse(JSON.stringify(f))}else if("undefined"!=
typeof window.h5vco&&""!=((window.h5vco||"").digitalData||""))g=window.h5vco.digitalData;else if("undefined"!=typeof window.dcsDataLayer&&""!=((window.dcsDataLayer||"").pages||"")){var k=window.dcsDataLayer.activePageIndex||0;g=window.dcsDataLayer.pages[k]}else"undefined"!=typeof window.dataLayer&&"undefined"!=typeof window.dataLayer.activePageIndex?(k=window.dataLayer.activePageIndex||0,g=""!=((window.dataLayer||"").pages||"")&&0<window.dataLayer.pages.length?window.dataLayer.pages[k]:window.dataLayer):
"undefined"!=typeof window.digitalData?g=JSON.parse(JSON.stringify(window.digitalData)):window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&"undefined"==typeof window.dataLayer&&(e=digital.tracking.getInstance(),sa=e.getCurrentPageIndex()||0,f=e.getPageObject(sa),g=JSON.parse(JSON.stringify(f)));var h=g;break a}catch(u){console.error(u,"datalayer not found")}h=void 0}for(g=0;g<n.length&&void 0!=h;g++)void 0!=n[g]&&""!=n[g]&&(h=Array.isArray(h)&&/-[0-9]+/.test(n[g])?
h[h.length-Math.abs(parseInt(n[g]))]:h[n[g]]);return"string"===typeof h&&-1<a.indexOf(h.toLowerCase())?b:h||b||""}catch(u){console.error("Error:datalayer fetch-",u)}}function c(c){return""!=x(c)?x(c):""}function za(c,b){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(c);b&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}));a.push.apply(a,n)}return a}function w(c){for(var b=1;b<arguments.length;b++){var a=null!=arguments[b]?arguments[b]:
{};b%2?za(Object(a),!0).forEach(function(b){t(c,b,a[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(a)):za(Object(a)).forEach(function(b){Object.defineProperty(c,b,Object.getOwnPropertyDescriptor(a,b))})}return c}function Z(c){"@babel/helpers - typeof";$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){$jscomp.initSymbol();
$jscomp.initSymbol();$jscomp.initSymbol();return b&&"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Z(c)}function H(c,b,a,n,d,m,g){try{var ba=c[m](g),e=ba.value}catch(ma){a(ma);return}ba.done?b(e):Promise.resolve(e).then(n,d)}function Ga(c){return function(){var b=this,a=arguments;return new Promise(function(n,d){function m(a){H(ba,n,d,m,g,"next",a)}function g(a){H(ba,n,d,m,g,"throw",a)}var ba=c.apply(b,a);m(void 0)})}}function aa(c,b){if(null==b||b>c.length)b=
c.length;for(var a=0,n=Array(b);a<b;a++)n[a]=c[a];return n}function O(c,b){if(c){if("string"===typeof c)return aa(c,b);var a=Object.prototype.toString.call(c).slice(8,-1);"Object"===a&&c.constructor&&(a=c.constructor.name);if("Map"===a||"Set"===a)return Array.from(c);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return aa(c,b)}}function M(c){var b=Array.isArray(c)?aa(c):void 0;b||($jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),b="undefined"!==typeof Symbol&&
null!=c[Symbol.iterator]||null!=c["@@iterator"]?Array.from(c):void 0);if(!(c=b||O(c)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return c}function ka(c,b){var a=Array.isArray(c)?c:void 0;if(!a)if($jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),a=null==c?null:"undefined"!==typeof Symbol&&c[Symbol.iterator]||c["@@iterator"],null==a)a=void 0;else{var n=[],d=!0,m=!1,
g;try{for(a=a.call(c);!(d=(g=a.next()).done)&&(n.push(g.value),!b||n.length!==b);d=!0);}catch(la){m=!0;var q=la}finally{try{if(!d&&null!=a["return"])a["return"]()}finally{if(m)throw q;}}a=n}if(!(c=a||O(c,b)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return c}function U(c,b){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(c);b&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(c,
a).enumerable}));a.push.apply(a,n)}return a}function D(c){for(var b=1;b<arguments.length;b++){var a=null!=arguments[b]?arguments[b]:{};b%2?U(Object(a),!0).forEach(function(b){t(c,b,a[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach(function(b){Object.defineProperty(c,b,Object.getOwnPropertyDescriptor(a,b))})}return c}function V(c,b){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="undefined"!==typeof Symbol&&
c[Symbol.iterator]||c["@@iterator"];if(!a){if(Array.isArray(c)||(a=C(c))||b&&c&&"number"===typeof c.length){a&&(c=a);var n=0;b=function(){};return{s:b,n:function(){return n>=c.length?{done:!0}:{done:!1,value:c[n++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var d=!0,m=!1,g;return{s:function(){a=a.call(c)},n:function(){var b=a.next();d=b.done;return b},e:function(a){m=
!0;g=a},f:function(){try{if(!d&&null!=a["return"])a["return"]()}finally{if(m)throw g;}}}}function C(c,b){if(c){if("string"===typeof c)return J(c,b);var a=Object.prototype.toString.call(c).slice(8,-1);"Object"===a&&c.constructor&&(a=c.constructor.name);if("Map"===a||"Set"===a)return Array.from(c);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return J(c,b)}}function J(c,b){if(null==b||b>c.length)b=c.length;for(var a=0,n=Array(b);a<b;a++)n[a]=c[a];return n}function P(){return new Promise(function(c,
b){window!==window.parent||window.mini?window!==window.parent?(r.log("resolveIframe"),c()):na()?(r.log("resolveNoIframe tracking ready"),c()):(r.log("_createTrackingEventListener tracking not ready"),r.log("resolveNoIframe tracking not ready"),A(c,!0)):W()?(r.log("bmw tracking ready"),c()):(A(c,!1),r.log("bmw tracking not ready"))})}function na(){var c,b,a,n,d,m,g=void 0!==window.dataLayer;return"function"!==typeof(null===(c=digital)||void 0===c?void 0:null===(b=c.tracking)||void 0===b?void 0:b.getInstance)?
!1:!(null===(a=digital)||void 0===a||null===(n=a.tracking)||void 0===n||null===(d=n.getInstance(null!==(m=window.dataLayer)&&void 0!==m?m:{}))||void 0===d||!d.lastConsentState)&&g}function W(){var c,b,a,n,d,m,g,q,e;return!(null===(c=digital)||void 0===c||null===(b=c.tracking)||void 0===b||null===(a=b.lib)||void 0===a||!a.initComponentTracking||null===(null===(n=digital)||void 0===n?void 0:null===(d=n.tracking)||void 0===d?void 0:null===(m=d.lib)||void 0===m?void 0:m.getCurrentPageIndex())||void 0===
(null===(g=digital)||void 0===g?void 0:null===(q=g.tracking)||void 0===q?void 0:null===(e=q.lib)||void 0===e?void 0:e.getCurrentPageIndex()))}function A(c,b){b&&na()||!b&&W()?c():setTimeout(function(){50>Aa&&(Aa++,A(c,b))},200)}function F(){guideBridge.on("validationComplete",function(c,b){b.prevText||b.newText.length&&b.newText.forEach(function(a){Ba.error({componentType:k.trackingComponent.componentType,formLeadType:k.formLeadType,formType:k.trackingType,formVariant:k.formVariant,formOrigin:"adobe form",
formName:k.subCategory1,errorAction:"internal click",errorCause:"A validation error occurred on: "+a.som,errorMessage:a.errorText,errorCode:"01_01_005_000005",errorOrigin:"aem",errorType:"user"})})})}function G(){p();new Fa;(new Ha).initProductTracking().then(function(){new Ia});r.log("Component:",k.trackingComponent);r.log("TrackState:",k)}function p(){var c,b,a;void 0===window.trackingWorker&&null!==(c=window.guidelib)&&void 0!==c&&null!==(b=c.bf)&&void 0!==b&&null!==(a=b.context)&&void 0!==a&&
a.tenant&&(window.trackingWorker=new Worker("/etc.clientlibs/business/forms/clientlibs/tracking/worker.v1340.js"),window.trackingWorker.postMessage({type:"setup",message:window.guidelib.bf.context.tenant}))}var e=function(){function c(){v(this,c)}l(c,null,[{key:"log",value:function(){for(var b=arguments.length,a=Array(b),c=0;c<b;c++)a[c]=arguments[c];if(this.isDebugEnabled()){var d;(d=console).info.apply(d,["\ud83c\udff7\ufe0f"].concat(a))}else if(this.isTraceEnabled()){var m;(m=console).trace.apply(m,
["\ud83c\udff7\ufe0f"].concat(a))}}},{key:"isDebugEnabled",value:function(){return!!window.location.pathname.match(/.+\.debug\..+/)}},{key:"isTraceEnabled",value:function(){return!!window.location.pathname.match(/.+\.trace\..+/)}}]);return c}();e.log("TRACKING DEBUG ENABLED! NO EVENTS WILL BE SENT TO ADOBE!!");var r=e,L=function(){function c(){v(this,c)}l(c,[{key:"createTrackComponent",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=b.componentID,c=b.componentName,
d=b.primaryCategory,m=b.subCategory1,g=b.componentType,q=b.componentVersion;b=b.touchpoint;a={componentID:void 0===a?"":a,componentName:void 0===c?"adobe form":c,primaryCategory:void 0===d?"nsc website":d,subCategory1:void 0===m?"forms":m,componentType:void 0===g?"native in-page":g,componentVersion:void 0===q?"":q,touchpoint:void 0===b?"web":b};r.log("tracking-commons -\x3e createTrackingComponent",a);return a}},{key:"createTrackEvent",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?
arguments[0]:{},a=b.eventName;a=void 0===a?"form":a;var c=b.eventAction;c=void 0===c?"internal click":c;var d=b.eventPoints;d=void 0===d?"":d;var m=b.type;m=void 0===m?"":m;var g=b.timeStamp;g=void 0===g?Math.round((new Date).getTime()/1E3).toString():g;var q=b.effect,e=b.cause,f=b.primaryCategory,k=b.subCategory1,l=b.subCategory2,h=b.requestedURL,u=b.linkedComponent,p=b.linkedPage,t=b.formComChannel,K=b.rfxID,ca=b.leadTime,da=b.rfiType,ea=b.rfiModelCodes,fa=b.brochureID,S=b.rfiPurchaseIntentPeriod,
ha=b.stepName,ja=b.stepAmount;b=b.formVariant;b={eventInfo:{eventName:a,eventAction:c,eventPoints:d,type:m,timeStamp:g,effect:void 0===q?"":q,cause:void 0===e?"default":e},category:{primaryCategory:void 0===f?"adobe form":f,subCategory1:void 0===k?"":k,subCategory2:void 0===l?"":l},attributes:{leadTime:void 0===ca?"":ca,requestedURL:void 0===h?window.location.href:h,linkedComponent:void 0===u?[]:u,linkedPage:void 0===p?{pageInfo:{pageID:""}}:p,form:{formComChannel:void 0===t?"":t,rfxID:void 0===K?
"":K,rfiType:void 0===da?"":da,rfiModelCodes:void 0===ea?"":ea,rfiPurchaseIntentPeriod:void 0===S?"":S,brochureID:void 0===fa?"":fa,stepName:void 0===ha?"":ha,stepAmount:void 0===ja?"step 1/1":ja,formVariant:void 0===b?"":b}}};b=this.attachPageObject(b);r.log("tracking-commons -\x3e createTrackEvent",b);return b}},{key:"createProduct",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=b.productID,c=b.productName,d=b.manufacturer,m=b.primaryCategory,g=b.category1,q=
b.category2,e=b.businessDivision,f=b.range,k=b.rangeVG,l=b.codeVG,h=b.codeAG,p=b.modelName,t=b.productionYear,v=b.series,K=b.bodyType,ca=b.fuelType,da=b.hybridVersion,ea=b.motorization,fa=b.color,S=b.yearOfRegistration,ha=b.gearing,ja=b.trimLevel,w=b.vehicleStatus,X=b.configID;b=b.configLink;a={productID:void 0===a?"":a,productName:void 0===c?"":c,manufacturer:void 0===d?"bmw":d,color:void 0===fa?"":fa,primaryCategory:void 0===m?"new car":m,category1:void 0===g?"":g,category2:void 0===q?"":q,businessDivision:void 0===
e?"vehicle":e,range:void 0===f?"":f,rangeVG:void 0===k?"":k,codeVG:void 0===l?"":l,codeAG:void 0===h?"":h,modelName:void 0===p?"":p,vehicleStatus:void 0===w?"":w,productionYear:void 0===t?"":t,yearOfRegistration:void 0===S?"":S,gearing:void 0===ha?"":ha,series:void 0===v?"":v,bodyType:void 0===K?"":K,fuelType:void 0===ca?"":ca,hybridVersion:void 0===da?"":da,motorization:void 0===ea?"":ea,trimLevel:void 0===ja?"":ja,configID:void 0===X?"":X,configLink:void 0===b?"":b};r.log("tracking-commons -\x3e createProduct",
a);return a}},{key:"createDlo",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=b.dealerGroupName,c=b.dealerGroupID,d=b.dealerOutletID,m=b.dealerOutletName,g=b.dealerOutletBuno,q=b.selectionState,e=b.linkedComponent;b=b.linkedPage;a={dealerInfo:{dealerGroupName:void 0===a?"":a,dealerGroupID:void 0===c?"":c,dealerOutletID:void 0===d?"":d,dealerOutletName:void 0===m?"":m,dealerOutletBuno:void 0===g?"":g},attributes:{selectionState:void 0===q?"":q,linkedComponent:void 0===
e?[]:e,linkedPage:void 0===b?{pageInfo:{pageID:""}}:b}};a=this.attachPageObject(a);r.log("tracking-commons -\x3e createDlo",a);return a}},{key:"TrackingAdapter",get:function(){var b=this;if(window===window.parent){var a=this.isMini()?window.digital.tracking.getInstance(window.dataLayer):window.digital.tracking.lib;a=Object.assign(a,{initDealerTracking:function(c,d,m){d="number"===typeof d?b.pageObjectBmwMini(d):b.pageObjectBmwMini(a.getCurrentPageIndex());if(c)if(d.dealer||(d.dealer=[]),m)d.dealer[m]=
c;else return d.dealer.push(c)}})}else a={getCurrentPageIndex:function(){return 0},getPageObject:function(){return 0},initProductTracking:function(a){window.require(["postal.aem-form"],function(b){setTimeout(function(){b.channel("af").publish({topic:"track.initProduct",data:oa({},a),headers:{preserve:!0}})},R())});return{pageId:0,productIndex:0}},updateProductTracking:function(a,b,c){window.require(["postal.aem-form"],function(n){setTimeout(function(){n.channel("af").publish({topic:"track.updateProduct",
data:{oldObj:a,newObj:b,pageid:c},headers:{preserve:!0}})},R())});return{pageId:0,productIndex:0}},addEventTracking:function(a,b,c){window.require(["postal.aem-form"],function(n){setTimeout(function(){n.channel("af").publish({topic:"track.event",data:{obj:a,data:b,pageIndex:c},headers:{preserve:!0}})},R())})},initComponentTracking:function(a){window.require(["postal.aem-form"],function(b){setTimeout(function(){b.channel("af").publish({topic:"track.component",data:oa({},a),headers:{preserve:!0}})},
R())})},initDealerTracking:function(a){window.require(["postal.aem-form"],function(b){setTimeout(function(){b.channel("af").publish({topic:"track.dealer",data:oa({},a),headers:{preserve:!0}})},R())})}};return a}},{key:"Satellite",get:function(){var b=this,a={};if(window._satellite&&window._satellite.track)return{track:function(a){if("string"===typeof a){var c=JSON.parse(JSON.stringify(b.pageObjectBmwMini()));window._satellite.track(a,{webDL:c})}}};if(r.isDebugEnabled())return{track:function(){var a;
console.info(JSON.parse(JSON.stringify(dataLayer)));(a=console).info.apply(a,arguments)}};if(window!==window.parent)return a.track=function(a){window.require(["postal.aem-form"],function(b){setTimeout(function(){b.channel("af").publish({topic:"track.satellite",data:{componentName:a},headers:{preserve:!0}})},R())})},a;r.log("tracking-commons -\x3e _satellite was not found");return{query:[],trackingAdapter:this.TrackingAdapter,trackingCommons:this,reTryTimer:void 0,reTryTimerStart:function(){var a=
this;this.reTryTimer=setInterval(function(){var b;null!==(b=window._satellite)&&void 0!==b&&b.track&&(a.query.forEach(function(a){"string"===typeof a.name&&window._satellite.track(a.name,{webDL:JSON.parse(JSON.stringify(a.webDL))})}),clearInterval(a.reTryTimer))},500)},track:function(a){var b,c=this.trackingCommons.pageObjectBmwMini(this.trackingAdapter.getCurrentPageIndex());null!==(b=window._satellite)&&void 0!==b&&b.track?"string"===typeof a&&window._satellite.track(a,{webDL:c}):(this.query.push({name:a,
webDL:c}),void 0===this.reTryTimer&&this.reTryTimerStart())}}}},{key:"pageObjectBmwMini",value:function(b){try{var a,c,d,m=null===(a=window.top.digital)||void 0===a?void 0:null===(c=a.tracking)||void 0===c?void 0:null===(d=c.getInstance(window.top.dataLayer))||void 0===d?void 0:d.pageTrackingArr;var g=m[null!==b&&void 0!==b?b:m.length-1]}catch(ma){g=void 0}try{var q;var e=window.dataLayer.pages[null!==(q=null!==b&&void 0!==b?b:this.TrackingAdapter.getCurrentPageIndex())&&void 0!==q?q:0]}catch(ma){e=
void 0}return g?g:e}},{key:"attachPageObject",value:function(b){try{var a,c,d,m=(null===(a=this.pageObjectBmwMini(0))||void 0===a?void 0:null===(c=a.page)||void 0===c?void 0:null===(d=c.pageInfo)||void 0===d?void 0:d.pageID)||"";m&&(b.attributes.linkedPage.pageInfo.pageID=m)}catch(g){console.log(g)}return b}},{key:"isMini",value:function(){return window!==window.parent||!!window.mini||!1}},{key:"getMetaInfo",value:function(b){var a;return null!==(a={trackingType:$("meta[name\x3d'trackingType']").attr("content")||
$("#trackingType").data("content"),trackingLastFormModification:$("meta[name\x3d'trackingLastFormModification']").attr("content")||$("#trackingLastFormModification").data("content"),productLayerPrimaryCategory:$("meta[name\x3d'productLayerPrimaryCategory']").attr("content")||$("#productLayerPrimaryCategory").data("content"),productLayerSubCategory1:$("meta[name\x3d'productLayerSubCategory1']").attr("content")||$("#productLayerSubCategory1").data("content"),productLayerManufacturer:$("meta[name\x3d'productLayerManufacturer']").attr("content")||
$("#productLayerManufacturer").data("content"),productLayerProductType:$("meta[name\x3d'productLayerProductType']").attr("content")||$("#productLayerProductType").data("content"),eventLayerSubCategory1:$("meta[name\x3d'eventLayerSubCategory1']").attr("content")||$("#eventLayerSubCategory1").data("content"),eventLayerSubCategory2:$("meta[name\x3d'eventLayerSubCategory2']").attr("content")||$("#eventLayerSubCategory2").data("content"),eventLayerFormVariant:$("meta[name\x3d'eventLayerFormVariant']").attr("content")||
$("#eventLayerFormVariant").data("content"),isNativeInPage:!!$(".aemformcontainer").length}[b])&&void 0!==a?a:void 0}},{key:"createLeadType",value:function(b){var a=window.location.href;return a.includes("configId")?b+" - configurator":a.includes("StockLocator")?b+" - stock locator":a.includes("modelRange")?b+" - showroom":a.includes("tl\x3d")?b+" - campaign":b+" - direct"}},{key:"saveDataForSuccessError",value:function(b,a){window.formsTrackingData.set(b,a)}},{key:"getDataForSuccessError",value:function(b){var a;
return null!==(a=window.formsTrackingData.get(b))&&void 0!==a?a:null}}]);return c}();void 0===window.formsTrackingData&&(window.formsTrackingData=new Map,window.formsTrackingData.getTrackingData=function(){var c={};try{return window.formsTrackingData.forEach(function(b,a){c[a]=btoa(b)},this),c}catch(b){return console.error("No Forms tracking found!!"),null}});var z=new Date;z.setSeconds(z.getSeconds()+5);var k=new (function(){function c(){var b,a,n,d,m;v(this,c);t(this,"selectedComChannel","");t(this,
"trackingComponent","");t(this,"trackingProduct",new Map);t(this,"trackingAccessory",new Map);t(this,"brochureType","");t(this,"rfiModelCodes","");t(this,"brochureID","");t(this,"rfiPurchaseIntentPeriod","");t(this,"requestCount",0);t(this,"singleProduct",!0);t(this,"multipleProductsPanel",null);t(this,"isPrefilled",!1);t(this,"productTemp",{});t(this,"productState",{});t(this,"tempProductBrochures",new Map);t(this,"multipleRequestTypes",new Map);t(this,"trackingType",void 0);t(this,"subCategory1",
void 0);t(this,"subCategory2",void 0);t(this,"formVariant",void 0);t(this,"formLeadType",void 0);t(this,"primaryCategory",void 0);var g=new L;this.trackingType=null!==(b=g.getMetaInfo("trackingType"))&&void 0!==b?b:"not configured";this.subCategory1=null!==(a=g.getMetaInfo("eventLayerSubCategory1"))&&void 0!==a?a:"not configured";this.subCategory2=null!==(n=g.getMetaInfo("eventLayerSubCategory2"))&&void 0!==n?n:"not configured";this.formVariant=null!==(d=g.getMetaInfo("eventLayerFormVariant"))&&void 0!==
d?d:"not configured";this.primaryCategory=null!==(m=g.getMetaInfo("productLayerPrimaryCategory"))&&void 0!==m?m:"not configured";this.formLeadType=g.createLeadType(this.subCategory2);["configId","modelCode","modelRange"].find(function(a){return-1!==window.location.hash.indexOf(a)})&&(this.isPrefilled=!0)}l(c,[{key:"trackingComponent",get:function(){return this.trackingComponent},set:function(b){this.trackingComponent=b}},{key:"selectedComChannel",get:function(){return this.selectedComChannel},set:function(b){this.selectedComChannel=
b}}]);return c}()),Fa=l(function b(){v(this,b);var a=new L;r.log("tracking-components -\x3e initComponentTracking()");var c=a.getMetaInfo("isNativeInPage")?"native in-page":"standalone";if(a.getMetaInfo("trackingLastFormModification")){var d=a.getMetaInfo("trackingLastFormModification").toUpperCase().replace(" ","T").replace(" ","Z");d=(new Date(d)).toISOString()}else d=(new Date((new Date).toString().split("GMT")[0]+" UTC")).toISOString();c=a.createTrackComponent({componentType:c,componentID:guideBridge.getGuideContext().data.guidePath||
"",componentVersion:"last build:"+d});k.trackingComponent=c;a.saveDataForSuccessError("formTrackingComponent",JSON.stringify({trackingComponent:k.trackingComponent}))});window.TRON=window.TRON||{};TRON.isInitialized||function(){var b=console.error,a=console.info,c=console.warn;console.error=function(){"Object"==typeof arguments[0]&&(arguments[0]=arguments[0].toString());if(-1<arguments[0].indexOf("Incorrect TRON implementation: \u26d4")){var a=arguments[0].split("Incorrect TRON implementation: \u26d4")[1],
c=Object.entries({E001:"parameter is missing",E002:"value is incorrect",E003:"value is empty",E004:"does not exist"}).find(function(b){b=$jscomp.makeIterator(b);b.next();b=b.next().value;return a.includes(b)})[0];window.adobeDataLayer=window.adobeDataLayer||[];var d=TRON.dataComponent,n={"con \x3e":"configurator","stock \x3e":"stock locator","sales \x3e":"sales","fin \x3e":"finance","rent \x3e":"rental"};n="undefined"!=typeof n[TRON.prefix]?n[TRON.prefix]:d[0].category.primaryCategory;if(""==n||"shared \x3e "==
TRON.prefix||"local \x3e "==TRON.prefix)if([".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"].some(function(a){return window.location.href.includes(a)}))if([".bmw.com"].some(function(a){return window.location.href.includes(a)})){var e=window.location.pathname.split("/");"undefined"!=typeof e[1]&&(n=-1<e[1].indexOf("-")?"nsc website":"special website","nsc website"==n&&(TRON.prefix="nsc \x3e "))}else n="special website",TRON.prefix="special \x3e ";else n="special website",TRON.prefix=
"special \x3e ";d[0].category.primaryCategory=n;n=d[0].componentInfo.componentID;e={};e[n]=d[0];window.adobeDataLayer.push({component:e,version:TRON.version});window.adobeDataLayer.push({event:"tron event",eventInfo:{cause:"TRON implementation \x3e "+((TRON||"").currentEventName||""),effect:TRON.prefix+a,eventAction:"trigger tron function",eventName:"error",eventPoints:0,timeStamp:(new Date).getTime(),type:"frontend component",category:{primaryCategory:(TRON||"").componentName||"",subCategory1:c,
subCategory2:"TRON library"},reference:{linkedComponent:n}}})}(-1!=document.location.search.indexOf("trondebug\x3dtrue")||null!=sessionStorage.getItem("tronDebug")&&"true"===sessionStorage.getItem("tronDebug"))&&b.apply(this,arguments)};console.info=function(){(-1!=document.location.search.indexOf("trondebug\x3dtrue")||null!=sessionStorage.getItem("tronDebug")&&"true"===sessionStorage.getItem("tronDebug"))&&a.apply(this,arguments)};console.warn=function(){(-1!=document.location.search.indexOf("trondebug\x3dtrue")||
null!=sessionStorage.getItem("tronDebug")&&"true"===sessionStorage.getItem("tronDebug"))&&c.apply(this,arguments)}}();var d={customeEventName:"TRON: forms",libraryName:"forms",libraryVersion:"_v6.2.11",prefix:"",pageExist:!0,vehicle:{productType:"",primaryCategory:"",subCategory1:""},options:{productType:"",primaryCategory:""}};e=function(){this.detectDebugMode();this._TronVersion="4.0.1";var b={library:function(a){a.genericEventName="TRON: adobeDataLayer generic event listener";a.customEventName=
d.customeEventName;a._componentTrackingVersion=d.libraryName+""+d.libraryVersion;a.version="TRON_"+a._TronVersion+"__"+a._componentTrackingVersion},defaults:function(a){a.component={category:{componentType:"",primaryCategory:"",subCategory1:"forms"},componentInfo:{componentName:"forms",componentID:"forms"},attributes:{touchpoint:"web"}};a.baseEvent={eventInfo:{cause:"default",effect:"na",eventAction:"internal click",eventName:"form",eventPoints:0,type:"na"},category:{subCategory1:"",subCategory2:""},
attributes:{requestedURL:""}};a.page={category:{primaryCategory:"",subCategory1:"",subCategory2:"",subCategory3:"",pageType:"tbd"},pageInfo:{pageID:"",pageName:"tbd",author:"",destinationURL:"",referringURL:"",sysEnv:"",variant:"tbd",version:"",language:"",geoRegion:""},attributes:{brand:"",timeZone:""}};a.baseCustom={};a.errorMandatoryData=["formOrigin","formType"];a.baseMandatoryData=["componentType","formLeadType","formOrigin","formType","formVariant"];a.baseOptionalData="componentDEVagency componentPlatform componentVersion formComChannel formID formName dealer[n].outletBuno dealer[n].groupID dealer[n].groupName dealer[n].location dealer[n].outletID dealer[n].outletName dealer[n].selectionState options[n].businessDivision options[n].category1 options[n].category2 options[n].manufacturer options[n].name options[n].primaryCategory options[n].productID vehicle[n].bodyType vehicle[n].businessDivision vehicle[n].manufacturer vehicle[n].name vehicle[n].primaryCategory vehicle[n].productID vehicle[n].range vehicle[n].rangeVG vehicle[n].series vehicle[n].category1 vehicle[n].category2 vehicle[n].codeAG vehicle[n].codeVG vehicle[n].color vehicle[n].engine vehicle[n].fuelType vehicle[n].gearing vehicle[n].hybridVersion vehicle[n].status vehicle[n].subSeries vehicle[n].encVIN iframeURL requestedURL userProfileID userLoginStatus".split(" ");
a.allowedComponentTypes=["native in-page","in-page iframe","standalone iframe","standalone"];a.allowedComponentPlatform=["aem \x3e central","aem \x3e local","non-aem \x3e central","non-aem \x3e local"];a.allowedUserLoginStatus=["logged in","not logged in"];a.allowedFormTypes="campaign;online tda;registration;rfa;rfc;rfd;rfi;rfo;rfs;roi;tda;fs rfo;rfp;rft;sws;vco;evt".split(";");a.allowedFormOrigins=["local form","adobe form","custom central form","custom local form"];a.allowedFormVariants=["dedicated form",
"combo form"];a.allowedFormLeadTypes="lead;handraiser;generic;configurator;visualizer;stock locator;showroom;direct;campaign".split(";");a.allowedFormComChannel="email;text;phone;post;in-app;in-car;no consent given".split(";");a.allowedFormMappedVehiclesCount=["value should be numeric"];var b="undefined"!=typeof a?a:this;b.allowedVehicleBodyType="ca hb ko co cp li mp ro sc st gf hc sh to gs ga x xr gt gl r rs rr rt 9p 9s 9u b s 9t".split(" ");b.allowedVehicleBusinessDivision=["new vehicle","used vehicle",
"after sales","other"];b.allowedVehicleCategory1="build to order;pre-order;build to stock;young used car;demonstration car;young used bike;demonstration bike".split(";");b.allowedVehicleFuelType="bodeghmtxyz".split("");b.allowedVehicleHybridVersion=["beve","erex","hybr","phev","nohy"];b.allowedVehiclePrimaryCategory="new car;used car;used bike;new bike;rental bike;rental car;owned bike;owned car".split(";");b.allowedVehicleSeries="1 2 3 4 5 6 7 8 x i m z clubman 5-doors 3-doors cabrio countryman ad gs he lt ms na sp".split(" ");
b.allowedVehicleStatus="available for sale;sold out;order confirmed;pre-order confirmed;contract concluded;vehicle delivered".split(";");b.allowedVehiclecodeAG=["value should contain only 4 characters"];b.allowedVehiclecodeVG=["value should contain only 4 characters"];b.allowedVehicleItemBasePrice=["value should be numeric"];b.allowedVehicleItemDiscountAmount=["value should be numeric"];b.allowedVehicleItemDiscountPercent=["value should be numeric"];b.allowedVehicleItemPriceWithTax=["value should be numeric"];
b.allowedVehicleItemQuantity=["value should be numeric"];b.allowedVehicleItemShippingCost=["value should be numeric"];b.allowedVehicleItemTaxAmount=["value should be numeric"];b.allowedVehicleItemTaxRate=["value should be numeric"];b.allowedTotalBasePrice=["value should be numeric"];b.allowedTotalDiscountAmount=["value should be numeric"];b.allowedTotalDiscountPercent=["value should be numeric"];b.allowedTotalFinalPrice=["value should be numeric"];b.allowedTotalPriceWithTax=["value should be numeric"];
b.allowedTotalShippingCost=["value should be numeric"];b.allowedTotalTaxAmount=["value should be numeric"];a.allowedOptionsBusinessDivision=["new vehicle","used vehicle","after sales","other"];a.allowedOptionsCategory1="accessories;car hood graphics;charging;colors;engine;interior trims;interior worlds;lines / trims;options;packages;roof and mirror caps;upholstery;wheels;winter wheels;standard equipment;loan;lease".split(";");a.allowedOptionscodeVG=["value should contain only 4 characters"];a.allowedOptionsItemBasePrice=
["value should be numeric"];a.allowedOptionsItemDiscountAmount=["value should be numeric"];a.allowedOptionsItemDiscountPercent=["value should be numeric"];a.allowedOptionsItemPriceWithTax=["value should be numeric"];a.allowedOptionsItemQuantity=["value should be numeric"];a.allowedOptionsItemShippingCost=["value should be numeric"];a.allowedOptionsItemTaxAmount=["value should be numeric"];a.allowedOptionsItemTaxRate=["value should be numeric"];a.allowedOptionsFinDownPayment=["value should be numeric"];
a.allowedOptionsFinMileage=["value should be numeric"];a.allowedOptionsFinMonthlyPayment=["value should be numeric"];a.allowedOptionsFinTerm=["value should be numeric"];a.allowedTotalBasePrice=["value should be numeric"];a.allowedTotalDiscountAmount=["value should be numeric"];a.allowedTotalDiscountPercent=["value should be numeric"];a.allowedTotalFinalPrice=["value should be numeric"];a.allowedTotalPriceWithTax=["value should be numeric"];a.allowedTotalShippingCost=["value should be numeric"];a.allowedTotalTaxAmount=
["value should be numeric"];a.allowedPageBrand="bmw;mini;motorrad;bmw group;alphera;rolls-royce;alphabet".split(";");a.allowedPageVariant=["real page","virtual page"];a.allowedUserLoginStatus=["logged in","not logged in"];a.allowedDealerSelectionState=["not selected","user selected","preselected","user selected (piloted)","user selected (non-piloted)"]},events:function(a){a.events||(a.events={});a.events=Object.assign(a.events,{formPageLoad:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),
{effect:"page: standalone form shown ",eventName:"page view",cause:"automatic",eventAction:"page load"})},page:{pageInfo:Object.assign({},JSON.parse(JSON.stringify(a.page.pageInfo)),{pageName:"standalone form"}),category:Object.assign({},JSON.parse(JSON.stringify(a.page.category)),{pageType:"form"})},mandatoryData:a.baseMandatoryData.concat(["pageBrand","pageGeoRegion","pageLanguage","pageSysEnv"]).filter(function(a){return!["formLeadType"].includes(a)}),optionalData:a.baseOptionalData.concat(["pageVersion"]),
description:"Don't trigger this event if the form is integrated on a website of the AEM or any website that already has Adobe Analytics page view tracking included. Only trigger this event if the form is on a standalone page that doesn't have page view tracking implemented yet.\n            \x3cbr\x3e Please provide the page name dynamically."}});a.events=Object.assign(a.events,{formStarted:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"form started",
eventAction:"first page load",cause:"automatic"})},mandatoryData:a.baseMandatoryData.concat([]),optionalData:a.baseOptionalData.concat([]),description:"Form started should be triggered once on first page load on the page where the user enters the form funnel for the specific type. A form is considered started once it is visible to the customer. In multi-step forms it's irrelevant one which step the users starts the journey - eg. on step 1 model selection, or step 2 personal information if the user is coming from eg. con with pre-selected model. A page or page element is considered part of a form if the customer selects or inputs information that is later sent to the backend system, e.g. personal data, series/model information, etc. Local forms in iframes trigger the form start when the iframe content is loaded."},
formFirstInteraction:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"form first interaction"})},mandatoryData:a.baseMandatoryData.concat([]),optionalData:a.baseOptionalData.concat(["eventAction"]),description:"First form interaction should be triggered once of the first interaction with the form. As interaction counts e.g. a model selection from the drop-down, a filling of a free text field, a radio button selection etc. Page load or impression are NOT considered first interaction. The click on the form start intention CTA button before the form, is also NOT considered as first interaction. Furthermore any prefilled content is not considered an interaction. We only consider interaction if the user actively does anything with form. Especially for forms embedded on the showroom, it's recommended to trigger the first interaction"},
formInteraction:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"form interaction"})},mandatoryData:a.baseMandatoryData.concat(["eventEffect"]),optionalData:a.baseOptionalData.concat(["eventAction","requestedURL"]),description:'Form interaction may be triggered for any interaction inside the for funnel eg. user clicked login button.\n        \x3cbr\x3e If the form finish is happening on an external site - eg. a dealer website - and hence may not be tracked, the last click inside the tracked form funnel should be tracked with this function and the URL of the landing page of the button should be provided the parameter "requestedURL". Furthermore in such cases you must use the form name "routing to external form (finish not trackable\')". '},
formStep:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"form step"})},mandatoryData:a.baseMandatoryData.concat([]),optionalData:a.baseOptionalData.concat("step stepAmounts stepName formStep formStepAmounts formStepName".split(" ")),description:"Form step should be triggered every time the user lands on a form step. Make sure to provide the current step number as well as the total amounts of step - not counting the thank you page as step. Everytime the user jumps back or forth the form step may be triggered to understand how the user moves through the form funnel.\n        \x3cbr\x3e \x3cb\x3eAccording to 2023 guidelines review 3 parameters were renamed. For now both - old and new values work -  hence classified as minor not major change, but going forward new parameter names should be used:\n        \x3cbr\x3e old parameter names: formStep, formStepName, formStepAmounts\n        \x3cbr\x3e new parameter names: step, stepName, stepAmounts"},
formFinishIntention:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"form finish intention"})},mandatoryData:a.baseMandatoryData.concat([]),optionalData:a.baseOptionalData.concat([]),description:'Form finish intention may be triggered upon CTA button "submit" the form. Independent if the submission is successful or not.'},formFinished:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"form finished",eventAction:"page load",
cause:"automatic"})},mandatoryData:a.baseMandatoryData.concat([]),optionalData:a.baseOptionalData.concat([]),description:"Form finished should be triggered once on the page load on the thank you page after a successful response was received from the CRM system. A form is considered finished once it has been sent to the backend system successfully. In case there is no feedback from the backend system form finish triggers on successful form submit without error message. Local forms in iframes usually trigger form finish when showing a \u201cthank you\u201d message to the visitor."},
loginButtonClick:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"login button clicked"})},mandatoryData:a.baseMandatoryData.concat([]),optionalData:a.baseOptionalData.concat([]),description:"Trigger this interaction event whenever the user clicks on the login button \n        \x3cbr\x3e \u26a0\ufe0fThis event will be replaced by formInteraction event."},loginReturn:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"user returned from login page",
cause:"automatic"})},mandatoryData:a.baseMandatoryData.concat([]),optionalData:a.baseOptionalData.concat([]),description:"Trigger this interaction event whenever the user clicks on the login button\n        \x3cbr\x3e \u26a0\ufe0fThis event will be replaced by formInteraction event."}})},globalDefaults:function(a){a.defaultDatalayer={component:[{category:{},componentInfo:{},attributes:{}}],event:[{category:{},eventInfo:{},attributes:{form:{},search:[],media:{},survey:{}}}],custom:{},page:{category:{},
pageInfo:{},attributes:{}},product:[{category:{},productInfo:{},attributes:{}}],cart:{item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}],price:{}},transaction:{total:{attributes:{}},item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}]},user:[{segment:{},profile:[{profileInfo:{},attributes:{}}]}],dealer:[{dealerInfo:{},attributes:{}}],version:a.version};a.events||(a.events={});a.events.error={event:{eventInfo:{eventName:"error",type:"",eventAction:"internal click",
eventPoints:"0",cause:"default",effect:"na"}},custom:{errorCode:"",errorOrigin:"",errorURL:document.location.href},mandatoryData:a.errorMandatoryData.concat("errorAction errorMessage errorCause errorType errorCode errorOrigin".split(" ")),optionalData:a.baseMandatoryData.concat(["errorURL"]).filter(function(b){return!a.errorMandatoryData.includes(b)}),description:'Trigger this event whenever an error occurs that prevents the user from continuing with its journey. \n                \x3cbr\x3e All parameters that are mandatory for every other function, are optional for error events by the code (refer to parameters listed on the right). However, please provide as much information as possible eg. vehicle, options, dealer, etc. whenever it\'s available to you at the moment the error occured.\n                \x3cbr\x3ePlease consult the \x3ca href\x3d"https://atc.bmwgroup.net/confluence/x/1FsYrw" target\x3d"_blank"\x3eAdobe Analytics 2023 - Error Tracking confluence page\x3c/a\x3e for further details.'};
a.events=Object.assign(a.events,{activityMapClick:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(a.baseEvent.eventInfo)),{effect:"user clicked on an on page navigation element"})},mandatoryData:[],optionalData:["componentVersion"],description:'Trigger this event whenever the user clicks on a navigation item that does not navigate the user to a new page and hence triggers a server call.\n      \x3cbr\x3e This is used for pure non-contextual (without vehicle, dealer, form etc context) click tracking.\n      \x3cbr\x3ePlease consult the \x3ca href\x3d"https://atc.bmwgroup.net/confluence/x/TvwHrQ" target\x3d"_blank"\x3eAdobe Analytics 2023 - Activity Map confluence page\x3c/a\x3e for further details.'}});
a._validErrorTypes=["backend 1st party","backend 3rd party","frontend component","user"];a._validErrorActions=a._validEventActions="call;checkbox;component load;content closed;content opened;content visible;download;drop-down menu;first page load;form fill;internal click;outbound click;page load;radio button;rotate;item added;item removed;slide left;slide right;sort;suggested term;media played;media paused;media milestone reached;media stopped".split(";");a._validEventCauses=["automatic"];a.defaultValue=
""}};b.library(this);b.defaults(this);b.globalDefaults(this);b.events(this);this._createPublicMethods();this.message={}};e.prototype.getSupportedEvents=function(){var b={},a;for(a in this.events){var c=JSON.parse(JSON.stringify(this.events[a].mandatoryData)),d=JSON.parse(JSON.stringify(this.events[a].optionalData)),m=Object.keys(this).map(function(a){return a.toLowerCase()});c=[c.sort(),d.sort()];for(var g in c)for(var e in c[g]){var f=c[g][e];f=-1<f.indexOf("[n].")?f.replace("[n].",""):f;d=m.filter(function(a){return a.includes(f.toLowerCase())});
("string"==typeof f&&1==d.length||"string"==typeof f&&1<d.length&&d[0].includes(f))&&Array.isArray(this[Object.keys(this)[m.indexOf(d[0])]])&&(d=this[Object.keys(this)[m.indexOf(d[0])]],d=d.filter(function(a){return""!==a}),d="Possible Options: "+d.join(", ").toString(),c[g][e]='\x3cspan style\x3d"color: #1000ff;font-weight: bold;" title\x3d"'+d+'"\x3e'+c[g][e]+"\x3c/span\x3e")}b[a]={description:this.events[a].description,"mandatory parameters":c[0].join(", \x3cbr\x3e").toString(),"optional parameters":c[1].join(", \x3cbr\x3e").toString()}}return b};
e.prototype.setDebug=function(b){if("boolean"!=typeof b)return!1;sessionStorage.setItem("tronDebug",b);this.debug=b};e.prototype.detectDebugMode=function(){var b;null!=sessionStorage.getItem("tronDebug")&&(b="true"===sessionStorage.getItem("tronDebug"));-1!=document.location.search.indexOf("trondebug")&&(b=-1!=document.location.search.indexOf("trondebug\x3dtrue")?!0:!1,sessionStorage.setItem("tronDebug",b));this.setDebug(b)};e.prototype._createPublicMethods=function(b){for(var a in this.events)this[a]=
function(a){return function(b){this._processEvent(""+a,b)}}(a)};e.prototype.flattenObject=function(b){var a={},c;for(c in b)if(b.hasOwnProperty(c))if("object"==typeof b[c]&&null!==b[c]){var d=this.flattenObject(b[c]),m;for(m in d)d.hasOwnProperty(m)&&(a[c+"."+m]=d[m])}else a[c]=b[c];return a};e.prototype._checkParamsPassed=function(b,a){a=this.flattenObject(a);a=Object.keys(a);a=a.map(function(a){return a.replace(/(.)(\d+)(.)/,"[n].")});b=[];for(var c in this.events)b.push.apply(b,this.events[c].mandatoryData),
b.push.apply(b,this.events[c].optionalData);b=b.filter(function(a,b,c){return c.indexOf(a)===b});for(c in a)0>b.indexOf(a[c])&&console.warn("Incorrect TRON implementation: \u26a0\ufe0f Parameter "+a[c]+" not defined in the library, hence this data cannot be tracked")};e.prototype._processEvent=function(b,a){function n(a){var b="codeAG codeVG rangeAG rangeVG name productID range modelCode modelCodeAG mmdr mmdrVG".split(" ");if(a&&void 0!=a.vehicle)for(var c=0;c<=a.vehicle.length;c++)for(var d in a.vehicle[c])0>
b.indexOf(d)&&(a.vehicle[c][d]="string"==typeof a.vehicle[c][d]?a.vehicle[c][d].toLowerCase():a.vehicle[c][d])}function e(a,b){0>["codeAG","codeVG","rangeAG","rangeVG"].indexOf(a)&&(b="String"==typeof b?(b||"").toLowerCase():b);var c={bodyType:{values:u.allowedVehicleBodyType},businessDivision:{values:u.allowedVehicleBusinessDivision},category1:{values:u.allowedVehicleCategory1},codeAG:{condition:"only 4 characters"},codeVG:{condition:"only 4 characters"},fuelType:{values:u.allowedVehicleFuelType},
hybridVersion:{values:u.allowedVehicleHybridVersion},primaryCategory:{values:u.allowedVehiclePrimaryCategory},series:{values:u.allowedVehicleSeries}},d;if(c[a]){var n=c[a];n.condition?"only 4 characters"==n.condition?d=4==b.length?!0:!1:"only 3 characters"==n.condition?d=3==b.length?!0:!1:"only 3 characters OR 4 if the last is 'E'"==n.condition&&(d=4==b.length&&"E"==b[b.length-1]?!0:3==b.length?!0:!1):d=-1<c[a].values.indexOf(b)?!0:!1}else d=!0;return d}function m(a,b,c,d){a=[];for(var n,g=Object.keys(d).map(function(a){return a.toLowerCase()}),
m={},h=0;h<c.length;m={$jscomp$loop$prop$expectedKey$6:m.$jscomp$loop$prop$expectedKey$6},h++)if(m.$jscomp$loop$prop$expectedKey$6=c[h],-1<m.$jscomp$loop$prop$expectedKey$6.indexOf("[n]")){var f=m.$jscomp$loop$prop$expectedKey$6.split("[n]");if("vehicle"==f[0]){var k=void 0;"undefined"!=typeof b[m.$jscomp$loop$prop$expectedKey$6.split("[n]")[0]]?(n=b[m.$jscomp$loop$prop$expectedKey$6.split("[n]")[0]][0][m.$jscomp$loop$prop$expectedKey$6.split("[n]")[1].replace(".","")],k=e(f[1].replace(".",""),n)):
k=!1;f=g.filter(function(a){return function(b){return b.includes("vehicle"+a.$jscomp$loop$prop$expectedKey$6.split("[n]")[1].replace(".","").toLowerCase())}}(m));f=0<f.length?f[0]:"";f=d[Object.keys(d)[g.indexOf(f||"")]]||[];0==k&&(a.push(m.$jscomp$loop$prop$expectedKey$6),console.error("Incorrect TRON implementation: \u26d4 "+m.$jscomp$loop$prop$expectedKey$6+" value is incorrect, hence this event cannot be tracked. Pick a standard value: "+f));"undefined"==typeof n&&console.error("Incorrect TRON implementation:  \u26d4 mandatory parameter is missing, hence this event cannot be tracked. Please provide the parameter: "+
m.$jscomp$loop$prop$expectedKey$6);"string"==typeof n&&0==n.trim().length&&console.error("Incorrect TRON implementation: \u26d4 "+m.$jscomp$loop$prop$expectedKey$6+" value is empty, hence this event cannot be tracked. Please provide a valid value: "+f)}}if(0<a.length)throw"value does not match expected values: "+a;return!0}function g(a,b,c,d){a=[];for(var n=Object.keys(d).map(function(a){return a.toLowerCase()}),g={},m=0;m<c.length;g={$jscomp$loop$prop$expectedKey$8:g.$jscomp$loop$prop$expectedKey$8},
m++){g.$jscomp$loop$prop$expectedKey$8=c[m];var h=void 0;if(-1<g.$jscomp$loop$prop$expectedKey$8.indexOf("[n]")){var f=g.$jscomp$loop$prop$expectedKey$8.split("[n]");if("vehicle"==g.$jscomp$loop$prop$expectedKey$8.split("[n]")[0]&&b.vehicle&&0<b.vehicle.length)for(var k=0;k<=b.vehicle.length-1;k++)(h=b[g.$jscomp$loop$prop$expectedKey$8.split("[n]")[0]][k][g.$jscomp$loop$prop$expectedKey$8.split("[n]")[1].replace(".","")])&&""!=h&&0==e(f[1].replace(".",""),h)&&(h=n.filter(function(a){return function(b){return b.includes("vehicle"+
a.$jscomp$loop$prop$expectedKey$8.split("[n]")[1].replace(".","").toLowerCase())}}(g)),h=0<h.length?h[0]:"",h=d[Object.keys(d)[n.indexOf(h)]]||[],b[g.$jscomp$loop$prop$expectedKey$8.split("[n]")[0]][k][g.$jscomp$loop$prop$expectedKey$8.split("[n]")[1].replace(".","")]="",a.push(g.$jscomp$loop$prop$expectedKey$8),console.warn("Incorrect TRON implementation: \u26a0\ufe0f "+g.$jscomp$loop$prop$expectedKey$8+" value is incorrect and won't be passed to the web tracking tool. Pick a standard value: "+h))}}return!0}
function q(a){return"number"===typeof a?a:/^\d{1,3}(,\d{3})*(\.\d+)?$/.test(a)?Number(a.replace(/,/g,"")):null}var f=this;"undefined"==typeof a&&(a={});TRON.currentEventName=b;TRON.prefix=d.prefix;TRON.componentName=d.libraryName;TRON.version=this.version;TRON.dataComponent=[{category:{componentType:this.component.category.componentType||"",primaryCategory:this.component.category.primaryCategory||"",subCategory1:this.component.category.subCategory1||""},componentInfo:{componentName:TRON.componentName,
componentID:(c("page.attributes.brand")||(-1<window.location.hostname.indexOf("bmw")?"bmw":-1<window.location.hostname.indexOf("mini")?"mini":-1<window.location.hostname.indexOf("bmw-motorrad")?"bmw-motorrad":""))+"/"+(1<window.location.href.split("country\x3d").length?window.location.href.split("country\x3d")[1].split("\x26")[0]:1<window.location.href.split("country\x3d").length?window.location.href.split("country_origin\x3d")[1].split("\x26")[0]:c("page.pageInfo.geoRegion")||(-1<c("page.pageInfo.language").indexOf("-")?
c("page.pageInfo.language").split("-")[1]:-1<window.location.host.indexOf("bmwusa")?"US":""))+"_"+(c("page.pageInfo.language").slice(0,2)||(-1<c("page.pageInfo.language").indexOf("-")?c("page.pageInfo.language").split("-")[0]:-1<window.location.host.indexOf("bmwusa")?"en":""))+"/"+TRON.componentName},attributes:{touchpoint:this.component.attributes.touchpoint||""}}];var k=JSON.parse(JSON.stringify(a));this._debug("\ud83d\udca1 event triggered:"+b,k);this._checkParamsPassed(b,k);this.message=this._loadEventData(b,
a);try{this._checkmandatoryData(b,a),this.events[b].optionalData&&this._checkOptionalData(b,a)}catch(K){return this._throwError("wrong mandatoryData input for function "+b,K),!1}k=d.prefix;"adobe form"==a.formOrigin?(this.message.component[0].category.primaryCategory="nsc website",k="nsc \x3e "):"local form"==a.formOrigin?(this.message.component[0].category.primaryCategory="locally developed",k="local \x3e "):k="not available \x3e ";if(a&&a.componentType&&!this.allowedComponentTypes.includes(a.componentType)){if(-1<
this.events[b].mandatoryData.indexOf("componentType")){console.error("Incorrect TRON implementation: \u26d4 componentType value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentTypes.join(", ").toString());this._throwError("componentType value is incorrect. Pick a standard value : "+this.allowedComponentTypes.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f componentType value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+
this.allowedComponentTypes.join(", ").toString());a.componentType=""}if(a&&a.componentName&&!this.allowedComponentNames.includes(a.componentName)){if(-1<this.events[b].mandatoryData.indexOf("componentName")){console.error("Incorrect TRON implementation: \u26d4 componentName value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentNames.join(", ").toString());this._throwError("componentName value is incorrect. Pick a standard value : "+
this.allowedComponentNames.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f componentName value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentNames.join(", ").toString());a.componentName=""}if(a&&a.componentSubCat1&&!this.allowedComponentSubCat1.includes(a.componentSubCat1)){if(-1<this.events[b].mandatoryData.indexOf("componentSubCat1")){console.error("Incorrect TRON implementation: \u26d4 componentSubCat1 value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+
this.allowedComponentSubCat1.join(", ").toString());this._throwError("componentSubCat1 value is incorrect. Pick a standard value : "+this.allowedComponentSubCat1.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f componentSubCat1 value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentSubCat1.join(", ").toString());a.componentSubCat1=
""}if(a&&a.componentPlatform&&!this.allowedComponentPlatform.includes(a.componentPlatform)){if(-1<this.events[b].mandatoryData.indexOf("componentPlatform")){console.error("Incorrect TRON implementation: \u26d4 componentPlatform value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentPlatform.join(", ").toString());this._throwError("componentPlatform value is incorrect. Pick a standard value : "+this.allowedComponentPlatform.reduce(function(a,
b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f componentPlatform value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentPlatform.join(", ").toString());a.componentPlatform=""}"undefined"!=typeof a&&(a.componentVersion&&(this.message.component[0].attributes.componentVersion=a.componentVersion),this.message.component[0].category.componentType=
a.componentType||this.component.category.componentType,this.message.component[0].category.subCategory1=a.componentSubCat1||this.component.category.subCategory1,this.message.component[0].componentInfo.componentName=a.componentName||((this.component||"").componentInfo||"").componentName||"",delete this.message.custom.componentVersion);"undefined"!=typeof a.componentDEVagency&&(this.message.component[0].attributes.componentDEVagency=a.componentDEVagency);"undefined"!=typeof a.componentPlatform&&(this.message.component[0].attributes.platform=
a.componentPlatform);var l={"con \x3e":"configurator","stock \x3e":"stock locator","sales \x3e":"sales","fin \x3e":"finance","rent \x3e":"rental"};l="undefined"!=typeof l[k]?l[k]:this.message.component[0].category.primaryCategory;if(""==l||"shared \x3e "==k||"local \x3e "==k)if([".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"].some(function(a){return window.location.href.includes(a)}))if([".bmw.com"].some(function(a){return window.location.href.includes(a)})){var p=window.location.pathname.split("/");
"undefined"!=typeof p[1]&&(l=-1<p[1].indexOf("-")?"nsc website":"special website","nsc website"==l&&(k="nsc \x3e "))}else l="special website",k="special \x3e ";else l="special website",k="special \x3e ";this.message.component[0].category.primaryCategory=l;"undefined"!=typeof a&&(this.message.component[0].componentInfo.componentName=a.formOrigin||((this.component||"").componentInfo||"").componentName||"");"undefined"!=typeof this.message.custom&&"interaction"==this.message.event[0].eventInfo.eventName&&
(this.message.user[0].profile[0].attributes.loggedInStatus=a.userLoginStatus,this.message.event[0].category.subCategory1=a.userLoginStatus,this.message.event[0].category.primaryCategory=a.formOrigin);"undefined"!=typeof this.message.custom&&"page view"==this.message.event[0].eventInfo.eventName&&(this.message.page.pageInfo.pageName="standalone "+a.formType+" form",this.message.event[0].eventInfo.effect="page: standalone "+a.formType+" form shown",this.message.page.category.subCategory1=a.formVariant,
this.message.page.category.primaryCategory=a.formOrigin);"undefined"!=typeof a.formStep&&(a.step=a.formStep);"undefined"!=typeof a.formStepName&&(a.stepName=a.formStepName);"undefined"!=typeof a.formStepAmounts&&(a.stepAmounts=a.formStepAmounts);if(a&&a.formType){l=a.formType;if(!this.allowedFormTypes.includes(l)){this._throwError("formType value is incorrect. Pick a standard value: "+this.allowedFormTypes.reduce(function(a,b){return a+","+b}),new RangeError);return}a.formType=l}if(a&&a.formOrigin){l=
a.formOrigin;if(!this.allowedFormOrigins.includes(l)){this._throwError("formOrigin value is incorrect. Pick a standard value: "+this.allowedFormOrigins.reduce(function(a,b){return a+","+b}),new RangeError);return}a.formOrigin=l}if(a&&a.formVariant){l=a.formVariant;if(!this.allowedFormVariants.includes(l)){this._throwError("formVariant value is incorrect. Pick a standard value: "+this.allowedFormVariants.reduce(function(a,b){return a+","+b}),new RangeError);return}a.formVariant=l}if(a&&a.formComChannel){l=
a.formComChannel.split(",");p=!0;for(var h in l)0>this.allowedFormComChannel.indexOf(l[h].trim())&&(p=!1);if(0==p){if(-1<this.events[b].mandatoryData.indexOf("formComChannel")){console.error("Incorrect TRON implementation: \u26d4 formComChannel value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedFormComChannel.join(", ").toString());this._throwError("formComChannel value is incorrect. Pick a standard value : "+
this.allowedFormComChannel.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f formComChannel value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedFormComChannel.join(", ").toString());a.formComChannel=""}}if(a&&a.formLeadType){l=a.formLeadType.split("-");p=!0;for(h in l)0>this.allowedFormLeadTypes.indexOf(l[h].trim())&&(p=!1);
if(0==p){if(-1<this.events[b].mandatoryData.indexOf("formLeadType")){console.error("Incorrect TRON implementation: \u26d4 formLeadType value is incorrect, hence this event cannot be tracked. Pick one of the following standard values for lead type  \x3d 'lead', 'handraiser' or 'generic'.  Or  provide a  combination of lead type with lead origin separated by '-' eg. 'lead - configurator'. Following values are allowed : "+this.allowedFormLeadTypes.join(", ").toString());this._throwError("formLeadType value is incorrect. Pick one of the following standard values for lead type  \x3d 'lead', 'handraiser' or 'generic'.  Or  provide a  combination of lead type with lead origin separated by '-' eg. 'lead - configurator'. Following values are allowed : "+
this.allowedFormLeadTypes.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f formLeadType value is incorrect and won't be passed to the web tracking tool. Pick one of the following standard values for lead type  \x3d 'lead', 'handraiser' or 'generic'.  Or  provide a  combination of lead type with lead origin separated by '-' eg. 'lead - configurator'. Following values are allowed : "+this.allowedFormLeadTypes.join(", ").toString());
a.formLeadType=""}}"undefined"!=typeof a&&"undefined"!=typeof a.eventEffect&&(this.message.event[0].eventInfo.effect=a.eventEffect);"undefined"!=typeof a&&"form"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].eventInfo.effect=a.eventEffect?this.message.event[0].eventInfo.effect:a.formStep?"form step "+a.formStep:this.message.event[0].eventInfo.effect?this.message.event[0].eventInfo.effect:"",this.message.event[0].eventInfo.type=a.formType,this.message.event[0].category.primaryCategory=
a.formOrigin,this.message.event[0].category.subCategory1=a.formName,this.message.event[0].category.subCategory2=a.formLeadType,this.message.event[0].attributes.form.preferredComChannel=a.formComChannel,this.message.event[0].attributes.form.rfxID=a.formID,this.message.event[0].attributes.stepAmounts=a.formStep&&a.formStepAmounts?"step "+a.formStep+"/"+a.formStepAmounts:"",this.message.event[0].attributes.form.formVariant=a.formVariant,this.message.event[0].attributes.stepName="undefined"!=typeof this.message.event[0].attributes.stepName?
this.message.event[0].attributes.stepName:a.stepName);"undefined"!=typeof a&&"undefined"!=typeof a.formType&&"error"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].attributes.form.formType=a.formType);var u="undefined"!=typeof scope?scope:this;u.allowedVehicleBodyType="ca hb ko co cp li mp ro sc st gf hc sh to gs ga x xr gt gl r rs rr rt 9p 9s 9u b s 9t".split(" ");u.allowedVehicleBusinessDivision=["new vehicle","used vehicle","after sales","other"];u.allowedVehicleCategory1="build to order;pre-order;build to stock;young used car;demonstration car;young used bike;demonstration bike".split(";");
u.allowedVehicleFuelType="bodeghmtxyz".split("");u.allowedVehicleHybridVersion=["beve","erex","hybr","phev","nohy"];u.allowedVehiclePrimaryCategory="new car;used car;used bike;new bike;rental bike;rental car;owned bike;owned car".split(";");u.allowedVehicleSeries="1 2 3 4 5 6 7 8 x i m z clubman 5-doors 3-doors cabrio countryman ad gs he lt ms na sp".split(" ");u.allowedVehicleStatus="available for sale;sold out;order confirmed;pre-order confirmed;contract concluded;vehicle delivered".split(";");
u.allowedVehiclecodeAG=["value should contain only 4 characters"];u.allowedVehiclecodeVG=["value should contain only 4 characters"];u.allowedVehicleItemBasePrice=["value should be numeric"];u.allowedVehicleItemDiscountAmount=["value should be numeric"];u.allowedVehicleItemDiscountPercent=["value should be numeric"];u.allowedVehicleItemPriceWithTax=["value should be numeric"];u.allowedVehicleItemQuantity=["value should be numeric"];u.allowedVehicleItemShippingCost=["value should be numeric"];u.allowedVehicleItemTaxAmount=
["value should be numeric"];u.allowedVehicleItemTaxRate=["value should be numeric"];u.allowedTotalBasePrice=["value should be numeric"];u.allowedTotalDiscountAmount=["value should be numeric"];u.allowedTotalDiscountPercent=["value should be numeric"];u.allowedTotalFinalPrice=["value should be numeric"];u.allowedTotalPriceWithTax=["value should be numeric"];u.allowedTotalShippingCost=["value should be numeric"];u.allowedTotalTaxAmount=["value should be numeric"];var r=0;try{n(a),m(b,a,this.events[b].mandatoryData,
this),this.events[b].optionalData&&g(b,a,this.events[b].optionalData,this)}catch(K){return this._throwError("wrong mandatoryData input for function "+b,K),!1}this.message.product=[];"undefined"!=typeof a&&a.vehicle&&a.vehicle.forEach(function(a){var b=JSON.parse(JSON.stringify(f.defaultDatalayer.product[0]));b.productInfo.productID=d&&d.vehicle&&d.vehicle.productID&&""!=d.vehicle.productID?d.vehicle.productID:a.productID||a.codeVG||a.codeAG||"product"+(r+1);-1<b.productInfo.productID.indexOf("product")&&
(r+=1);b.productInfo.productName=d&&d.vehicle&&d.vehicle.productName&&""!=d.vehicle.productName?d.vehicle.productName:a.name;b.category.productType=d&&d.vehicle&&d.vehicle.productType&&""!=d.vehicle.productType?d.vehicle.productType:a.businessDivision;b.category.primaryCategory=d&&d.vehicle&&d.vehicle.primaryCategory&&""!=d.vehicle.primaryCategory?d.vehicle.primaryCategory:a.primaryCategory;b.category.subCategory1=d&&d.vehicle&&d.vehicle.subCategory1&&""!=d.vehicle.subCategory1?d.vehicle.subCategory1:
a.category1;b.category.subCategory2=d&&d.vehicle&&d.vehicle.subCategory2&&""!=d.vehicle.subCategory2?d.vehicle.subCategory2:a.category2;b.productInfo.manufacturer=d&&d.vehicle&&d.vehicle.manufacturer&&""!=d.vehicle.manufacturer?d.vehicle.manufacturer:a.manufacturer;b.attributes.bodyType=d&&d.vehicle&&d.vehicle.bodyType&&""!=d.vehicle.bodyType?d.vehicle.bodyType:a.bodyType;b.attributes.modelCodeAG=d&&d.vehicle&&d.vehicle.modelCodeAG&&""!=d.vehicle.modelCodeAG?d.vehicle.modelCodeAG:a.codeAG;b.attributes.modelCode=
d&&d.vehicle&&d.vehicle.modelCode&&""!=d.vehicle.modelCode?d.vehicle.modelCode:a.codeVG;b.productInfo.color=d&&d.vehicle&&d.vehicle.color&&""!=d.vehicle.color?d.vehicle.color:a.color;b.attributes.motorization=d&&d.vehicle&&d.vehicle.motorization&&""!=d.vehicle.motorization?d.vehicle.motorization:a.engine;b.attributes.fuelType=d&&d.vehicle&&d.vehicle.fuelType&&""!=d.vehicle.fuelType?d.vehicle.fuelType:a.fuelType;b.attributes.gearing=d&&d.vehicle&&d.vehicle.gearing&&""!=d.vehicle.gearing?d.vehicle.gearing:
a.gearing;b.attributes.hybridVersion=d&&d.vehicle&&d.vehicle.hybridVersion&&""!=d.vehicle.hybridVersion?d.vehicle.hybridVersion:a.hybridVersion;b.attributes.mmdr=d&&d.vehicle&&d.vehicle.mmdr&&""!=d.vehicle.mmdr?d.vehicle.mmdr:a.range;b.attributes.mmdrVG=d&&d.vehicle&&d.vehicle.mmdrVG&&""!=d.vehicle.mmdrVG?d.vehicle.mmdrVG:a.rangeVG;b.attributes.series=d&&d.vehicle&&d.vehicle.series&&""!=d.vehicle.series?d.vehicle.series:a.series;b.attributes.modelName=d&&d.vehicle&&d.vehicle.modelName&&""!=d.vehicle.modelName?
d.vehicle.modelName:a.subSeries;b.attributes.status=d&&d.vehicle&&d.vehicle.status&&""!=d.vehicle.status?d.vehicle.status:a.status;b.attributes.trim=d&&d.vehicle&&d.vehicle.trim&&""!=d.vehicle.trim?d.vehicle.trim:a.trim;b.attributes.productionYear=d&&d.vehicle&&d.vehicle.productionYear&&""!=d.vehicle.productionYear?d.vehicle.productionYear:a.yearOfProduction;b.attributes.yearOfRegistration=d&&d.vehicle&&d.vehicle.yearOfRegistration&&""!=d.vehicle.yearOfRegistration?d.vehicle.yearOfRegistration:a.yearOfRegistration;
b.attributes.encVIN=d&&d.vehicle&&d.vehicle.encVIN&&""!=d.vehicle.encVIN?d.vehicle.encVIN:a.encVIN;f.message.product.push(b)});var t="undefined"==typeof r?0:r;l="";if(a&&a.vehicle)for(h in a.vehicle)a.vehicle[h].codeVG&&"undefined"!=a.vehicle[h].codeVG&&(l=a.vehicle[h].codeVG);if(a&&a.options&&0<a.options.length)for(h in a.options){"undefined"==typeof a.options[h].codeVG&&(a.options[h].codeVG=l);if(a.options[h].businessDivision&&!this.allowedVehicleBusinessDivision.includes(a.options[h].businessDivision)){if(-1<
this.events[b].mandatoryData.indexOf("businessDivision")){console.error("Incorrect TRON implementation: \u26d4 businessDivision value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedVehicleBusinessDivision.join(", ").toString());this._throwError("businessDivision value is incorrect. Pick a standard value : "+this.allowedVehicleBusinessDivision.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f businessDivision value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+
this.allowedVehicleBusinessDivision.join(", ").toString());a.options[h].businessDivision=""}if(a.options[h].codeVG&&0<a.options[h].codeVG.length&&!("value should contain only 4 characters"==this.allowedOptionscodeVG[0]&&4>=a.options[h].codeVG.length)){if(-1<this.events[b].mandatoryData.indexOf("codeVG")){console.error("Incorrect TRON implementation: \u26d4 codeVG value is incorrect, hence this event cannot be tracked. value should contain only 4 characters");this._throwError("codeVG value is incorrect. value should contain only 4 characters");
return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f codeVG value is incorrect and won't be passed to the web tracking tool. value should contain only 4 characters");a.options[h].codeVG=""}if(a.options[h].finDownPayment&&"number"!=typeof q(a.options[h].finDownPayment)){if(-1<this.events[b].mandatoryData.indexOf("options[n].finDownPayment")){console.error("Incorrect TRON implementation: \u26d4 finDownPayment value is incorrect, hence this event cannot be tracked. Please send a numeric value");
this._throwError("finDownPayment is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f finDownPayment value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].finDownPayment=""}else a.options[h].finDownPayment&&"number"==typeof q(a.options[h].finDownPayment)&&(a.options[h].finDownPayment=q(a.options[h].finDownPayment));if(a.options[h].finMileage&&"number"!=typeof q(a.options[h].finMileage)){if(-1<
this.events[b].mandatoryData.indexOf("options[n].finMileage")){console.error("Incorrect TRON implementation: \u26d4 finMileage value is incorrect, hence this event cannot be tracked. Please send a numeric value");this._throwError("finMileage is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f finMileage value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].finMileage=""}else a.options[h].finMileage&&
"number"==typeof q(a.options[h].finMileage)&&(a.options[h].finMileage=q(a.options[h].finMileage));if(a.options[h].finMonthlyPayment&&"number"!=typeof q(a.options[h].finMonthlyPayment)){if(-1<this.events[b].mandatoryData.indexOf("options[n].finMonthlyPayment")){console.error("Incorrect TRON implementation: \u26d4 finMonthlyPayment value is incorrect, hence this event cannot be tracked. Please send a numeric value");this._throwError("finMonthlyPayment is not a number in mandatoryData",new SyntaxError);
return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f finMonthlyPayment value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].finMonthlyPayment=""}else a.options[h].finMonthlyPayment&&"number"==typeof q(a.options[h].finMonthlyPayment)&&(a.options[h].finMonthlyPayment=q(a.options[h].finMonthlyPayment));if(a.options[h].finTerm&&"number"!=typeof q(a.options[h].finTerm)){if(-1<this.events[b].mandatoryData.indexOf("options[n].finTerm")){console.error("Incorrect TRON implementation: \u26d4 finTerm value is incorrect, hence this event cannot be tracked. Please send a numeric value");
this._throwError("finTerm is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f finTerm value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].finTerm=""}else a.options[h].finTerm&&"number"==typeof q(a.options[h].finTerm)&&(a.options[h].finTerm=q(a.options[h].finTerm));if(a.options[h].itemBasePrice&&"number"!=typeof q(a.options[h].itemBasePrice)){if(-1<this.events[b].mandatoryData.indexOf("options[n].itemBasePrice")){console.error("Incorrect TRON implementation: \u26d4 itemBasePrice value is incorrect, hence this event cannot be tracked. Please send a numeric value");
this._throwError("itemBasePrice is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemBasePrice value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemBasePrice=""}else a.options[h].itemBasePrice&&"number"==typeof q(a.options[h].itemBasePrice)&&(a.options[h].itemBasePrice=q(a.options[h].itemBasePrice));if(a.options[h].itemDiscountAmount&&"number"!=typeof q(a.options[h].itemDiscountAmount)){if(-1<
this.events[b].mandatoryData.indexOf("options[n].itemDiscountAmount")){console.error("Incorrect TRON implementation: \u26d4 itemDiscountAmount value is incorrect, hence this event cannot be tracked. Please send a numeric value");this._throwError("itemDiscountAmount is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemDiscountAmount value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemDiscountAmount=
""}a.options[h].itemDiscountAmount=-1*Math.abs(Number(a.options[h].itemDiscountAmount));if(a.options[h].itemDiscountPercent&&"number"!=typeof q(a.options[h].itemDiscountPercent)){if(-1<this.events[b].mandatoryData.indexOf("options[n].itemDiscountPercent")){console.error("Incorrect TRON implementation: \u26d4 itemDiscountPercent value is incorrect, hence this event cannot be tracked. Please send a numeric value");this._throwError("itemDiscountPercent is not a number in mandatoryData",new SyntaxError);
return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemDiscountPercent value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemDiscountPercent=""}a.options[h].itemDiscountPercent=-1*Math.abs(Number(a.options[h].itemDiscountPercent));if(a.options[h].itemPriceWithTax&&"number"!=typeof q(a.options[h].itemPriceWithTax)){if(-1<this.events[b].mandatoryData.indexOf("options[n].itemPriceWithTax")){console.error("Incorrect TRON implementation: \u26d4 itemPriceWithTax value is incorrect, hence this event cannot be tracked. Please send a numeric value");
this._throwError("itemPriceWithTax is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemPriceWithTax value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemPriceWithTax=""}else a.options[h].itemPriceWithTax&&"number"==typeof q(a.options[h].itemPriceWithTax)&&(a.options[h].itemPriceWithTax=q(a.options[h].itemPriceWithTax));if(a.options[h].itemQuantity&&"number"!=typeof q(a.options[h].itemQuantity)){if(-1<
this.events[b].mandatoryData.indexOf("options[n].itemQuantity")){console.error("Incorrect TRON implementation: \u26d4 itemQuantity value is incorrect, hence this event cannot be tracked. Please send a numeric value");this._throwError("itemQuantity is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemQuantity value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemQuantity=""}else a.options[h].itemQuantity&&
"number"==typeof q(a.options[h].itemQuantity)&&(a.options[h].itemQuantity=q(a.options[h].itemQuantity));if(a.options[h].itemShippingCost&&"number"!=typeof q(a.options[h].itemShippingCost)){if(-1<this.events[b].mandatoryData.indexOf("options[n].itemShippingCost")){console.error("Incorrect TRON implementation: \u26d4 itemShippingCost value is incorrect, hence this event cannot be tracked. Please send a numeric value");this._throwError("itemShippingCost is not a number in mandatoryData",new SyntaxError);
return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemShippingCost value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemShippingCost=""}else a.options[h].itemShippingCost&&"number"==typeof q(a.options[h].itemShippingCost)&&(a.options[h].itemShippingCost=q(a.options[h].itemShippingCost));if(a.options[h].itemTaxAmount&&"number"!=typeof q(a.options[h].itemTaxAmount)){if(-1<this.events[b].mandatoryData.indexOf("options[n].itemTaxAmount")){console.error("Incorrect TRON implementation: \u26d4 itemTaxAmount value is incorrect, hence this event cannot be tracked. Please send a numeric value");
this._throwError("itemTaxAmount is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemTaxAmount value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemTaxAmount=""}else a.options[h].itemTaxAmount&&"number"==typeof q(a.options[h].itemTaxAmount)&&(a.options[h].itemTaxAmount=q(a.options[h].itemTaxAmount));if(a.options[h].itemTaxRate&&"number"!=typeof q(a.options[h].itemTaxRate)){if(-1<this.events[b].mandatoryData.indexOf("options[n].itemTaxRate")){console.error("Incorrect TRON implementation: \u26d4 itemTaxRate value is incorrect, hence this event cannot be tracked. Please send a numeric value");
this._throwError("itemTaxRate is not a number in mandatoryData",new SyntaxError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f itemTaxRate value is incorrect, hence this event cannot be tracked. Please send a numeric value");a.options[h].itemTaxRate=""}else a.options[h].itemTaxRate&&"number"==typeof q(a.options[h].itemTaxRate)&&(a.options[h].itemTaxRate=q(a.options[h].itemTaxRate))}if("undefined"!=typeof a&&a.options&&0<a.options.length)for(h in a.options)if("accessories_zub"==
a.options[h].category1)a.options[h].category1="accessories";else if("graphics"==a.options[h].category1)a.options[h].category1="car hood graphics";else if("accessories_lad"==a.options[h].category1)a.options[h].category1="charging";else if("BODY_COLOURS"==a.options[h].category1||"colours"==a.options[h].category1)a.options[h].category1="colors";else if("ENGINES"==a.options[h].category1||"model"==a.options[h].category1)a.options[h].category1="engine";else if("TRIMS"==a.options[h].category1||"interior_trims"==
a.options[h].category1)a.options[h].category1="interior trims";else if("INTERIOR_WORLDS"==a.options[h].category1)a.options[h].category1="interior worlds";else if("lines"==a.options[h].category1||"trimlevel"==a.options[h].category1)a.options[h].category1="lines / trims";else if("OPTIONS"==a.options[h].category1||a.options[h].category1.startsWith("option_group"))a.options[h].category1="options";else if("EXTERIOR_HIGHLIGHTS"==a.options[h].category1)a.options[h].category1="options",a.options[h].category2=
"exterior highlights";else if("INTERIOR_HIGHLIGHTS"==a.options[h].category1)a.options[h].category1="options",a.options[h].category2="interior highlights";else if("PACKAGES"==a.options[h].category1||"PACKAGES_AND_OPTIONS"==a.options[h].category1)a.options[h].category1="packages";else if("TOP_COLOURS"==a.options[h].category1||"roof_and_mirror_caps"==a.options[h].category1)a.options[h].category1="roof and mirror caps";else if("UPHOLSTERY"==a.options[h].category1||"fabrics"==a.options[h].category1)a.options[h].category1=
"upholstery";else if("RIMS"==a.options[h].category1||"wheels"==a.options[h].category1)a.options[h].category1="wheels";else if("accessories:pwr"==a.options[h].category1||"ACCESSORIES_PWR"==a.options[h].category1)a.options[h].category1="winter wheels";"undefined"!=typeof a&&a.options&&(0==this.message.product.length&&(this.message.product=[]),a.options.forEach(function(b){var c=JSON.parse(JSON.stringify(f.defaultDatalayer.product[0]));c.productInfo.productName=d&&d.options&&d.options.productName&&""!=
d.options.productName?d.options.productName:b.name;c.productInfo.productID=d&&d.options&&d.options.productID&&""!=d.options.productID?d.options.productID:b.productID||b.code||"product"+(t+1);c.productInfo.manufacturer=d&&d.options&&d.options.manufacturer&&""!=d.options.manufacturer?d.options.manufacturer:b.manufacturer;c.category.productType=d&&d.options&&d.options.productType&&""!=d.options.productType?d.options.productType:b.businessDivision;c.category.primaryCategory="undefined"!=typeof a.componentName?
a.componentName+" options":b.primaryCategory;c.category.subCategory1=d&&d.options&&d.options.subCategory1&&""!=d.options.subCategory1?d.options.subCategory1:b.category1;c.category.subCategory2=d&&d.options&&d.options.subCategory2&&""!=d.options.subCategory2?d.options.subCategory2:b.category2;c.attributes.modelCode=d&&d.options&&d.options.codeVG&&""!=d.options.codeVG?d.options.codeVG:b.codeVG;c.attributes.fin={};c.attributes.fin.downPayment=d&&d.options&&d.options.downPayment&&""!=d.options.downPayment?
d.options.downPayment:b.downPayment;c.attributes.fin.finMileage=d&&d.options&&d.options.finMileage&&""!=d.options.finMileage?d.options.finMileage:b.finMileage;c.attributes.fin.finMonthlyPayment=d&&d.options&&d.options.finMonthlyPayment&&""!=d.options.finMonthlyPayment?d.options.finMonthlyPayment:b.finMonthlyPayment;c.attributes.fin.finTerm=d&&d.options&&d.options.finTerm&&""!=d.options.finTerm?d.options.finTerm:b.finTerm;f.message.product.push(c)}));if(a&&a.dealer&&0<a.dealer.length){l=!1;for(h in a.dealer)"undefined"==
typeof a.dealer[h].selectionState||this.allowedDealerSelectionState.includes(a.dealer[h].selectionState)||(l=!0,a.dealer[h].selectionState="");if(l){if(-1<this.events[b].mandatoryData.indexOf("dealer[n].selectionState")){console.error("Incorrect TRON implementation: \u26d4 dealer[n].selectionState value is incorrect, hence this event cannot be tracked. Pick a standard value: "+this.allowedDealerSelectionState.join(", ").toString());this._throwError("Incorrect TRON implementation: \u26d4 dealer[n].selectionState value is incorrect. Pick a standard value: "+
this.allowedDealerSelectionState.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f dealer[n].selectionState value is incorrect, hence this event cannot be tracked. Pick a standard value: "+this.allowedDealerSelectionState.join(", ").toString())}}this.message.dealer=[];"undefined"!=typeof a&&a.dealer&&a.dealer.forEach(function(a){var b=JSON.parse(JSON.stringify(f.defaultDatalayer.dealer[0]));b.dealerInfo.dealerGroupID=a.groupID;b.dealerInfo.dealerGroupName=
a.groupName;b.dealerInfo.dealerOutletBuno=a.outletBuno;b.dealerInfo.dealerOutletID=a.outletID;b.dealerInfo.dealerOutletName=a.outletName;b.attributes.selectionState=a.selectionState;b.attributes.location=a.location;f.message.dealer.push(b)});if(a&&a.pageBrand&&(a.pageBrand=a.pageBrand.toLowerCase(),!this.allowedPageBrand.includes(a.pageBrand))){if(-1<this.events[b].mandatoryData.indexOf("pageBrand")){console.error("Incorrect TRON implementation: \u26d4 pageBrand value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+
this.allowedPageBrand.join(", ").toString());this._throwError("pageBrand value is incorrect. Pick a standard value : "+this.allowedPageBrand.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f pageBrand value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedPageBrand.join(", ").toString());a.pageBrand=""}if(a&&a.pageVariant&&(a.pageVariant=
a.pageVariant.toLowerCase(),!this.allowedPageVariant.includes(a.pageVariant))){if(-1<this.events[b].mandatoryData.indexOf("pageVariant")){console.error("Incorrect TRON implementation: \u26d4 pageVariant value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedPageVariant.join(", ").toString());this._throwError("pageVariant value is incorrect. Pick a standard value : "+this.allowedPageVariant.reduce(function(a,
b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f pageVariant value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedPageVariant.join(", ").toString());a.pageVariant=""}if(a&&a.pageGeoRegion)if(2==a.pageGeoRegion.length)a.pageGeoRegion=a.pageGeoRegion.toUpperCase();else if(a.pageGeoRegion=a.pageGeoRegion.toLowerCase(),!this.allowedPageGeoRegion.includes(a.pageGeoRegion)){if(-1<
this.events[b].mandatoryData.indexOf("pageGeoRegion")){console.error("Incorrect TRON implementation: \u26d4 pageGeoRegion value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedPageGeoRegion.join(", ").toString());this._throwError("pageGeoRegion value is incorrect. Pick a standard value : "+this.allowedPageGeoRegion.reduce(function(a,b){return a+","+b}),new RangeError);return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f pageGeoRegion value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+
this.allowedPageGeoRegion.join(", ").toString());a.pageGeoRegion=""}if(a&&a.pageLanguage)if(2<a.pageLanguage.length){if(-1<this.events[b].mandatoryData.indexOf("pageLanguage")){console.error("Incorrect TRON implementation: \u26d4 pageLanguage Language value is incorrect. It has to follow ISO standard of 2 letters in uppercase");this._throwError("Language value is incorrect. It has to follow ISO standard of 2 letters in uppercase");return}console.warn("Incorrect TRON implementation: \u26a0\ufe0f pageLanguage Language value is incorrect. It has to follow ISO standard of 2 letters in uppercase");
a.pageLanguage=""}else a.pageLanguage=a.pageLanguage.toLowerCase();if("undefined"!=typeof dynamicData&&dynamicData.pageSubCat1)if("accessories_zub"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="accessories";else if("graphics"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="car hood graphics";else if("accessories_lad"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="charging";else if("BODY_COLOURS"==dynamicData.pageSubCat1||"colours"==dynamicData.pageSubCat1)dynamicData.options[h].category1=
"colors";else if("ENGINES"==dynamicData.pageSubCat1||"model"==dynamicData.pageSubCat1)dynamicData.options[h].category1="engine";else if("TRIMS"==dynamicData.pageSubCat1||"interior_trims"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="interior trims";else if("INTERIOR_WORLDS"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="interior worlds";else if("lines"==dynamicData.pageSubCat1||"trimlevel"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="lines / trims";else if("OPTIONS"==dynamicData.pageSubCat1||
dynamicData.pageSubCat1.startsWith("option_group"))dynamicData.pageSubCat1="options";else if("EXTERIOR_HIGHLIGHTS"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="options",dynamicData.pageSubCat2="exterior highlights";else if("INTERIOR_HIGHLIGHTS"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="options",dynamicData.pageSubCat2="interior highlights";else if("PACKAGES"==dynamicData.pageSubCat1||"PACKAGES_AND_OPTIONS"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="packages";else if("TOP_COLOURS"==
dynamicData.pageSubCat1||"roof_and_mirror_caps"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="roof and mirror caps";else if("UPHOLSTERY"==dynamicData.pageSubCat1||"fabrics"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="upholstery";else if("RIMS"==dynamicData.pageSubCat1||"wheels"==dynamicData.options[h].category1)dynamicData.pageSubCat1="wheels";else if("accessories:pwr"==dynamicData.pageSubCat1||"ACCESSORIES_PWR"==dynamicData.pageSubCat1)dynamicData.pageSubCat1="winter wheels";a.pageName&&
void 0!=a.pageName&&(this.message.page.pageInfo.pageName=a.pageName,this.message.event[0].eventInfo.effect="page: "+a.pageName+" shown");("undefined"!=typeof this.message.custom&&"page view"==this.message.event[0].eventInfo.eventName||"error"==this.message.event[0].eventInfo.eventName)&&"undefined"!=typeof this.message.page&&(this.message.page.attributes.brand=a.pageBrand,this.message.page.attributes.timeZone=(new Date).getTimezoneOffset()/60+":00",this.message.page.category.primaryCategory=a.componentName||
this.message.component[0].componentInfo.componentName,this.message.page.category.subCategory1=a.pageSubCat1,this.message.page.category.subCategory2=a.pageSubCat2,this.message.page.category.subCategory3=a.pageSubCat3,this.message.page.pageInfo.author=a.componentDEVagency,this.message.page.pageInfo.destinationURL=document.location.href,this.message.page.pageInfo.geoRegion=a.pageGeoRegion,this.message.page.pageInfo.language=a.pageLanguage,this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageName+
" \x3e "+this.message.page.attributes.brand+" \x3e "+this.message.page.pageInfo.geoRegion,this.message.page.pageInfo.pageName=k+this.message.page.pageInfo.pageName,this.message.page.pageInfo.referringURL=document.referrer,this.message.page.pageInfo.sysEnv=a.pageSysEnv||"",this.message.page.pageInfo.variant=a.pageVariant||this.message.page.pageInfo.variant,this.message.page.pageInfo.version=a.pageVersion||a.componentVersion);a.pageName&&"undefined"!=a.pageName&&(this.message.event[0].eventInfo.effect=
"page: "+a.pageName+" shown");"undefined"!=typeof a&&a.componentVersion&&(this.message.component[0].attributes.componentVersion=a.componentVersion,this.message.event[0].category.primaryCategory=a.componentName||this.message.component[0].componentInfo.componentName);"undefined"!=typeof a&&(this.message.component[0].componentInfo.componentID=a.pageBrand||c("page.attributes.brand")||(-1<window.location.hostname.indexOf("bmw")?"bmw":-1<window.location.hostname.indexOf("mini")?"mini":-1<window.location.hostname.indexOf("motorrad")?
"motorrad":""),this.message.component[0].componentInfo.componentID+=" \x3e "+(a.pageGeoRegion||c("page.pageInfo.geoRegion")||""),this.message.component[0].componentInfo.componentID+=" \x3e "+(a.componentName||this.message.component[0].componentInfo.componentName),"form"==this.message.event[0].eventInfo.eventName&&(this.message.component[0].componentInfo.componentID+=" "+a.formType));"undefined"!=typeof this.message.event[0].eventInfo.effect&&(this.message.event[0].eventInfo.effect=k+this.message.event[0].eventInfo.effect,
this.message.event[0].eventInfo.timeStamp=this.message.event[0].timeStamp,delete this.message.event[0].timeStamp);"aem page loaded"!=(((window.adobeDataLayer||"")[0]||"").event||"")&&"page view"!=this.message.event[0].eventInfo.eventName&&"undefined"!=typeof x("page")&&"string"!=typeof x("page")&&(b=JSON.parse(JSON.stringify(c("page.attributes")))||{},b.brand=c("page.attributes.brand")||(-1<window.location.hostname.indexOf("bmw")?"bmw":-1<window.location.hostname.indexOf("mini")?"mini":-1<window.location.hostname.indexOf("bmw-motorrad")?
"bmw-motorrad":""),b.pageTitle=c("page.title")||c("page.pageInfo.pageTitle")||document.title,b.timeZone=c("page.attributes.timeZone")||"",this.message.page={attributes:JSON.parse(JSON.stringify(b)),category:{pageType:c("page.category.pageType")||c("page.category.formType")||c("page.category.primaryTags"),primaryCategory:"NBC"==c("page.attributes.template")?"configurator":"object"==typeof c("page.category.primaryTags")?c("page.category.primaryTags.0"):c("page.pageHier")||c("page.category.subCategory01")||
c("page.category.primaryCategory")||c("page.primarySection")||c("page.category.primaryTags")||"homepage",subCategory1:"object"==typeof c("page.category.secondaryTags")?c("page.category.secondaryTags.0"):c("page.pageLevel2")||c("page.category.subCategory01")||c("page.category.purchaseReason")||c("page.category.subCategory1")||"content",subCategory2:c("page.pageLevel3")||c("page.category.subCategory02")||c("page.category.subCategory2"),subCategory3:c("page.pageLevel4")||c("page.category.subCategory03")||
c("page.category.subCategory3")},pageInfo:{author:c("page.pageInfo.author"),destinationURL:c("page.url")||c("page.pageInfo.destinationUrl")||c("page.pageInfo.destinationURL"),geoRegion:1<window.location.href.split("country\x3d").length?window.location.href.split("country\x3d")[1].split("\x26")[0]:1<window.location.href.split("country\x3d").length?window.location.href.split("country_origin\x3d")[1].split("\x26")[0]:c("page.pageInfo.geoRegion")||(-1<c("page.pageInfo.language").indexOf("-")?c("page.pageInfo.language").split("-")[1]:
-1<window.location.host.indexOf("bmwusa")?"US":""),language:c("page.pageInfo.language").slice(0,2)||(-1<c("page.pageInfo.language").indexOf("-")?c("page.pageInfo.language").split("-")[0]:-1<window.location.host.indexOf("bmwusa")?"en":""),pageID:c("page.path")||c("page.name")||c("page.pageInfo.pageInstanceId")||window.dataLayer&&window.dataLayer.pages&&(window.dataLayer.pages[0]||"").pageInstanceId||c("page.pageInfo.pageID"),pageName:c("page.name")||c("page.pageInfo.pageName"),referringURL:c("page.pageInfo.referringUrl")||
c("page.pageInfo.referringURL")||document.referrer,sysEnv:c("page.pageInfo.devEnv")||c("page.pageInfo.envWork")||c("page.pageInfo.sysEnv"),variant:c("page.pageInfo.variant")||"true"==c("page.attributes.virtualPage")?"virtual page":"real page",version:"acdl: "+c("page.pageInfo.version")}});"undefined"!=typeof a&&"undefined"==typeof a.vehicle&&"error"!=a.eventName&&"undefined"!=typeof x("product")&&"string"!=typeof x("product")&&(this.message.product=x("product"));"undefined"!=typeof x("user")&&"string"!=
typeof x("user")&&(this.message.user=x("user"));"undefined"!=typeof a&&"undefined"==typeof a.dealer&&"undefined"!=typeof x("dealer")&&"string"!=typeof x("dealer")&&(this.message.dealer=x("dealer"));"undefined"!=typeof this.message.custom&&"error"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].eventInfo.effect=a.errorMessage?k+a.errorMessage:"",this.message.event[0].eventInfo.eventAction=a.errorAction,this.message.event[0].eventInfo.cause=a.errorCause,this.message.event[0].eventInfo.type=
a.errorType,this.message.event[0].category.primaryCategory=a.componentName||this.message.component[0].componentInfo.componentName,this.message.event[0].category.subCategory1=a.errorCode,this.message.event[0].category.subCategory2=a.errorOrigin,this.message.event[0].attributes.requestedURL=a.errorURL,delete this.message.event[0].type,delete this.message.event[0].action,delete this.message.event[0].cause,delete this.message.event[0].effect);a.eventCause&&void 0!=a.eventCause&&(this.message.event[0].eventInfo.cause=
a.eventCause||this.message.event[0].eventInfo.cause);"undefined"!==typeof a.eventAction&&"item added"!==this.message.event[0].eventInfo.eventAction&&"item removed"!==this.message.event[0].eventInfo.eventAction&&(this.message.event[0].eventInfo.eventAction=a.eventAction||this.message.event[0].eventInfo.eventAction);this.message.component[0].componentInfo.componentID=this.message.page.attributes.brand+"/"+this.message.page.pageInfo.geoRegion+"_"+this.message.page.pageInfo.language+"/"+this.message.component[0].componentInfo.componentName;
"undefined"!=typeof this.message.page.pageInfo.pageID&&(this.message.page.pageInfo.pageID="/"+this.message.page.category.pageType+"/"+this.message.page.attributes.brand+"/"+this.message.page.pageInfo.geoRegion+"/"+this.message.page.pageInfo.language+"/"+this.message.page.category.primaryCategory+"/","undefined"!=typeof this.message.page.category.subCategory1&&""!=this.message.page.category.subCategory1&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory1+
"/"),"undefined"!=typeof this.message.page.category.subCategory2&&""!=this.message.page.category.subCategory2&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory2+"/"),"undefined"!=typeof this.message.page.category.subCategory3&&""!=this.message.page.category.subCategory3&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory3+"/"),this.message.page.pageInfo.pageID+="undefined"!=typeof this.message.page.pageInfo.pageName&&
-1<this.message.page.pageInfo.pageName.indexOf("\x3e")&&0<this.message.page.pageInfo.pageName.split(" \x3e ").length&&this.message.page.pageInfo.pageName.split(" \x3e ")[1]||this.message.page.pageInfo.pageName);this._debug("\ud83d\udcb2 payload created",this.message);this._sendMessage()};e.prototype._checkmandatoryData=function(b,a){b=this.events[b].mandatoryData;for(var c=!0,d,m="",g=0;g<b.length;g++){d=b[g];if(-1<d.indexOf("[n]")){var e=d.split("[n]");m=e[1].replace(".","");e=a[e[0]]&&a[e[0]][0][m]}else e=
a[d];if("undefined"==typeof e)switch(d){case "componentType":e=this.component.category.componentType;break;case "componentName":e=this.component.componentInfo.componentName;break;case "componentSubCat1":e=this.component.category.subCategory01}d=this._checkValidValue("mandatory",d,m,e);0==d&&(c=!1)}if(0==c)throw new SyntaxError("value does not match expected values: "+c);return!0};e.prototype._checkOptionalData=function(b,a){b=this.events[b].optionalData;for(var c,d="",m=0;m<b.length;m++){var g=b[m];
c=void 0;if(-1<g.indexOf("[n]")){var e=g.split("[n]");a[e[0]]&&0<a[e[0]].length&&(d=e[1].replace(".",""),(c=a[e[0]][0][d])&&""==c&&errArrayVal.push(g))}else c=a[g];if("undefined"!=typeof c||"undefined"!=typeof a[g])c=this._checkValidValue("optional",g,d,c),0==c&&(-1<g.indexOf("[n]")?a[g.split("[n]")[0]][0][g.split("[n]")[1].replace(".","")]="":a[g]="")}return!0};e.prototype._checkValidValue=function(b,a,c,d){var n=!0,g=Object.keys(this).map(function(a){return a.toLowerCase()});c=""!=c&&-1<a.indexOf("[n]")?
a.replace("[n].",""):a;var e=g.filter(function(a){return a.includes(c.toLowerCase())});g="object"==typeof this[Object.keys(this)[g.indexOf(e[0])]]?this[Object.keys(this)[g.indexOf(e[0])]]:[];g=g.filter(function(a){return""!==a});d="string"==typeof d?(d||"").toLowerCase():d;"undefined"==typeof d&&"mandatory"==b&&(console.error("Incorrect TRON implementation: \u26d4 mandatory parameter is missing, hence this event cannot be tracked. Please provide the parameter: "+a),n=!1);"string"==typeof d&&0==d.trim().length&&
"mandatory"==b&&(console.error("Incorrect TRON implementation: \u26d4 "+a+" value is empty, hence this event cannot be tracked. Please provide a valid value: "+g.join(", ").toString()),n=!1);if(Array.isArray(g)&&0<g.length&&!g.includes(d)){if(-1<a.indexOf("vehicle")&&(a=a.split(".")[1],-1<["codeAG","codeVG","range","rangeVG"].indexOf(a))||-1<"formLeadType formComChannel dealer[n].selectionState options[n].code options[n].codeVG options[n].category1".split(" ").indexOf(a)&&"undefined"!=typeof d||1==
g.length&&"value should be numeric"==g[0])return!0;"mandatory"==b?(console.error("Incorrect TRON implementation: \u26d4 "+a+" value is incorrect, hence this event cannot be tracked. Pick a standard value: "+g.join(", ").toString()),n=!1):"optional"==b&&(console.warn("Incorrect TRON implementation: \u26a0\ufe0f "+a+" value is incorrect and won't be passed to the web tracking tool. Pick a standard value: "+g.join(", ").toString()),n=!1)}return n};e.prototype._checkValidOption=function(b,a){var c=[];
switch(b){case "errorType":c=this._validErrorTypes;break;case "errorAction":c=this._validErrorActions;break;case "eventAction":c=this._validEventActions;break;case "eventCause":c=this._validEventCauses}if(!c.includes(a))throw new TypeError("provided value '"+a+"' for field '"+b+"' is not part of standard list");return!0};e.prototype._loadEventData=function(b,a){var c=Object.assign({},JSON.parse(JSON.stringify(this.defaultDatalayer)));c.component[0]=Object.assign({},JSON.parse(JSON.stringify(this.component)));
var e=JSON.parse(JSON.stringify(this.defaultDatalayer.event[0])),m=JSON.parse(JSON.stringify(this.baseEvent)),g=JSON.parse(JSON.stringify(this.events[b].event));c.event[0]=[e,m,g].reduce(this._deepMerge.bind(this),{});c.event[0].timeStamp=(new Date).getTime();d.pageExist&&"undefined"!=typeof c.page&&(c.page=this.events[b].page?Object.assign({},JSON.parse(JSON.stringify(this.page)),JSON.parse(JSON.stringify(this.events[b].page))):Object.assign({},JSON.parse(JSON.stringify(this.page))));d.projConditionCheck&&
d.projectCondition(this,b,a);this.events[b].custom=this.events[b].custom?this.events[b].custom:{};a=JSON.parse(JSON.stringify(this.baseCustom));b=JSON.parse(JSON.stringify(this.events[b].custom));c.custom=[a,b].reduce(this._deepMerge.bind(this),{});c.version="tron_"+this._TronVersion+"__"+this._componentTrackingVersion;return c};e.prototype._throwError=function(b,a){-1<b.indexOf("value does not match")||-1<b.indexOf("input for function")||-1<b.indexOf("in mandatoryData")||-1<b.indexOf("could not create/send")||
-1<b.indexOf("incorrect")?console.error(this.version):-1<b.indexOf("SyntaxError: value does not match expected values")?console.error(this.version):console.error("Incorrect TRON implementation: \u26d4 ",this.version,"\r\n",b,"\r\n",a.name+":"+a.message)};e.prototype._debug=function(b,a){this.debug&&console.info(this.version,"\r\n",b,"\r\n",a)};e.prototype._sendMessage=function(){this._debug("\u231b sending data...");this._sendCustomEvent();this._sendGenericEvent();this._sendPostMessage();this.message=
{}};e.prototype._sendCustomEvent=function(){var b=!1;try{b=new CustomEvent(this.customEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(b)}catch(a){return console.error("Incorrect TRON implementation: \u26d4 custom event created was not sent, hence this event cannot be tracked. Please check the error:",a),this._throwError("could not create/send custom event",a),!1}this._debug("\u2705 custom event successfully sent",b)};e.prototype._sendGenericEvent=function(){var b=
!1;try{b=new CustomEvent(this.genericEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(b)}catch(a){return console.error("Incorrect TRON implementation: \u26d4 custom event created was not sent, hence this event cannot be tracked. Please check the error:",a),this._throwError("could not create/send generic event",a),!1}this._debug("\u2705 generic event successfully sent",b)};e.prototype._sendPostMessage=function(){var b=!1;try{b=JSON.parse(JSON.stringify({methodName:"TRON: postMessage",
detail:this.message,type:"TRON: generic iframe event listener"})),window.top.postMessage(JSON.stringify(b),"*")}catch(a){return console.error("Incorrect TRON implementation: \u26d4 custom event created was not sent, hence this event cannot be tracked. Please check the error:",a),this._throwError("could not create/send postMessage",a),!1}this._debug("\u2705 postmessage successful sent",b)};e.prototype._deepMerge=function(b,a){var c=this;Object.entries(a).forEach(function(a){var d=$jscomp.makeIterator(a);
a=d.next().value;(d=d.next().value)&&"object"===typeof d?c._deepMerge(b[a]=b[a]||{},d):b[a]=d});return b};window.onerror=function(){if(0<arguments.length&&"string"==typeof arguments[0]&&-1<arguments[0].indexOf("Uncaught TypeError: ")&&-1<arguments[0].indexOf("not a function")){var b=arguments[0].split("Uncaught TypeError: ")[1].split("is not a function")[0];console.error("Incorrect TRON implementation: \u26d4 this function "+b+" does not exist , hence this event cannot be tracked. Please make sure to use a correct reference name!",
"\n","Error Occured at:",arguments);return!0}return!1};TRON.isInitialized||(window.addEventListener("TRON: adobeDataLayer generic event listener",function(b){window.tronDetailDL=b.detail;window.adobeDataLayer=window.adobeDataLayer||[];tronDetailDL.page&&tronDetailDL.page.pageInfo&&"undefined"!=typeof tronDetailDL.page.pageInfo.pageName&&"tbd"!=tronDetailDL.page.pageInfo.pageName&&window.adobeDataLayer.push({page:tronDetailDL.page});if(tronDetailDL.page&&tronDetailDL.page.pageInfo&&"tbd"==tronDetailDL.page.pageInfo.pageName&&
"undefined"!=typeof x("page")&&"string"!=typeof x("page")){var a=JSON.parse(JSON.stringify(c("page.attributes")))||{};a.brand=c("page.attributes.brand")||(-1<window.location.hostname.indexOf("bmw")?"bmw":-1<window.location.hostname.indexOf("mini")?"mini":-1<window.location.hostname.indexOf("bmw-motorrad")?"bmw-motorrad":"");a.pageTitle=c("page.title")||c("page.pageInfo.pageTitle")||document.title;a.timeZone=c("page.attributes.timeZone")||"";a={page:{attributes:JSON.parse(JSON.stringify(a)),category:{pageType:c("page.category.pageType")||
c("page.category.formType")||c("page.category.primaryTags"),primaryCategory:"NBC"==c("page.attributes.template")?"configurator":"object"==typeof c("page.category.primaryTags")?c("page.category.primaryTags.0"):c("page.pageHier")||c("page.category.subCategory01")||c("page.category.primaryCategory")||c("page.primarySection")||c("page.category.primaryTags")||"homepage",subCategory1:"object"==typeof c("page.category.secondaryTags")?c("page.category.secondaryTags.0"):c("page.pageLevel2")||c("page.category.subCategory01")||
c("page.category.purchaseReason")||c("page.category.subCategory1")||"content",subCategory2:c("page.pageLevel3")||c("page.category.subCategory02")||c("page.category.subCategory2"),subCategory3:c("page.pageLevel4")||c("page.category.subCategory03")||c("page.category.subCategory3")},pageInfo:{author:c("page.pageInfo.author"),destinationURL:c("page.url")||c("page.pageInfo.destinationUrl")||c("page.pageInfo.destinationURL"),geoRegion:1<window.location.href.split("country\x3d").length?window.location.href.split("country\x3d")[1].split("\x26")[0]:
1<window.location.href.split("country\x3d").length?window.location.href.split("country_origin\x3d")[1].split("\x26")[0]:c("page.pageInfo.geoRegion")||(-1<c("page.pageInfo.language").indexOf("-")?c("page.pageInfo.language").split("-")[1]:-1<window.location.host.indexOf("bmwusa")?"US":""),language:c("page.pageInfo.language").slice(0,2)||(-1<c("page.pageInfo.language").indexOf("-")?c("page.pageInfo.language").split("-")[0]:-1<window.location.host.indexOf("bmwusa")?"en":""),pageID:c("page.path")||c("page.name")||
c("page.pageInfo.pageInstanceId")||window.dataLayer&&window.dataLayer.pages&&(window.dataLayer.pages[0]||"").pageInstanceId||c("page.pageInfo.pageID"),pageName:c("page.name")||c("page.pageInfo.pageName"),referringURL:c("page.pageInfo.referringUrl")||c("page.pageInfo.referringURL")||document.referrer,sysEnv:c("page.pageInfo.devEnv")||c("page.pageInfo.envWork")||c("page.pageInfo.sysEnv"),variant:c("page.pageInfo.variant")||"true"==c("page.attributes.virtualPage")?"virtual page":"real page",version:"acdl: "+
c("page.pageInfo.version")}}};window.adobeDataLayer.push(a)}var d={};a=tronDetailDL.component[0].componentInfo.componentID;d[a]=tronDetailDL.component[0];window.adobeDataLayer.push({component:d,version:tronDetailDL.version});d={};var e=[],m=tronDetailDL.product;if(0<m.length&&"string"!=typeof m){for(var g in m){var f=m[g].productInfo.productID;"undefined"==typeof f&&(f="product"+(g+1));d[f]=m[g]}Object.keys(d).forEach(function(a){return e.push(a)});window.adobeDataLayer.push({product:d})}m={};if((f=
b.detail.cart)&&0<f.item.length&&"string"!=typeof f){if("commerce"==tronDetailDL.event[0].eventInfo.eventName&&("cart"==tronDetailDL.event[0].eventInfo.type||"checkout"==tronDetailDL.event[0].eventInfo.type)||""!=(((b.detail||"").cart||"").cartID||""))m=Object.assign({},d);window.adobeDataLayer.push({cart:{item:m,price:b.detail.cart.price||{},cartID:b.detail.cart.cartID||""}})}m={};if((f=b.detail.transaction)&&0<f.item.length&&"string"!=typeof f){if("commerce"==tronDetailDL.event[0].eventInfo.eventName&&
"order"==tronDetailDL.event[0].eventInfo.type||""!=(((b.detail||"").transaction||"").transactionID||""))m=Object.assign({},d);window.adobeDataLayer.push({transaction:{item:m,total:b.detail.transaction.total||{},transactionID:b.detail.transaction.transactionID||""}})}b={};var k={};d=tronDetailDL.dealer;if(0<d.length&&"string"!=typeof d){for(g in d)b[d[g].dealerInfo.dealerOutletBuno]=d[g];Object.keys(b).forEach(function(a){return k[a]=""});window.adobeDataLayer.push({dealer:b})}if(0<tronDetailDL.user.length&&
"string"!=typeof tronDetailDL.user){b={};d=tronDetailDL.user;for(g in d){m={};if(Array.isArray(d[g].profile)&&0<d[g].profile.length)for(var l in d[g].profile)f=void 0!=d[g].profile[l].profileInfo.profileID?d[g].profile[l].profileInfo.profileID:"profile"+(l+1),m[f]=JSON.parse(JSON.stringify(d[g].profile[l]));else"undefined"!=typeof d[g].profile||"undefined"==typeof d[g].profileInfo||Array.isArray(d[g].profileInfo)||(f="profile"+(g+1),m.profile={},m.profile[f]=JSON.parse(JSON.stringify(d[g].profileInfo)));
f="user"+(g+1);b[f]=JSON.parse(JSON.stringify(d[g]));b[f].profile=JSON.parse(JSON.stringify(m))}tronDetailDL.user=JSON.parse(JSON.stringify(b));window.adobeDataLayer.push({user:tronDetailDL.user})}window.adobeDataLayer.push({event:"page view"==tronDetailDL.event[0].eventInfo.eventName?"tron page view":"tron event",eventInfo:{cause:tronDetailDL.event[0].eventInfo.cause,effect:tronDetailDL.event[0].eventInfo.effect,eventAction:tronDetailDL.event[0].eventInfo.eventAction,eventName:tronDetailDL.event[0].eventInfo.eventName,
eventPoints:tronDetailDL.event[0].eventInfo.eventPoints,timeStamp:tronDetailDL.event[0].eventInfo.timeStamp,type:tronDetailDL.event[0].eventInfo.type,category:tronDetailDL.event[0].category,attributes:tronDetailDL.event[0].attributes,reference:{linkedComponent:a,linkedProducts:e,linkedDealers:k}}})}),TRON.isInitialized=!0);var N=new e,T=function(){function b(){v(this,b)}l(b,[{key:"addEventTron",value:function(a,b){var c=this,d=k.trackingComponent;d={componentVersion:d.componentVersion,componentType:d.componentType,
formLeadType:k.formLeadType,formType:k.trackingType,formName:k.subCategory1,formVariant:k.formVariant,formOrigin:"adobe form"};k.selectedComChannel&&(d.formComChannel=k.selectedComChannel);var g=[],e=[],n=window.formsTrackingData.get("formTrackingVehicle"),f=window.formsTrackingData.get("formTrackingBrochures");guidelib.bf.tracking.trackingData?g.push(this.getVehicleData(guidelib.bf.tracking.trackingData)):n?JSON.parse(n).vehicle.forEach(function(a){g.push(c.getVehicleData(a))}):f&&JSON.parse(f).forEach(function(a){g.push(c.getVehicleData(a))});
guidelib.bf.tracking.commonAttributes=d;guidelib.bf.tracking.vehicle=g;switch(a){case "formStarted":N.formStarted(w(w({},d),{},{vehicle:g,options:e}));break;case "formFirstInteraction":N.formFirstInteraction(w(w(w({},d),b),{},{vehicle:g,options:e}));break;case "formStep":N.formStep(w(w(w({},d),b),{},{vehicle:g,options:e}));break;case "formFinishIntention":N.formFinishIntention(w(w({},d),{},{vehicle:g,options:e}));break;case "loginButtonClick":N.loginButtonClick(w(w({},d),{},{vehicle:g,options:e}));
break;case "loginReturn":N.loginReturn(w(w(w({},d),b),{},{vehicle:g,options:e}))}}},{key:"getVehicleData",value:function(a){var b={};a.series&&(b.series=a.series);a.status&&(b.status=a.status);a.fuelType&&(b.fuelType=a.fuelType);if(a.manufacturer||a.brand)b.manufacturer=a.manufacture||a.brand;a.hybridVersion&&(b.hybridVersion=a.hybridVersion);a.category1&&(b.category1=a.category1);a.bodyType&&(b.bodyType=a.bodyType);a.primaryCategory&&(b.primaryCategory=a.primaryCategory);a.businessDivision&&(b.businessDivision=
a.businessDivision);a.category2&&(b.category2=a.category2);a.codeAG&&(b.codeAG=a.codeAG||a.agCode);a.codeVG&&(b.codeVG=a.codeVG||a.vgCode);a.color&&(b.color=a.color);a.engine&&(b.engine=a.engine);a.gearing&&(b.gearing=a.gearing);if(a.name||a.modelName)b.name=a.name||a.modelName;a.productID&&(b.productID=a.productID);if(a.range||a.modelRange)b.range=a.range||a.modelRange;a.rangeVG&&(b.rangeVG=a.rangeVG);a.subSeries&&(b.subSeries=a.subSeries);a.vehicleData&&(a.vehicleData.fuelType&&(b.fuelType=a.vehicleData.fuelType),
a.vehicleData.bodyType&&(b.bodyType=a.vehicleData.bodyType),a.vehicleData.productType&&(b.businessDivision=a.vehicleData.productType),a.vehicleData.clusterRough&&(b.color=a.vehicleData.clusterRough));return b}},{key:"getOptionData",value:function(a){var b={};a.businessDivision&&(b.businessDivision=a.businessDivision);a.category1&&(b.category1=a.category1);a.category2&&(b.category2=a.category2);a.manufacturer&&(b.manufacturer=a.manufacturer);a.name&&(b.name=a.name);a.primaryCategory&&(b.primaryCategory=
a.primaryCategory);a.productID&&(b.productID=a.productID);return b}}]);return b}(),Ja=new T,Ca=function(){function b(){v(this,b);guidelib.bf.tracking.multistep.stepCached=-1}l(b,[{key:"render",value:function(){var a=this;this.stepsTracking();guideBridge.on("elementNavigationChanged",function(b,c){a.stepsTracking()})}},{key:"stepsTracking",value:function(){var a=guidelib.bf.tracking.multistep;a.isMultistep&&a.step!==a.stepCached&&(Ja.addEventTron("formStep",{formStep:a.step,formStepAmounts:a.stepAmounts,
formStepName:a.name}),a.stepCached=a.step)}}]);return b}(),pa=new T,Ka=function(){function b(a){v(this,b);this.payload=a}l(b,[{key:"render",value:function(){$(".loginButton").on("click",function(){pa.addEventTron("loginButtonClick")});guideBridge._guide.on("loginSuccess",function(){pa.addEventTron("loginReturn",{userLoginStatus:"logged in"})});guideBridge._guide.on("loginFailed",function(){pa.addEventTron("loginReturn",{userLoginStatus:"not logged in"})})}}]);return b}(),wa=new T,La=new Ka,Ia=function(){function b(){v(this,
b);this.trackingCommons=new L;this.trackingAdapter=this.trackingCommons.TrackingAdapter;this.satellite=this.trackingCommons.Satellite;guidelib.bf.tracking.trackingData&&(this.trackingAdapter.initProductTracking(guidelib.bf.tracking.trackingData),this.trackingCommons.saveDataForSuccessError("formTrackingVehicle",JSON.stringify(guidelib.bf.tracking.trackingData)));var a=[];0!==k.trackingProduct.size?k.trackingProduct.forEach(function(b){a.push({productInfo:{productID:b.productID}})}):a.push({productInfo:{productID:""}});
wa.addEventTron("formStarted",{linkedProduct:a});var c=new Ca;this._formEventTracking();this._firstInteractionTracking();c.render();La.render()}l(b,[{key:"_formEventTracking",value:function(){var a=this;guideBridge.on("elementButtonClicked",function(b,c){var d,g;if("submit"===(null===c||void 0===c?void 0:null===(d=c.jsonModel)||void 0===d?void 0:null===(g=d.target)||void 0===g?void 0:g.type))try{"combo form"===k.formVariant&&(k.trackingType=Array.from(k.multipleRequestTypes,function(a){return a[0]}).join(",").toLowerCase(),
a.trackingCommons.saveDataForSuccessError("formTrackingComponent",JSON.stringify({trackingComponent:k.trackingComponent,pageID:a.trackingAdapter.getPageObject(a.trackingAdapter.getCurrentPageIndex()).pageInstanceId||""}))),wa.addEventTron("formFinishIntention")}catch(q){console.error("Error in initEventTracking",q.toString())}})}},{key:"_firstInteractionTracking",value:function(){var a=!1,b=$("#guideContainerForm"),c=function(a){var b;switch(a.tagName){case "INPUT":"checkbox"===a.type?$(a).is(":checked")?
b="internal click":b=void 0:"radio"===a.type?0!==a.value.length?b="internal click":b="radio button":"submit"===a.type?b=void 0:"text"===a.type?b="form fill":-1!==a.className.indexOf("datePickerInput")?0!==a.value.length?b=void 0:b="internal click":0!==a.value.length?b=void 0:b="form fill";break;case "TEXTAREA":0!==a.value.length?b=void 0:b="form fill";break;case "SELECT":0!==a.value.length?b=void 0:b="drop-down menu";break;case "BUTTON":-1!==a.className.indexOf("bfDropDownList--multiselect")||-1!==
a.className.indexOf("guideHelpQuestionMark")?b="internal click":0<$(a).parent(".dropDownList").length?0!==$(a).find(".bfDropDownList__button-item-text").length?b=void 0:b="drop-down menu":b=-1!==a.className.indexOf("submit")?"internal click":"button";break;default:b="internal click"}return b};$(b).find("button, input, textarea, select, .dealerlocator, a").on("click",function(b){try{!0!==a&&(void 0!==c(b.currentTarget)?(wa.addEventTron("formFirstInteraction",{eventAction:c(b.currentTarget)}),a=!0):
a=!1)}catch(g){console.error(g)}})}}]);return b}();T=f(757);var Da=f.n(T);new e;new Ca;var Ha=function(){function b(){v(this,b);this.trackingCommons=new L;this.trackingAdapter=this.trackingCommons.TrackingAdapter}l(b,[{key:"initProductTracking",value:function(){var a=this;return new Promise(function(b){function c(a,b){try{var c,m,q,ba,ta,xa,la,ya,K,ma,ua,C,D,F,G,H,Q,ca,da,ea,fa,ha;if(null!==b&&void 0!==b&&null!==(c=b.jsonModel)&&void 0!==c&&c.target)var E=b.jsonModel.target.bindRef;else if(b.bindRef)E=
b.bindRef,b.newText=b.value;else return;var ja=E.match(/\/requests\/?.+\/includeInSubmit/g);if(-1!==E.indexOf("/requestsCommon/vehicleConfigurations/vehicleConfigurations/seriesCode")){if(b.newText===d||!k.singleProduct)return;X=!0;d=b.newText}else if(-1!==E.indexOf("/requestsCommon/vehicleConfigurations/vehicleConfigurations/modelRange")){if(b.newText===g||!k.singleProduct)return;X=!0;g=b.newText}else if(-1!==E.indexOf("/requestsCommon/vehicleConfigurations/vehicleConfigurations/modelCode")){if(b.newText===
p||!k.singleProduct)return;J(b.newText);X=!0;p=b.newText}else if((-1!==E.indexOf("/contactPolicyConsents/policy1")||-1!==E.indexOf("/contactPolicyConsents/policy2")||-1!==E.indexOf("/contactPolicyConsents/policy3"))&&-1===E.indexOf("/contactPolicyConsents/policy1/policySpecification")){if(b.newText){k.selectedComChannel="";var Ea=JSON.parse(b.newText),P;for(P in Ea)k.selectedComChannel+=Object.getOwnPropertyNames(Ea[P])[0]+", ";k.selectedComChannel=k.selectedComChannel.slice(0,k.selectedComChannel.length-
2);this.trackingCommons.saveDataForSuccessError("selectedComChannel",k.selectedComChannel)}}else if(-1!==E.indexOf("/requestsCommon/informations/informationPayload"))try{var va=JSON.parse(b.newText);a=[];k.brochureID="";k.rfiModelCodes="";var qa=V(va),R;try{for(qa.s();!(R=qa.n()).done;){var ia=R.value;k.brochureType=ia.informationType;""!==ia.productModelRange&&(k.rfiModelCodes=k.rfiModelCodes+ia.productModelCode+",",a.push({series:ia.productSeries,modelCode:ia.productModelCodeArray,modelRange:ia.productModelRangeArray,
productName:ia.informationName,id:ia.informationId}));k.brochureID=k.brochureID+ia.informationId+","}}catch(ra){qa.e(ra)}finally{qa.f()}k.rfiModelCodes=k.rfiModelCodes.substring(0,k.rfiModelCodes.length-1);k.brochureID=k.brochureID.substring(0,k.brochureID.length-1);1<=a.length?this.createProductFromBrochures(a):this.createProductFromBrochures([{series:"",modelCode:"",modelRange:"",productName:"",id:""}])}catch(ra){console.error("tracking-components -\x3e","could not parse informationPayload")}else if(-1!==
E.indexOf("/businessPartner/profile/plannedPurchase"))"YES"!==b.newText&&"NO"!==b.newText&&"rfi"===k.trackingType&&(k.rfiPurchaseIntentPeriod=null===b.newText?"":b.newText);else if(-1!==E.indexOf("/requestsCommon/vehicleConfigurations/vehicleConfigurations/optionalEquipments/optionalEquipments/classificator")){var L,M;if(null===b.newText)return;var Y=JSON.parse(b.newText);r=Y.configId;n=Y.fuelType;l=Y.hybridVersion;f=null!==(L=Y.modelBaseCode)&&void 0!==L?L:"";if(null===d&&null===g){var N,Z,O;d=null!==
(N=Y.seriesCode)&&void 0!==N?N:d;g=null!==(Z=Y.modelRange)&&void 0!==Z?Z:g;p=null!==(O=Y.modelCode)&&void 0!==O?O:p;J(p)}r&&null!==Y&&void 0!==Y&&null!==(M=Y.financeCalculation)&&void 0!==M&&M.parameterValues&&(Y.financeCalculation.parameterValues.forEach(function(a){switch(a.code){case "MonthlyPaymentWithoutServices":w=a.value;break;case "DepositAmountLeasing":v=a.value;break;case "Mileage":t=a.value;break;case "Term":y=a.value}}),X=!0)}else if("datepicker_appointment"===(null===b||void 0===b?void 0:
null===(m=b.jsonModel)||void 0===m?void 0:null===(q=m.target)||void 0===q?void 0:null===(ba=q.jsonModel)||void 0===ba?void 0:ba.name))u=Math.ceil(Math.abs(new Date(b.newText)-new Date)/864E5);else if(-1!==E.indexOf("requests/RFS/serviceList/services/serviceType"))null!==b.newText&&(z=b.newText);else if(-1!==E.indexOf("/requests/RFS/serviceList/services/serviceCategory"))null!==b.newText&&(x=b.newText);else if(-1!==E.indexOf("/requests/RFA/accessoryList/accessories/accessoryName"))null!==b.newText&&
(z=b.newText);else if(-1!==E.indexOf("/requests/RFA/accessoryList/accessories/accessoryId"))null!==b.newText&&(S=b.newText);else if(-1!==E.indexOf("/requests/RFC/contact/contactReason"))null!==b.newText?k.subCategory1=b.newText||"generic":"rfc"===k.trackingType&&(k.subCategory1="generic");else if("Carmen"===(null===(ta=guidelib)||void 0===ta?void 0:null===(xa=ta.bf)||void 0===xa?void 0:null===(la=xa.context)||void 0===la?void 0:la.crmSystem)&&-1!==E.indexOf("/requestsCommon/vehicleConfigurations/vehicleConfigurations/bodyCode")){if(b.newText===
g||!k.singleProduct)return;S=B=l=n=A=I=h=p=f=e=g="";X=!0;S=b.newText;if(-1!==b.newText.indexOf("-")){var W=b.newText.split("-"),T=ka(W,2);e=T[0];A=T[1];g=e}e.endsWith("E")&&(n="e",l="beve",g=e.slice(0,-1))}else if(("Carmen_UK"===(null===(ya=guidelib)||void 0===ya?void 0:null===(K=ya.bf)||void 0===K?void 0:null===(ma=K.context)||void 0===ma?void 0:ma.crmSystem)||"ELAINE"===(null===(ua=guidelib)||void 0===ua?void 0:null===(C=ua.bf)||void 0===C?void 0:null===(D=C.context)||void 0===D?void 0:D.crmSystem))&&
-1!==E.indexOf("/requestsCommon/vehicleConfigurations/vehicleConfigurations/bodyCode")){if(b.newText===e||!k.singleProduct)return;X=!0;S=g=e=b.newText;e.endsWith("E")&&(n="e",l="beve",g=e.slice(0,-1))}else if(("Carmen"===(null===(F=guidelib)||void 0===F?void 0:null===(G=F.bf)||void 0===G?void 0:null===(H=G.context)||void 0===H?void 0:H.crmSystem)||"Carmen_UK"===(null===(Q=guidelib)||void 0===Q?void 0:null===(ca=Q.bf)||void 0===ca?void 0:null===(da=ca.context)||void 0===da?void 0:da.crmSystem)||"ELAINE"===
(null===(ea=guidelib)||void 0===ea?void 0:null===(fa=ea.bf)||void 0===fa?void 0:null===(ha=fa.context)||void 0===ha?void 0:ha.crmSystem))&&-1!==E.indexOf("/requestsCommon/vehicleConfigurations/vehicleConfigurations/modelName")){if(b.newText===h||!k.singleProduct)return;X=!0;h=b.newText}else if(null!==ja&&0!==ja.length){var U=E.match(/(requests\/)(.*)(\/includeInSubmit)/g)[0].replace("requests/","").replace("/includeInSubmit","");if(null!==b.newText&&"combo form"===k.formVariant)k.multipleRequestTypes.set(U,
b.newText);else if(null===b.newText&&"combo form"===k.formVariant&&null!==a)k.multipleRequestTypes["delete"](U);else return;k.trackingType=Array.from(k.multipleRequestTypes,function(a){return a[0]}).join(",").toLowerCase()}null!=u&&this.trackingCommons.saveDataForSuccessError("formTrackingLeadTime",u)}catch(ra){console.error("Error in ProductTracking",ra.toString())}}if("no product"===a.trackingCommons.getMetaInfo("productLayerPrimaryCategory"))return b();var d,g,e,f,n,l,p,h,u,r,t,v,w,y,x,z,S,A,B,
I,X=!1,J=function(b,c){a.getDataFromTrackingWorker(b).then(function(a){a&&(A=a.bodyTypeCode,n=a.fuelTypeCode,f=a.modelCodeAG,g=a.modelRangeAG,e=a.modelRangeVG,B=a.motorizationDerivative,I=a.gearingTransmissionCode,h=a.name,d=a.series,l=a.hybridVersionCode);C(c)})},C=function(b){b={model:p,modelCodeAG:f,configId:r,fuelType:n,hybridVersion:l,modelName:h,modelRange:g,modelRangeVG:e,series:d,annualMileage:t,downPayment:v,monthlyPayment:w,term:y,subCategory1:x,productName:z,productID:S,bodyType:A,motorizationDerivative:B,
gearing:I};Object.entries(b).toString()!==Object.entries(k.productState).toString()&&(k.productState=b,0!==k.trackingAccessory.size?(k.singleProduct=!1,k.trackingProduct.set(0,a.enrichProductData(b)),a.addProduct(null,[].concat(M(k.trackingProduct.values()),M(k.trackingAccessory.values())))):a.addProduct(b))},Q;window._&&(Q=window._.debounce(b,1E3));void 0===Q&&b();var F=!0;guideBridge.visit(function(b){c.call(a,null,b);b.bindRef&&-1!==(null===b||void 0===b?void 0:b.bindRef.indexOf("/includeInSubmit"))&&
(a.requestCount+=1);F&&(F=!1,k.multipleProductsPanel=a.traverseObjectToFindRepeatablePanel(b.rootPanel,"down"),k.singleProduct=!k.multipleProductsPanel);(null!==d&&null!==g&&X||void 0!==x||void 0!==S)&&C();void 0!==Q&&Q()});var G=function(){var b=Ga(Da().mark(function Ma(){var b,c,d,g,e,h;return Da().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:b=[];if(c=a.getProductsFromRepeatablePanel(k.multipleProductsPanel)){f.next=4;break}return f.abrupt("return");case 4:d=V(c),f.prev=5,d.s();case 7:if((g=
d.n()).done){f.next=17;break}e=g.value;if(!e.modelCode){f.next=15;break}f.next=12;return a.getDataFromTrackingWorker(e.modelCode);case 12:h=f.sent,k.trackingProduct.set(c.indexOf(e),h),b.push(a.enrichProductData(D({},h)));case 15:f.next=7;break;case 17:f.next=22;break;case 19:f.prev=19,f.t0=f["catch"](5),d.e(f.t0);case 22:return f.prev=22,d.f(),f.finish(22);case 25:if(0!==b.length){f.next=27;break}return f.abrupt("return");case 27:a.addProduct(null,b);case 28:case "end":return f.stop()}},Ma,null,
[[5,19,22,25]])}));return function(){return b.apply(this,arguments)}}(),H;window._&&(H=window._.debounce(G,1E3));guideBridge.on("elementValueChanged",function(b,e){c.call(a,b,e);H&&!k.singleProduct?H(e):k.singleProduct||G(e).then();(k.singleProduct&&null!==d&&null!==g&&X||void 0!==x||void 0!==S)&&C();void 0!==Q&&Q()})})}},{key:"traverseObjectToFindRepeatablePanel",value:function(a,b){var c,d;b=null!==(c=b)&&void 0!==c?c:"up";if("guidePanel"===a.className&&!0===a.repeatable)return a.parent;if("up"===
b&&a.parent)return this.traverseObjectToFindRepeatablePanel(a.parent);if("down"===b&&0<(null===(d=a.children)||void 0===d?void 0:d.length)){a=V(a.children);var g;try{for(a.s();!(g=a.n()).done;){var e=this.traverseObjectToFindRepeatablePanel(g.value,"down");if(e)return e}}catch(la){a.e(la)}finally{a.f()}}else return!1}},{key:"getProductsFromRepeatablePanel",value:function(a){function b(a,b){var c=new Map,d=-1,e=function h(b,e){if("guidePanel"===b.className){b=V(b.items);var g;try{for(b.s();!(g=b.n()).done;){var f=
g.value;e||d++;h(f,!0)}}catch(K){b.e(K)}finally{b.f()}}else if(b.bindRef&&-1<a.indexOf(b.bindRef)){var k;e=null!==(k=c.get(d))&&void 0!==k?k:{};g=b.bindRef.split("/");e[g[g.length-1]]=b.value;c.set(d,e)}};"guidePanel"===b.className&&b.items&&e(b);return Array.from(c.values())}return a?((a=b(["/MultiOfferResponse/requestsCommon/vehicleConfigurations/vehicleConfigurations/seriesCode","/MultiOfferResponse/requestsCommon/vehicleConfigurations/vehicleConfigurations/modelRange","/MultiOfferResponse/requestsCommon/vehicleConfigurations/vehicleConfigurations/modelCode"],
a))&&0<a.length&&(this.singleProduct=!1),a):!1}},{key:"getDataFromTrackingWorker",value:function(a){return new Promise(function(b){window.trackingWorker.postMessage({type:"data",message:a});window.trackingWorker.onmessage=function(a){r.log("DATA From Worker",a.data);b(a.data)}})}},{key:"addProduct",value:function(a,b){if(0===k.trackingProduct.size&&k.singleProduct){var c=this.enrichProductData(a);k.productTemp=this.trackingAdapter.initProductTracking(c);k.trackingProduct.set(k.trackingProduct.size,
c)}else k.singleProduct?(c=this.enrichProductData(a),k.trackingProduct.set(0,c)):this.updateProductDataLayer(b,{overwrite:!0});this.trackingCommons.saveDataForSuccessError("formTrackingVehicle",JSON.stringify({vehicle:void 0===c?b:[c]}));return k.productTemp}},{key:"enrichProductData",value:function(a){var b,c,d,e,f,k,l,p,r,h,u,t,v,w,x,y,z,A,B,C,D,F,G,H,I,Q,J,L,M,N,O,P,R,T,U,V,W,aa;if("object"!==Z(a))return!1;var ka=this.trackingCommons.getMetaInfo("productLayerSubCategory1"),na=this.trackingCommons.getMetaInfo("productLayerPrimaryCategory"),
oa=this.trackingCommons.getMetaInfo("productLayerManufacturer"),pa=this.trackingCommons.getMetaInfo("productLayerProductType");return this.trackingCommons.createProduct({annualMileage:null!==(b=a.annualMileage)&&void 0!==b?b:"",bodyType:null!==(c=null!==(d=a.bodyType)&&void 0!==d?d:a.bodyTypeCode)&&void 0!==c?c:"",configID:null!==(e=a.configId)&&void 0!==e?e:"",codeVG:null!==(f=null!==(k=a.model)&&void 0!==k?k:a.modelCodeVG)&&void 0!==f?f:"",codeAG:null!==(l=a.modelCodeAG)&&void 0!==l?l:"",downPayment:null!==
(p=a.downPayment)&&void 0!==p?p:"",fuelType:null!==(r=null!==(h=a.fuelType)&&void 0!==h?h:a.fuelTypeCode)&&void 0!==r?r:"",gearing:null!==(u=null!==(t=a.gearing)&&void 0!==t?t:a.gearingTransmissionCode)&&void 0!==u?u:"",hybridVersion:null!==(v=null!==(w=a.hybridVersion)&&void 0!==w?w:a.hybridVersionCode)&&void 0!==v?v:"",linkedProduct:null!==(x=a.linkedProduct)&&void 0!==x?x:[],manufacturer:oa,range:null!==(y=null!==(z=a.modelRange)&&void 0!==z?z:a.modelRangeAG)&&void 0!==y?y:"",rangeVG:null!==(A=
a.modelRangeVG)&&void 0!==A?A:"",modelCode:null!==(B=null!==(C=a.model)&&void 0!==C?C:a.modelCodeVG)&&void 0!==B?B:"",modelCodeAG:null!==(D=a.modelCodeAG)&&void 0!==D?D:"",modelName:null!==(F=null!==(G=a.modelName)&&void 0!==G?G:a.name)&&void 0!==F?F:"",monthlyPayment:null!==(H=a.monthlyPayment)&&void 0!==H?H:"",motorization:null!==(I=a.motorizationDerivative)&&void 0!==I?I:"",primaryCategory:null!==(Q=null!==(J=a.primaryCategory)&&void 0!==J?J:na)&&void 0!==Q?Q:"",productID:null!==(L=null!==(M=a.productID)&&
void 0!==M?M:a.model)&&void 0!==L?L:"",productName:null!==(N=null!==(O=null!==(P=a.modelName)&&void 0!==P?P:a.productName)&&void 0!==O?O:a.name)&&void 0!==N?N:"",businessDivision:null!==(R=null!==(T=a.productType)&&void 0!==T?T:pa)&&void 0!==R?R:"",series:null!==(U=a.series)&&void 0!==U?U:"M",category1:null!==(V=null!==(W=a.subCategory1)&&void 0!==W?W:ka)&&void 0!==V?V:"",term:null!==(aa=a.term)&&void 0!==aa?aa:""})}},{key:"createProductFromBrochures",value:function(a){var b=this,c=[];a.forEach(function(a){var d,
e=b.trackingCommons.createProduct({productName:a.productName,productID:a.id,series:null!==(d=a.series)&&void 0!==d?d:"M",manufacturer:b.trackingCommons.getMetaInfo("productLayerManufacturer"),primaryCategory:b.trackingCommons.getMetaInfo("productLayerPrimaryCategory"),category1:b.trackingCommons.getMetaInfo("productLayerSubCategory1"),businessDivision:b.trackingCommons.getMetaInfo("productLayerProductType")});d=V(a.modelRange);var f;try{for(d.s();!(f=d.n()).done;){var k=f.value;if(1<a.modelCode.length){var l=
JSON.parse(JSON.stringify(e));l.range=k;l.modelCode="multiple";c.push(l)}else{var m,h=null!==(m=a.modelCode[0])&&void 0!==m?m:"",n=JSON.parse(JSON.stringify(e));n.range=k;n.modelCode=h;c.push(n)}}}catch(va){d.e(va)}finally{d.f()}});this.updateProductDataLayer(c)}},{key:"updateProductDataLayer",value:function(a,b){var c=this;b=(null===b||void 0===b?void 0:b.overwrite)||!1;var d=JSON.parse(JSON.stringify(this.trackingCommons.pageObjectBmwMini())),e=null===d||void 0===d?void 0:d.product.filter(function(a){return""===
a.productID}).length,f=-1;f=0===e||b?(null===d||void 0===d?NaN:d.product.length)-1:(null===d||void 0===d?NaN:d.product.length)-e;var k=0;a.forEach(function(a,b){(null===d||void 0===d?0:d.product.find(function(b){return b.productID===a.productID}))||f>=b?(c.trackingAdapter.updateProductTracking(k,a,c.trackingAdapter.getCurrentPageIndex()),k++):c.trackingAdapter.initProductTracking(a,c.trackingAdapter.getCurrentPageIndex())});for(b=null===d||void 0===d?void 0:null===(l=d.product)||void 0===l?void 0:
l.length;b>=a.length;b--){var l;this.trackingAdapter.updateProductTracking(b,this.trackingCommons.createProduct({primaryCategory:"",businessDivision:"",manufacturer:""}),this.trackingAdapter.getCurrentPageIndex())}this.trackingCommons.saveDataForSuccessError("formTrackingBrochures",JSON.stringify(a))}}]);return b}(),Aa=0,Ba=new e;Ba.setDebug(!0);P().then(function(){F()});P().then(function(){null==window.guideBridge?window.addEventListener("bridgeInitializeStart",function(b){b.detail.guideBridge.connect(G())}):
guideBridge.connect(G())})})()})();