define("ds2-page-tron-tracking",[],(function(){return function(){var e={924:function(e,t,a){"use strict";var n;a.r(t),a.d(t,{extractFrmPageDL:function(){return r},getDL:function(){return i},evaluateDLPath:function(){return s}}),window.TRON=window.TRON||{},n=console.error,console.error=function(){if(arguments[0].indexOf("Incorrect TRON implementation: ⛔")>-1){var e=arguments[0].split("Incorrect TRON implementation: ⛔")[1],t={E001:"parameter is missing",E002:"value is incorrect",E003:"value is empty",E004:"does not exist"},a=Object.entries(t).find((([t,a])=>e.includes(a)))[0];window.adobeDataLayer=window.adobeDataLayer||[];let n=TRON.dataComponent;var o={"con >":"configurator","stock >":"stock locator","sales >":"sales","fin >":"finance","rent >":"rental"},r=void 0!==o[TRON.prefix]?o[TRON.prefix]:n[0].category.primaryCategory;if(""==r||"shared > "==TRON.prefix||"local > "==TRON.prefix){var i=[".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"],s=i.some((e=>window.location.href.includes(e)));if(s)if([".bmw.com"].some((e=>window.location.href.includes(e)))){var c=window.location.pathname.split("/");void 0!==c[1]&&"nsc website"==(r=c[1].indexOf("-")>-1?"nsc website":"special website")&&(TRON.prefix="nsc > ")}else r="special website",TRON.prefix="special > ";else r="special website",TRON.prefix="special > "}n[0].category.primaryCategory=r;let g=n[0].componentInfo.componentID,p={};p[g]=n[0],window.adobeDataLayer.push({component:p,version:TRON.version}),window.adobeDataLayer.push({event:"tron event",eventInfo:{cause:"TRON implementation > "+((TRON||"").currentEventName||""),effect:TRON.prefix+e,eventAction:"trigger tron function",eventName:"error",eventPoints:0,timeStamp:(new Date).getTime(),type:"frontend component",category:{primaryCategory:(TRON||"").componentName||"",subCategory1:a,subCategory2:"TRON library"},reference:{linkedComponent:g}}})}n.apply(this,arguments)};const o={customeEventName:"TRON: enhanced activity map",libraryName:"enhanced activity map",libraryVersion:"_v3.1.12",prefix:"nsc > ",pageExist:!0};function r(){try{var e,t=window.digitals2&&window.digitals2.tracking&&window.digitals2.tracking.api;if(void 0!==t){for(var a=t.getCurrentPageIndex(),n=a;n>0;n--)if("object"==typeof t.getPageObject(n).page&&"VCO"==t.getPageObject(n).page.category.primaryCategory){a=n;break}if(void 0!==(e=t.getPageObject(a)).pageInstanceId&&""!=e.pageInstanceId&&-1==e.pageInstanceId.indexOf("need-analyzer"))return e;if(void 0!==e.component&&e&&e.component[0]&&e.component[0].category&&"stock locator"==e.component[0].category.subCategory01)return e;if(void 0!==e.component&&e&&e.component[0]&&e.component[0].componentInfo&&"digital checkout solution"==e.component[0].componentInfo.componentName)return e;if(void 0!==e.pageInstanceId&&""!=e.pageInstanceId&&e.product.length>0)return e;if(void 0!==e.pageInstanceId&&""!=e.pageInstanceId)return a&&a>0?t.getPageObject(a):t.getPageObject(0)}else if("undefined"!=typeof BMWdataLayer)e=JSON.parse(JSON.stringify(BMWdataLayer));else if("undefined"!=typeof mnm&&""!=((((mnm||"").mnmnsc||"").page||"").currentPage||"")&&void 0!==mnm.mnmnsc.page.currentPage.getTrackingService)e=mnm.mnmnsc.page.currentPage.getTrackingService().getDigitalData();else if("undefined"!=typeof datalayer_localForms){var o=(datalayer_localForms||"").event||[];e=o.length>0?o[o.length-1]:""}else if(window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&void 0===window.digitalData&&window.dataLayer){var r=(c=digital.tracking.getInstance(window.dataLayer)).getCurrentPageIndex()||0,i=c.getPageObject(r);e=JSON.parse(JSON.stringify(i))}else if(void 0!==window.h5vco&&""!=((window.h5vco||"").digitalData||""))e=window.h5vco.digitalData;else if(void 0!==window.dcsDataLayer&&""!=((window.dcsDataLayer||"").pages||"")){var s=window.dcsDataLayer.activePageIndex||0;e=window.dcsDataLayer.pages[s]}else if(void 0!==window.dataLayer&&void 0!==window.dataLayer.activePageIndex)s=window.dataLayer.activePageIndex||0,e=""!=((window.dataLayer||"").pages||"")&&window.dataLayer.pages.length>0?window.dataLayer.pages[s]:window.dataLayer;else if(void 0!==window.digitalData)e=JSON.parse(JSON.stringify(window.digitalData));else if(window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&void 0===window.dataLayer){var c;r=(c=digital.tracking.getInstance()).getCurrentPageIndex()||0,i=c.getPageObject(r),e=JSON.parse(JSON.stringify(i))}return e}catch(e){console.error(e,"datalayer not found")}}function i(e,t){try{for(var a=(e=e||"").split("."),n=r(),o=0;o<a.length&&null!=n;o++)null!=a[o]&&""!=a[o]&&(n=Array.isArray(n)&&/-[0-9]+/.test(a[o])?n[n.length-Math.abs(parseInt(a[o]))]:n[a[o]]);return"string"==typeof n&&["","na","not set","n/a","not available","not yet available","not selected","unknown"].indexOf(n.toLowerCase())>-1?t:n||t||""}catch(e){console.error("Error:datalayer fetch-",e)}}function s(e){return""!=i(e)?i(e):""}t.default=class{constructor(){this.detectDebugMode(),this._TronVersion="3.3.2";const e=function(e){e.component={category:{componentType:"native in-page",primaryCategory:"nsc website",subCategory1:"navigation"},componentInfo:{componentName:"enhanced activity map",componentID:"enhanced activity map"},attributes:{touchpoint:"web"}},e.baseEvent={eventInfo:{cause:"default",effect:"na",eventAction:"internal click",eventName:"interaction",eventPoints:0,type:"ux"},category:{subCategory1:"",subCategory2:""},attributes:{requestedURL:""}},e.page={category:{primaryCategory:"",subCategory1:"",subCategory2:"",subCategory3:"",pageType:"tbd"},pageInfo:{pageID:"",pageName:"tbd",author:"",destinationURL:"",referringURL:"",sysEnv:"",variant:"tbd",version:"",language:"",geoRegion:""},attributes:{brand:"",timeZone:""}},e.baseCustom={componentVersion:""},e.baseMandatoryData=[],e.baseOptionalData=["componentDEVagency","componentPlatform"],e.allowedcomponentPlatform=["aem > central","aem > local","non-aem > central","non-aem > local"]},t=function(e){e.events||(e.events={}),e.events=Object.assign(e.events,{})},a=function(e){e.defaultDatalayer={component:[{category:{},componentInfo:{},attributes:{}}],event:[{category:{},eventInfo:{},attributes:{form:{},search:[],media:{}}}],custom:{},page:{category:{},pageInfo:{},attributes:{}},product:[{category:{},productInfo:{},attributes:{}}],cart:{item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}],price:{}},transaction:{total:{attributes:{}},item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}]},user:[{segment:{},profile:[{profileInfo:{},attributes:{}}]}],dealer:[{dealerInfo:{},attributes:{}}],version:e.version},e.events||(e.events={}),e.events.error={event:{eventInfo:{eventName:"error",type:"",eventAction:"internal click",eventPoints:"0",cause:"default",effect:"na"}},custom:{errorCode:"",errorOrigin:"",errorURL:document.location.href},mandatoryData:e.baseMandatoryData.concat(["errorAction","errorMessage","errorCause","errorType","errorCode","errorOrigin"]).filter((e=>!["videoCurrentTime","videoName","videoTotalLength"].includes(e))),optionalData:["errorURL"],description:"Trigger this event whenever an error occurs that prevents the user from continuing with its journey. \n                <br> In case the 'errorAction' = \"component load\" only the error related parameters are mandatory:'errorMessage', 'errorCause', 'errorType', 'errorCode', 'errorOrigin', 'errorAction'.\n                <br> For any other errorAction all mandatory parameters (eg. vehicle, dealer, form etc) specific to this project must be sent along with the error parameters."},e.events=Object.assign(e.events,{activityMapClick:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(e.baseEvent.eventInfo)),{effect:"user clicked on an on page navigation element"})},mandatoryData:[],optionalData:["componentVersion"],description:"Trigger this event whenever the user clicks on a navigation item that does not navigate the user to a new page and hence triggers a server call.\n      <br> This is used for pure non-contextual (without vehicle, dealer, form etc context) click tracking."}}),e._validErrorTypes=["backend 1st party","backend 3rd party","frontend component","frontend page","user","product data","emission service","web links"],e._validErrorActions=["call","component load","content closed","content opened","content visible","download","drop-down menu","first page load","form fill","internal click","outbound click","page load","radio button","slide left","slide right","sort","suggested term","video pause","video play"],e.defaultValue=""};(function(e){e.genericEventName="TRON: adobeDataLayer generic event listener",e.customEventName=o.customeEventName,e._componentTrackingVersion=o.libraryName+""+o.libraryVersion,e.version=`TRON_${e._TronVersion}__${e._componentTrackingVersion}`})(this),e(this),a(this),t(this),this._createPublicMethods(),this.message={}}getSupportedEvents(){var e={};for(const d in this.events){var t=JSON.parse(JSON.stringify(this.events[d].mandatoryData)),a=JSON.parse(JSON.stringify(this.events[d].optionalData)),n=Object.keys(this).map((e=>e.toLowerCase())),o=[t.sort(),a.sort()];for(var r in o)for(var i in o[r]){var s=o[r][i];s=s.indexOf("[n].")>-1?s.replace("[n].",""):s;var c=n.filter((e=>e.includes(s.toLowerCase())));if("string"==typeof s&&1==c.length&&Array.isArray(this[Object.keys(this)[n.indexOf(c[0])]])){var g=this[Object.keys(this)[n.indexOf(c[0])]],p="Possible Options: "+(g=g.filter((function(e){return""!==e}))).join(", ").toString();o[r][i]='<span style="color: #1000ff;font-weight: bold;" title="'+p+'">'+o[r][i]+"</span>"}}e[d]={description:this.events[d].description,"mandatory parameters":o[0].join(", <br>").toString(),"optional parameters":o[1].join(", <br>").toString()}}return e}setDebug(e){if("boolean"!=typeof e)return!1;this.debug=e}detectDebugMode(){let e;null!=sessionStorage.getItem("tronDebug")&&(e="true"===sessionStorage.getItem("tronDebug")),-1!=document.location.search.indexOf("trondebug")&&(e=-1!=document.location.search.indexOf("trondebug"),sessionStorage.setItem("tronDebug",e)),this.setDebug(e)}_createPublicMethods(e){for(const e in this.events)this[e]=function(e){return function(t){this._processEvent(`${e}`,t)}}(e)}flattenObject(e){var t={};for(var a in e)if(e.hasOwnProperty(a))if("object"==typeof e[a]&&null!==e[a]){var n=this.flattenObject(e[a]);for(var o in n)n.hasOwnProperty(o)&&(t[a+"."+o]=n[o])}else t[a]=e[a];return t}_checkParamsPassed(e,t){t=this.flattenObject(t),t=(t=Object.keys(t)).map((function(e){return e.replace(/(.)(\d+)(.)/,"[n].")}));var a=[];for(var n in this.events)a.push.apply(a,this.events[n].mandatoryData),a.push.apply(a,this.events[n].optionalData);for(var n in a=a.filter(((e,t,a)=>a.indexOf(e)===t)),t)a.indexOf(t[n])<0&&console.warn("Incorrect TRON implementation: ⚠️ Parameter "+t[n]+" not defined, hence this data cannot be tracked")}_processEvent(e,t){void 0===t&&(t={}),TRON.currentEventName=e,TRON.prefix=o.prefix,TRON.componentName=o.libraryName,TRON.version=this.version,TRON.dataComponent=[{category:{componentType:this.component.category.componentType||"",primaryCategory:this.component.category.primaryCategory||"",subCategory1:this.component.category.subCategory1||""},componentInfo:{componentName:TRON.componentName,componentID:(s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("bmw-motorrad")>-1?"bmw-motorrad":""))+"/"+(window.location.href.split("country=").length>1?window.location.href.split("country=")[1].split("&")[0]:window.location.href.split("country=").length>1?window.location.href.split("country_origin=")[1].split("&")[0]:s("page.pageInfo.geoRegion")||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[1]:window.location.host.indexOf("bmwusa")>-1?"US":""))+"_"+(s("page.pageInfo.language").slice(0,2)||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":""))+"/"+TRON.componentName},attributes:{touchpoint:this.component.attributes.touchpoint||""}}];var a=JSON.parse(JSON.stringify(t));this._debug("💡 event triggered:"+e,a),this._checkParamsPassed(e,a),this.message=this._loadEventData(e,t);try{this._checkmandatoryData(e,t),this.events[e].optionalData&&this._checkOptionalData(e,t)}catch(t){return this._throwError("wrong mandatoryData input for function "+e,t),!1}var n=o.prefix;if(t&&t.componentType){let a=t.componentType;if(!this.allowedComponentTypes.includes(a)){if(this.events[e].mandatoryData.indexOf("componentType")>-1)return console.error("Incorrect TRON implementation: ⛔ componentType value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentTypes.join(", ").toString()),void this._throwError("componentType value is incorrect. Pick a standard value : "+this.allowedComponentTypes.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: ⚠️ componentType value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentTypes.join(", ").toString()),t.componentType=""}}if(t&&t.componentName){let a=t.componentName;if(!this.allowedComponentNames.includes(a)){if(this.events[e].mandatoryData.indexOf("componentName")>-1)return console.error("Incorrect TRON implementation: ⛔ componentName value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentNames.join(", ").toString()),void this._throwError("componentName value is incorrect. Pick a standard value : "+this.allowedComponentNames.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: ⚠️ componentName value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentNames.join(", ").toString()),t.componentName=""}}if(t&&t.componentSubCat1){let a=t.componentSubCat1;if(!this.allowedComponentSubCat1.includes(a)){if(this.events[e].mandatoryData.indexOf("componentSubCat1")>-1)return console.error("Incorrect TRON implementation: ⛔ componentSubCat1 value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentSubCat1.join(", ").toString()),void this._throwError("componentSubCat1 value is incorrect. Pick a standard value : "+this.allowedComponentSubCat1.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: ⚠️ componentSubCat1 value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentSubCat1.join(", ").toString()),t.componentSubCat1=""}}if(t&&t.componentPlatform){let a=t.componentPlatform;if(!this.allowedcomponentPlatform.includes(a)){if(this.events[e].mandatoryData.indexOf("componentPlatform")>-1)return console.error("Incorrect TRON implementation: ⛔ componentPlatform value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedcomponentPlatform.join(", ").toString()),void this._throwError("componentPlatform value is incorrect. Pick a standard value : "+this.allowedcomponentPlatform.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: ⚠️ componentPlatform value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedcomponentPlatform.join(", ").toString()),t.componentPlatform=""}}void 0!==t&&(t.componentVersion&&(this.message.component[0].attributes.componentVersion=t.componentVersion),this.message.component[0].category.componentType=t.componentType||this.component.category.componentType,this.message.component[0].category.subCategory1=t.componentSubCat1||this.component.category.subCategory1,this.message.component[0].componentInfo.componentName=t.componentName||((this.component||"").componentInfo||"").componentName||"",delete this.message.custom.componentVersion),void 0!==t.componentDEVagency&&(this.message.component[0].attributes.componentDEVagency=t.componentDEVagency),void 0!==t.componentPlatform&&(this.message.component[0].attributes.platform=t.componentPlatform);var r={"con >":"configurator","stock >":"stock locator","sales >":"sales","fin >":"finance","rent >":"rental"},c=void 0!==r[n]?r[n]:this.message.component[0].category.primaryCategory;if(""==c||"shared > "==n||"local > "==n)if([".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"].some((e=>window.location.href.includes(e))))if([".bmw.com"].some((e=>window.location.href.includes(e)))){var g=window.location.pathname.split("/");void 0!==g[1]&&"nsc website"==(c=g[1].indexOf("-")>-1?"nsc website":"special website")&&(n="nsc > ")}else c="special website",n="special > ";else c="special website",n="special > ";if(this.message.component[0].category.primaryCategory=c,void 0!==t&&t.componentVersion&&(this.message.component[0].attributes.componentVersion=t.componentVersion,this.message.event[0].category.primaryCategory=t.componentName||this.message.component[0].componentInfo.componentName),void 0!==t&&(this.message.component[0].componentInfo.componentID=t.pageBrand||s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("motorrad")>-1?"motorrad":""),this.message.component[0].componentInfo.componentID+=" > "+(t.pageGeoRegion||s("page.pageInfo.geoRegion")||""),this.message.component[0].componentInfo.componentID+=" > "+(t.componentName||this.message.component[0].componentInfo.componentName),"form"==this.message.event[0].eventInfo.eventName&&(this.message.component[0].componentInfo.componentID+=" "+t.formType)),void 0!==this.message.event[0].eventInfo.effect&&(this.message.event[0].eventInfo.effect=n+this.message.event[0].eventInfo.effect,this.message.event[0].eventInfo.timeStamp=this.message.event[0].timeStamp,delete this.message.event[0].timeStamp),("page view"!=this.message.event[0].eventInfo.eventName||"aem page loaded"!=(((window.adobeDataLayer||"")[0]||"").event||""))&&void 0!==i("page")&&"string"!=typeof i("page")){var p=JSON.parse(JSON.stringify(s("page.attributes")))||{};p.brand=s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("bmw-motorrad")>-1?"bmw-motorrad":""),p.pageTitle=s("page.title")||s("page.pageInfo.pageTitle")||document.title,p.timeZone=s("page.attributes.timeZone")||"",this.message.page={attributes:JSON.parse(JSON.stringify(p)),category:{pageType:s("page.category.pageType")||s("page.category.formType")||s("page.category.primaryTags"),primaryCategory:"NBC"==s("page.attributes.template")?"configurator":"object"==typeof s("page.category.primaryTags")?s("page.category.primaryTags.0"):s("page.pageHier")||s("page.category.subCategory01")||s("page.category.primaryCategory")||s("page.primarySection")||s("page.category.primaryTags")||"homepage",subCategory1:"object"==typeof s("page.category.secondaryTags")?s("page.category.secondaryTags.0"):s("page.pageLevel2")||s("page.category.subCategory01")||s("page.category.purchaseReason")||s("page.category.subCategory1")||"content",subCategory2:s("page.pageLevel3")||s("page.category.subCategory02")||s("page.category.subCategory2"),subCategory3:s("page.pageLevel4")||s("page.category.subCategory03")||s("page.category.subCategory3")},pageInfo:{author:s("page.pageInfo.author"),destinationURL:s("page.url")||s("page.pageInfo.destinationUrl")||s("page.pageInfo.destinationURL"),geoRegion:window.location.href.split("country=").length>1?window.location.href.split("country=")[1].split("&")[0]:window.location.href.split("country=").length>1?window.location.href.split("country_origin=")[1].split("&")[0]:s("page.pageInfo.geoRegion")||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[1]:window.location.host.indexOf("bmwusa")>-1?"US":""),language:s("page.pageInfo.language").slice(0,2)||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":""),pageID:s("page.path")||s("page.name")||s("page.pageInfo.pageInstanceId")||window.dataLayer&&window.dataLayer.pages&&(window.dataLayer.pages[0]||"").pageInstanceId||s("page.pageInfo.pageID"),pageName:s("page.name")||s("page.pageInfo.pageName"),referringURL:s("page.pageInfo.referringUrl")||s("page.pageInfo.referringURL")||document.referrer,sysEnv:s("page.pageInfo.devEnv")||s("page.pageInfo.envWork")||s("page.pageInfo.sysEnv"),variant:s("page.pageInfo.variant")||"true"==s("page.attributes.virtualPage")?"virtual page":"real page",version:"acdl: "+s("page.pageInfo.version")}}}void 0!==t&&void 0===t.vehicle&&"error"!=t.eventName&&void 0!==i("product")&&"string"!=typeof i("product")&&(this.message.product=i("product")),void 0!==i("user")&&"string"!=typeof i("user")&&(this.message.user=i("user")),void 0!==t&&void 0===t.dealer&&void 0!==i("dealer")&&"string"!=typeof i("dealer")&&(this.message.dealer=i("dealer")),void 0!==this.message.custom&&"error"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].eventInfo.effect=t.errorMessage?n+t.errorMessage:"",this.message.event[0].eventInfo.eventAction=t.errorAction,this.message.event[0].eventInfo.cause=t.errorCause,this.message.event[0].eventInfo.type=t.errorType,this.message.event[0].category.primaryCategory=t.componentName||this.message.component[0].componentInfo.componentName,this.message.event[0].category.subCategory1=t.errorCode,this.message.event[0].category.subCategory2=t.errorOrigin,this.message.event[0].attributes.requestedURL=t.errorURL,delete this.message.event[0].type,delete this.message.event[0].action,delete this.message.event[0].cause,delete this.message.event[0].effect),this.message.component[0].componentInfo.componentID=this.message.page.attributes.brand+"/"+this.message.page.pageInfo.geoRegion+"_"+this.message.page.pageInfo.language+"/"+this.message.component[0].componentInfo.componentName,this.message.page.pageInfo.pageID="/"+this.message.page.category.pageType+"/"+this.message.page.attributes.brand+"/"+this.message.page.pageInfo.geoRegion+"/"+this.message.page.pageInfo.language+"/"+this.message.page.category.primaryCategory+"/",void 0!==this.message.page.category.subCategory1&&""!=this.message.page.category.subCategory1&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory1+"/"),void 0!==this.message.page.category.subCategory2&&""!=this.message.page.category.subCategory2&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory2+"/"),void 0!==this.message.page.category.subCategory3&&""!=this.message.page.category.subCategory3&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory3+"/"),this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+(this.message.page.pageInfo.pageName.split(" > ").length>0&&this.message.page.pageInfo.pageName.split(" > ")[1]||this.message.page.pageInfo.pageName),this._debug("💲 payload created",this.message),this._sendMessage()}_checkmandatoryData(e,t){let a,n=this.events[e].mandatoryData,o=!0,r="";for(let e=0;e<n.length;e++){let i,s=n[e];if(s.indexOf("[n]")>-1){let e=s.split("[n]");r=e[1].replace(".",""),i=t[e[0]]&&t[e[0]][0][r]}else i=t[s];if(void 0===i)switch(s){case"componentType":i=this.component.category.componentType;break;case"componentName":i=this.component.componentInfo.componentName;break;case"componentSubCat1":i=this.component.category.subCategory01}a=this._checkValidValue("mandatory",s,r,i),0==a&&(o=!1)}if(0==o)throw new SyntaxError(`value does not match expected values: ${o}`);return!0}_checkOptionalData(e,t){let a,n=this.events[e].optionalData,o=!0,r="";for(let e=0;e<n.length;e++){let i,s=n[e];if(s.indexOf("[n]")>-1){let e=s.split("[n]");t[e[0]]&&t[e[0]].length>0&&(r=e[1].replace(".",""),i=t[e[0]][0][r],i&&""==i&&errArrayVal.push(s))}else i=t[s];void 0===i&&void 0===t[s]||(a=this._checkValidValue("optional",s,r,i),0==a&&(s.indexOf("[n]")>-1?t[s.split("[n]")[0]][0][s.split("[n]")[1].replace(".","")]="":t[s]="",o=!1))}return!0}_checkValidValue(e,t,a,n){let o=!0,r=Object.keys(this).map((e=>e.toLowerCase()));a=""!=a&&t.indexOf("[n]")>-1?t.replace("[n].",""):t;let i=r.filter((e=>e.includes(a.toLowerCase()))),s="object"==typeof this[Object.keys(this)[r.indexOf(i[0])]]?this[Object.keys(this)[r.indexOf(i[0])]]:[];if(s=s.filter((function(e){return""!==e})),void 0===(n="string"==typeof n?(n||"").toLowerCase():n)&&"mandatory"==e&&(console.error("Incorrect TRON implementation: ⛔ mandatory parameter is missing, hence this event cannot be tracked. Please provide the parameter: "+t),o=!1),"string"==typeof n&&0==n.trim().length&&"mandatory"==e&&(console.error("Incorrect TRON implementation: ⛔ "+t+" value is empty, hence this event cannot be tracked. Please provide a valid value: "+s.join(", ").toString()),o=!1),Array.isArray(s)&&s.length>0&&!s.includes(n)){if(t.indexOf("vehicle")>-1&&(t=t.split(".")[1],["codeAG","codeVG","range","rangeVG"].indexOf(t)>-1))return!0;if(["formLeadType","formComChannel","dealer[n].selectionState","options[n].code","options[n].codeVG","options[n].category1"].indexOf(t)>-1&&void 0!==n)return!0;if(1==s.length&&"value should be numeric"==s[0])return!0;"mandatory"==e?(console.error("Incorrect TRON implementation: ⛔ "+t+" value is incorrect, hence this event cannot be tracked. Pick a standard value: "+s.join(", ").toString()),o=!1):"optional"==e&&(console.warn("Incorrect TRON implementation: ⚠️ "+t+" value is incorrect and won't be passed to the web tracking tool. Pick a standard value: "+s.join(", ").toString()),o=!1)}return o}_checkValidOption(e,t){let a=[];switch(e){case"errorType":a=this._validErrorTypes;break;case"errorAction":a=this._validErrorActions}if(!a.includes(t))throw new TypeError(`provided value '${t}' for field '${e}' is not part of standard list`);return!0}_loadEventData(e,t){const a=Object.assign({},JSON.parse(JSON.stringify(this.defaultDatalayer)));a.component[0]=Object.assign({},JSON.parse(JSON.stringify(this.component)));const n=JSON.parse(JSON.stringify(this.defaultDatalayer.event[0])),r=JSON.parse(JSON.stringify(this.baseEvent)),i=JSON.parse(JSON.stringify(this.events[e].event));a.event[0]=[n,r,i].reduce(this._deepMerge.bind(this),{}),a.event[0].timeStamp=(new Date).getTime(),o.pageExist&&void 0!==a.page&&(this.events[e].page?a.page=Object.assign({},JSON.parse(JSON.stringify(this.page)),JSON.parse(JSON.stringify(this.events[e].page))):a.page=Object.assign({},JSON.parse(JSON.stringify(this.page)))),o.projConditionCheck&&o.projectCondition(this,e,t),this.events[e].custom=this.events[e].custom?this.events[e].custom:{};const s=JSON.parse(JSON.stringify(this.baseCustom)),c=JSON.parse(JSON.stringify(this.events[e].custom));return a.custom=[s,c].reduce(this._deepMerge.bind(this),{}),a.version="tron_"+this._TronVersion+"__"+this._componentTrackingVersion,a}_throwError(e,t){e.indexOf("value does not match")>-1||e.indexOf("input for function")>-1||e.indexOf("in mandatoryData")>-1||e.indexOf("could not create/send")>-1||e.indexOf("incorrect")>-1||e.indexOf("SyntaxError: value does not match expected values")>-1?console.error(this.version):console.error("Incorrect TRON implementation: ⛔ ",this.version,"\r\n",e,"\r\n",t.name+":"+t.message)}_debug(e,t){this.debug&&console.info(this.version,"\r\n",e,"\r\n",t)}_sendMessage(){this._debug("⌛ sending data..."),this._sendCustomEvent(),this._sendGenericEvent(),this._sendPostMessage(),this.message={}}_sendCustomEvent(){let e=!1;try{e=new CustomEvent(this.customEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(e)}catch(e){return console.error("Incorrect TRON implementation: ⛔ custom event created was not sent, hence this event cannot be tracked. Please check the error:",e),this._throwError("could not create/send custom event",e),!1}this._debug("✅ custom event successfully sent",e)}_sendGenericEvent(){let e=!1;try{e=new CustomEvent(this.genericEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(e)}catch(e){return console.error("Incorrect TRON implementation: ⛔ custom event created was not sent, hence this event cannot be tracked. Please check the error:",e),this._throwError("could not create/send generic event",e),!1}this._debug("✅ generic event successfully sent",e)}_sendPostMessage(){let e=!1;try{e=JSON.parse(JSON.stringify({methodName:"TRON: postMessage",detail:this.message,type:"TRON: generic iframe event listener"})),window.top.postMessage(JSON.stringify(e),"*")}catch(e){return console.error("Incorrect TRON implementation: ⛔ custom event created was not sent, hence this event cannot be tracked. Please check the error:",e),this._throwError("could not create/send postMessage",e),!1}this._debug("✅ postmessage successful sent",e)}_deepMerge(e,t){return Object.entries(t).forEach((([t,a])=>{a&&"object"==typeof a?this._deepMerge(e[t]=e[t]||{},a):e[t]=a})),e}},window.onerror=function(){if(arguments.length>0&&"string"==typeof arguments[0]&&arguments[0].indexOf("Uncaught TypeError: ")>-1&&arguments[0].indexOf("not a function")>-1){var e=arguments[0].split("Uncaught TypeError: ")[1].split("is not a function")[0];return console.error("Incorrect TRON implementation: ⛔ this function "+e+" does not exist , hence this event cannot be tracked. Please make sure to use a correct reference name!","\n","Error Occured at:",arguments),!0}return!1},TRON.isInitialized||(window.addEventListener("TRON: adobeDataLayer generic event listener",(function(e){if(window.tronDetailDL=e.detail,window.adobeDataLayer=window.adobeDataLayer||[],tronDetailDL.page&&tronDetailDL.page.pageInfo&&void 0!==tronDetailDL.page.pageInfo.pageName&&"tbd"!=tronDetailDL.page.pageInfo.pageName&&window.adobeDataLayer.push({page:tronDetailDL.page}),tronDetailDL.page&&tronDetailDL.page.pageInfo&&"tbd"==tronDetailDL.page.pageInfo.pageName&&void 0!==i("page")&&"string"!=typeof i("page")){var t=JSON.parse(JSON.stringify(s("page.attributes")))||{};t.brand=s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("bmw-motorrad")>-1?"bmw-motorrad":""),t.pageTitle=s("page.title")||s("page.pageInfo.pageTitle")||document.title,t.timeZone=s("page.attributes.timeZone")||"";var a={page:{attributes:JSON.parse(JSON.stringify(t)),category:{pageType:s("page.category.pageType")||s("page.category.formType")||s("page.category.primaryTags"),primaryCategory:"NBC"==s("page.attributes.template")?"configurator":"object"==typeof s("page.category.primaryTags")?s("page.category.primaryTags.0"):s("page.pageHier")||s("page.category.subCategory01")||s("page.category.primaryCategory")||s("page.primarySection")||s("page.category.primaryTags")||"homepage",subCategory1:"object"==typeof s("page.category.secondaryTags")?s("page.category.secondaryTags.0"):s("page.pageLevel2")||s("page.category.subCategory01")||s("page.category.purchaseReason")||s("page.category.subCategory1")||"content",subCategory2:s("page.pageLevel3")||s("page.category.subCategory02")||s("page.category.subCategory2"),subCategory3:s("page.pageLevel4")||s("page.category.subCategory03")||s("page.category.subCategory3")},pageInfo:{author:s("page.pageInfo.author"),destinationURL:s("page.url")||s("page.pageInfo.destinationUrl")||s("page.pageInfo.destinationURL"),geoRegion:window.location.href.split("country=").length>1?window.location.href.split("country=")[1].split("&")[0]:window.location.href.split("country=").length>1?window.location.href.split("country_origin=")[1].split("&")[0]:s("page.pageInfo.geoRegion")||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[1]:window.location.host.indexOf("bmwusa")>-1?"US":""),language:s("page.pageInfo.language").slice(0,2)||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":""),pageID:s("page.path")||s("page.name")||s("page.pageInfo.pageInstanceId")||window.dataLayer&&window.dataLayer.pages&&(window.dataLayer.pages[0]||"").pageInstanceId||s("page.pageInfo.pageID"),pageName:s("page.name")||s("page.pageInfo.pageName"),referringURL:s("page.pageInfo.referringUrl")||s("page.pageInfo.referringURL")||document.referrer,sysEnv:s("page.pageInfo.devEnv")||s("page.pageInfo.envWork")||s("page.pageInfo.sysEnv"),variant:s("page.pageInfo.variant")||"true"==s("page.attributes.virtualPage")?"virtual page":"real page",version:"acdl: "+s("page.pageInfo.version")}}};a.pageInfo.pageID="/"+a.category.pageType+"/"+a.attributes.brand+"/"+a.pageInfo.geoRegion+"/"+a.pageInfo.language+"/"+a.category.primaryCategory+"/"+a.category.subCategory1+"/"+a.category.subCategory2+"/"+a.category.subCategory3+"/"+(a.pageInfo.pageName.split(" > ").length>0&&a.pageInfo.pageName.split(" > ")[1]||a.pageInfo.pageName),window.adobeDataLayer.push(a)}let n={},o=tronDetailDL.component[0].componentInfo.componentID;n[o]=tronDetailDL.component[0],window.adobeDataLayer.push({component:n,version:tronDetailDL.version});var r={},c={},g=tronDetailDL.product;if(g.length>0&&"string"!=typeof g){for(var p in g){var d=g[p].productInfo.productID;void 0===d&&(d="product"+(p+1)),r[d]=g[p]}Object.keys(r).forEach((e=>c[e]="")),window.adobeDataLayer.push({product:r})}var l={},m=e.detail.cart;if(m&&m.item.length>0&&"string"!=typeof m){("commerce"!=tronDetailDL.event[0].eventInfo.eventName||"cart"!=tronDetailDL.event[0].eventInfo.type&&"checkout"!=tronDetailDL.event[0].eventInfo.type)&&""==(((e.detail||"").cart||"").cartID||"")||(l=Object.assign({},r));var f={item:l,price:e.detail.cart.price||{},cartID:e.detail.cart.cartID||""};window.adobeDataLayer.push({cart:f})}var u={},y=e.detail.transaction;if(y&&y.item.length>0&&"string"!=typeof y){("commerce"==tronDetailDL.event[0].eventInfo.eventName&&"order"==tronDetailDL.event[0].eventInfo.type||""!=(((e.detail||"").transaction||"").transactionID||""))&&(u=Object.assign({},r));var v={item:u,total:e.detail.transaction.total||{},transactionID:e.detail.transaction.transactionID||""};window.adobeDataLayer.push({transaction:v})}var h={},w={},b=tronDetailDL.dealer;if(b.length>0&&"string"!=typeof b){for(var p in b)h[b[p].dealerInfo.dealerOutletBuno]=b[p];Object.keys(h).forEach((e=>w[e]="")),window.adobeDataLayer.push({dealer:h})}if(tronDetailDL.user.length>0&&"string"!=typeof tronDetailDL.user){var I={},O=tronDetailDL.user;for(var p in O){var N={};if(Array.isArray(O[p].profile)&&O[p].profile.length>0)for(var D in O[p].profile)N[C=null!=O[p].profile[D].profileInfo.profileID?O[p].profile[D].profileInfo.profileID:"profile"+(D+1)]=JSON.parse(JSON.stringify(O[p].profile[D]));else if(void 0===O[p].profile&&void 0!==O[p].profileInfo&&!Array.isArray(O[p].profileInfo)){var C="profile"+(p+1);N.profile={},N.profile[C]=JSON.parse(JSON.stringify(O[p].profileInfo))}var T="user"+(p+1);I[T]=JSON.parse(JSON.stringify(O[p])),I[T].profile=JSON.parse(JSON.stringify(N))}tronDetailDL.user=JSON.parse(JSON.stringify(I)),window.adobeDataLayer.push({user:tronDetailDL.user})}var S={event:"page view"==tronDetailDL.event[0].eventInfo.eventName?"tron page view":"tron event",eventInfo:{cause:tronDetailDL.event[0].eventInfo.cause,effect:tronDetailDL.event[0].eventInfo.effect,eventAction:tronDetailDL.event[0].eventInfo.eventAction,eventName:tronDetailDL.event[0].eventInfo.eventName,eventPoints:tronDetailDL.event[0].eventInfo.eventPoints,timeStamp:tronDetailDL.event[0].eventInfo.timeStamp,type:tronDetailDL.event[0].eventInfo.type,category:tronDetailDL.event[0].category,attributes:tronDetailDL.event[0].attributes,reference:{linkedComponent:o,linkedProducts:c,linkedDealers:w}}};window.adobeDataLayer.push(S)})),TRON.isInitialized=!0)},266:function(e,t,a){var n,o;n=[t,a(924)],void 0===(o=function(e,a){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0;var o=(a=(n=a)&&n.__esModule?n:{default:n}).default;t.default=o}.apply(t,n))||(e.exports=o)}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}return a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(266)}()}));