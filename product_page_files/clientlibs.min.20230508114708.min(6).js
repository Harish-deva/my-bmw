define("ds2-content-navigation-tron-tracking",[],(function(){return function(){var e={579:function(e,t,a){"use strict";var o;a.r(t),a.d(t,{extractFrmPageDL:function(){return r},getDL:function(){return i},evaluateDLPath:function(){return s}}),window.TRON=window.TRON||{},o=console.error,console.error=function(){if(arguments[0].indexOf("Incorrect TRON implementation: â›”")>-1){var e=arguments[0].split("Incorrect TRON implementation: â›”")[1],t={E001:"parameter is missing",E002:"value is incorrect",E003:"value is empty",E004:"does not exist"},a=Object.entries(t).find((([t,a])=>e.includes(a)))[0];window.adobeDataLayer=window.adobeDataLayer||[];let o=TRON.dataComponent;var n={"con >":"configurator","stock >":"stock locator","sales >":"sales","fin >":"finance","rent >":"rental"},r=void 0!==n[TRON.prefix]?n[TRON.prefix]:o[0].category.primaryCategory;if(""==r||"shared > "==TRON.prefix||"local > "==TRON.prefix){var i=[".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"],s=i.some((e=>window.location.href.includes(e)));if(s)if([".bmw.com"].some((e=>window.location.href.includes(e)))){var c=window.location.pathname.split("/");void 0!==c[1]&&"nsc website"==(r=c[1].indexOf("-")>-1?"nsc website":"special website")&&(TRON.prefix="nsc > ")}else r="special website",TRON.prefix="special > ";else r="special website",TRON.prefix="special > "}o[0].category.primaryCategory=r;let l=o[0].componentInfo.componentID,g={};g[l]=o[0],window.adobeDataLayer.push({component:g,version:TRON.version}),window.adobeDataLayer.push({event:"tron event",eventInfo:{cause:"TRON implementation > "+((TRON||"").currentEventName||""),effect:TRON.prefix+e,eventAction:"trigger tron function",eventName:"error",eventPoints:0,timeStamp:(new Date).getTime(),type:"frontend component",category:{primaryCategory:(TRON||"").componentName||"",subCategory1:a,subCategory2:"TRON library"},reference:{linkedComponent:l}}})}o.apply(this,arguments)};const n={customeEventName:"TRON:anchor",libraryName:"anchor",libraryVersion:"_v4.1.10",prefix:"nsc > ",pageExist:!0};function r(){try{var e,t=window.digitals2&&window.digitals2.tracking&&window.digitals2.tracking.api;if(void 0!==t){for(var a=t.getCurrentPageIndex(),o=a;o>0;o--)if("object"==typeof t.getPageObject(o).page&&"VCO"==t.getPageObject(o).page.category.primaryCategory){a=o;break}if(void 0!==(e=t.getPageObject(a)).pageInstanceId&&""!=e.pageInstanceId&&-1==e.pageInstanceId.indexOf("need-analyzer"))return e;if(void 0!==e.component&&e&&e.component[0]&&e.component[0].category&&"stock locator"==e.component[0].category.subCategory01)return e;if(void 0!==e.component&&e&&e.component[0]&&e.component[0].componentInfo&&"digital checkout solution"==e.component[0].componentInfo.componentName)return e;if(void 0!==e.pageInstanceId&&""!=e.pageInstanceId&&e.product.length>0)return e;if(void 0!==e.pageInstanceId&&""!=e.pageInstanceId)return a&&a>0?t.getPageObject(a):t.getPageObject(0)}else if("undefined"!=typeof BMWdataLayer)e=JSON.parse(JSON.stringify(BMWdataLayer));else if("undefined"!=typeof mnm&&""!=((((mnm||"").mnmnsc||"").page||"").currentPage||"")&&void 0!==mnm.mnmnsc.page.currentPage.getTrackingService)e=mnm.mnmnsc.page.currentPage.getTrackingService().getDigitalData();else if("undefined"!=typeof datalayer_localForms){var n=(datalayer_localForms||"").event||[];e=n.length>0?n[n.length-1]:""}else if(window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&void 0===window.digitalData&&window.dataLayer){var r=(c=digital.tracking.getInstance(window.dataLayer)).getCurrentPageIndex()||0,i=c.getPageObject(r);e=JSON.parse(JSON.stringify(i))}else if(void 0!==window.h5vco&&""!=((window.h5vco||"").digitalData||""))e=window.h5vco.digitalData;else if(void 0!==window.dcsDataLayer&&""!=((window.dcsDataLayer||"").pages||"")){var s=window.dcsDataLayer.activePageIndex||0;e=window.dcsDataLayer.pages[s]}else if(void 0!==window.dataLayer&&void 0!==window.dataLayer.activePageIndex)s=window.dataLayer.activePageIndex||0,e=""!=((window.dataLayer||"").pages||"")&&window.dataLayer.pages.length>0?window.dataLayer.pages[s]:window.dataLayer;else if(void 0!==window.digitalData)e=JSON.parse(JSON.stringify(window.digitalData));else if(window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&void 0===window.dataLayer){var c;r=(c=digital.tracking.getInstance()).getCurrentPageIndex()||0,i=c.getPageObject(r),e=JSON.parse(JSON.stringify(i))}return e}catch(e){console.error(e,"datalayer not found")}}function i(e,t){try{for(var a=(e=e||"").split("."),o=r(),n=0;n<a.length&&null!=o;n++)null!=a[n]&&""!=a[n]&&(o=Array.isArray(o)&&/-[0-9]+/.test(a[n])?o[o.length-Math.abs(parseInt(a[n]))]:o[a[n]]);return"string"==typeof o&&["","na","not set","n/a","not available","not yet available","not selected","unknown"].indexOf(o.toLowerCase())>-1?t:o||t||""}catch(e){console.error("Error:datalayer fetch-",e)}}function s(e){return""!=i(e)?i(e):""}t.default=class{constructor(){this.detectDebugMode(),this._TronVersion="3.3.2";const e={library:function(e){e.genericEventName="TRON: adobeDataLayer generic event listener",e.customEventName=n.customeEventName,e._componentTrackingVersion=n.libraryName+""+n.libraryVersion,e.version=`TRON_${e._TronVersion}__${e._componentTrackingVersion}`},defaults:function(e){e.component={category:{componentType:"native in-page",primaryCategory:"nsc website",subCategory1:"navigation"},componentInfo:{componentName:"anchor",componentID:"anchor"},attributes:{touchpoint:"web"}},e.baseEvent={eventInfo:{cause:"default",effect:"na",eventAction:"internal click",eventName:"interaction",eventPoints:0,type:"ux"},category:{subCategory1:"",subCategory2:""},attributes:{requestedURL:""}},e.page={category:{primaryCategory:"",subCategory1:"",subCategory2:"",subCategory3:"",pageType:"tbd"},pageInfo:{pageID:"",pageName:"tbd",author:"",destinationURL:"",referringURL:"",sysEnv:"",variant:"tbd",version:"",language:"",geoRegion:""},attributes:{brand:"",timeZone:""}},e.baseCustom={},e.baseMandatoryData=["anchorName","hashName"],e.baseOptionalData=["componentDEVagency","componentPlatform","linkLocation","vehicle[n].bodyType","vehicle[n].businessDivision","vehicle[n].primaryCategory","vehicle[n].manufacturer","vehicle[n].name","vehicle[n].range","vehicle[n].productID"],e.allowedComponentTypes=["standalone","native in-page","standalone iframe","in-page iframe"],e.allowedcomponentPlatform=["aem > central","aem > local","non-aem > central","non-aem > local"];var t=void 0!==e?e:this;t.allowedVehicleBodyType=["ca","hb","ko","co","cp","li","mp","ro","sc","st","gf","hc","sh","to","gs","ga","x","xr","gt","gl","r","rs","rr","rt","9p","9s","9u","b","s","9t"],t.allowedVehicleBusinessDivision=["new vehicle","used vehicle","after sales","other"],t.allowedVehicleCategory1=["build to order","pre-order","build to stock","young used car","demonstration car","young used bike","demonstration bike"],t.allowedVehicleFuelType=["b","o","d","e","g","h","m","t","x","y","z"],t.allowedVehicleHybridVersion=["beve","erex","hybr","phev","nohy"],t.allowedVehiclePrimaryCategory=["new car","used car","used bike","new bike","rental bike","rental car","owned bike","owned car"],t.allowedVehicleSeries=["1","2","3","4","5","6","7","8","x","i","m","z","clubman","5-doors","3-doors","cabrio","countryman","ad","gs","he","lt","ms","na","sp"],t.allowedVehicleStatus=["available for sale","sold out","order confirmed","pre-order confirmed","contract concluded","vehicle delivered"],t.allowedVehiclecodeAG=["value should contain only 4 characters"],t.allowedVehiclecodeVG=["value should contain only 4 characters"],t.allowedVehiclerange=["value should contain only 3 characters"],t.allowedVehiclerangeVG=["value should contain only 3 characters OR 4 if the last is 'E'"],t.allowedVehicleItemBasePrice=["value should be numeric"],t.allowedVehicleItemDiscountAmount=["value should be numeric"],t.allowedVehicleItemDiscountPercent=["value should be numeric"],t.allowedVehicleItemPriceWithTax=["value should be numeric"],t.allowedVehicleItemQuantity=["value should be numeric"],t.allowedVehicleItemShippingCost=["value should be numeric"],t.allowedVehicleItemTaxAmount=["value should be numeric"],t.allowedVehicleItemTaxRate=["value should be numeric"],t.allowedTotalBasePrice=["value should be numeric"],t.allowedTotalDiscountAmount=["value should be numeric"],t.allowedTotalDiscountPercent=["value should be numeric"],t.allowedTotalFinalPrice=["value should be numeric"],t.allowedTotalPriceWithTax=["value should be numeric"],t.allowedTotalShippingCost=["value should be numeric"],t.allowedTotalTaxAmount=["value should be numeric"]},events:function(e){e.events||(e.events={}),e.events=Object.assign(e.events,{anchorClick:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(e.baseEvent.eventInfo)),{eventAction:"internal click"})},mandatoryData:e.baseMandatoryData.concat([]),optionalData:e.baseOptionalData.concat([]),description:'trigger whenever the user <span style="color:blue">clicks</span> on the navigation. <br>\n        Please provide the following dynamic parameters.<br>\n        <ul>\n            <li>"<span style="color:blue">anchorName</span>" = the name of the navigation link , that is the visible link text </li>\n            <li>"<span style="color:blue">hashName</span>" = the value provided in the href independent if it\'s actually currently in the URL or not. eg. if the user clicked on "Fahrzeugdesign" the URL hash would be "fahrzeug-design". When the user then scrolls to "Plug-in Hybride" the hashName must be "plug-in-hybrid" and not like still visible in the URL "fahrzeug-design" </li>\n        </ul>'},anchorScroll:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(e.baseEvent.eventInfo)),{eventAction:"scroll"})},mandatoryData:e.baseMandatoryData.concat([]),optionalData:e.baseOptionalData.concat([]),description:'trigger whenever the user <span style="color:blue">scrolls</span> down/up on the page and the highlighted navigation area changes. <br>\n        Please provide the following dynamic parameters.<br>\n        <ul>\n            <li>"<span style="color:blue">anchorName</span>" = the name of the navigation link , that is the visible link text </li>\n            <li>"<span style="color:blue">hashName</span>" = the value provided in the href independent if it\'s actually currently in the URL or not. eg. if the user clicked on "Fahrzeugdesign" the URL hash would be "fahrzeug-design". When the user then scrolls to "Plug-in Hybride" the hashName must be "plug-in-hybrid" and not like still visible in the URL "fahrzeug-design" </li>\n        </ul>    '}})},globalDefaults:function(e){e.defaultDatalayer={component:[{category:{},componentInfo:{},attributes:{}}],event:[{category:{},eventInfo:{},attributes:{form:{},search:[],media:{}}}],custom:{},page:{category:{},pageInfo:{},attributes:{}},product:[{category:{},productInfo:{},attributes:{}}],cart:{item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}],price:{}},transaction:{total:{attributes:{}},item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}]},user:[{segment:{},profile:[{profileInfo:{},attributes:{}}]}],dealer:[{dealerInfo:{},attributes:{}}],version:e.version},e.events||(e.events={}),e.events.error={event:{eventInfo:{eventName:"error",type:"",eventAction:"internal click",eventPoints:"0",cause:"default",effect:"na"}},custom:{errorCode:"",errorOrigin:"",errorURL:document.location.href},mandatoryData:e.baseMandatoryData.concat(["errorAction","errorMessage","errorCause","errorType","errorCode","errorOrigin"]).filter((e=>!["videoCurrentTime","videoName","videoTotalLength"].includes(e))),optionalData:["errorURL"],description:"Trigger this event whenever an error occurs that prevents the user from continuing with its journey. \n                <br> In case the 'errorAction' = \"component load\" only the error related parameters are mandatory:'errorMessage', 'errorCause', 'errorType', 'errorCode', 'errorOrigin', 'errorAction'.\n                <br> For any other errorAction all mandatory parameters (eg. vehicle, dealer, form etc) specific to this project must be sent along with the error parameters."},e.events=Object.assign(e.events,{activityMapClick:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(e.baseEvent.eventInfo)),{effect:"user clicked on an on page navigation element"})},mandatoryData:[],optionalData:["componentVersion"],description:"Trigger this event whenever the user clicks on a navigation item that does not navigate the user to a new page and hence triggers a server call.\n      <br> This is used for pure non-contextual (without vehicle, dealer, form etc context) click tracking."}}),e._validErrorTypes=["backend 1st party","backend 3rd party","frontend component","frontend page","user","product data","emission service","web links"],e._validErrorActions=["call","component load","content closed","content opened","content visible","download","drop-down menu","first page load","form fill","internal click","outbound click","page load","radio button","slide left","slide right","sort","suggested term","video pause","video play"],e.defaultValue=""}};e.library(this),e.defaults(this),e.globalDefaults(this),e.events(this),this._createPublicMethods(),this.message={}}getSupportedEvents(){var e={};for(const p in this.events){var t=JSON.parse(JSON.stringify(this.events[p].mandatoryData)),a=JSON.parse(JSON.stringify(this.events[p].optionalData)),o=Object.keys(this).map((e=>e.toLowerCase())),n=[t.sort(),a.sort()];for(var r in n)for(var i in n[r]){var s=n[r][i];s=s.indexOf("[n].")>-1?s.replace("[n].",""):s;var c=o.filter((e=>e.includes(s.toLowerCase())));if("string"==typeof s&&1==c.length&&Array.isArray(this[Object.keys(this)[o.indexOf(c[0])]])){var l=this[Object.keys(this)[o.indexOf(c[0])]],g="Possible Options: "+(l=l.filter((function(e){return""!==e}))).join(", ").toString();n[r][i]='<span style="color: #1000ff;font-weight: bold;" title="'+g+'">'+n[r][i]+"</span>"}}e[p]={description:this.events[p].description,"mandatory parameters":n[0].join(", <br>").toString(),"optional parameters":n[1].join(", <br>").toString()}}return e}setDebug(e){if("boolean"!=typeof e)return!1;this.debug=e}detectDebugMode(){let e;null!=sessionStorage.getItem("tronDebug")&&(e="true"===sessionStorage.getItem("tronDebug")),-1!=document.location.search.indexOf("trondebug")&&(e=-1!=document.location.search.indexOf("trondebug"),sessionStorage.setItem("tronDebug",e)),this.setDebug(e)}_createPublicMethods(e){for(const e in this.events)this[e]=function(e){return function(t){this._processEvent(`${e}`,t)}}(e)}flattenObject(e){var t={};for(var a in e)if(e.hasOwnProperty(a))if("object"==typeof e[a]&&null!==e[a]){var o=this.flattenObject(e[a]);for(var n in o)o.hasOwnProperty(n)&&(t[a+"."+n]=o[n])}else t[a]=e[a];return t}_checkParamsPassed(e,t){t=this.flattenObject(t),t=(t=Object.keys(t)).map((function(e){return e.replace(/(.)(\d+)(.)/,"[n].")}));var a=[];for(var o in this.events)a.push.apply(a,this.events[o].mandatoryData),a.push.apply(a,this.events[o].optionalData);for(var o in a=a.filter(((e,t,a)=>a.indexOf(e)===t)),t)a.indexOf(t[o])<0&&console.warn("Incorrect TRON implementation: âš ï¸ Parameter "+t[o]+" not defined, hence this data cannot be tracked")}_processEvent(e,t){void 0===t&&(t={}),TRON.currentEventName=e,TRON.prefix=n.prefix,TRON.componentName=n.libraryName,TRON.version=this.version,TRON.dataComponent=[{category:{componentType:this.component.category.componentType||"",primaryCategory:this.component.category.primaryCategory||"",subCategory1:this.component.category.subCategory1||""},componentInfo:{componentName:TRON.componentName,componentID:(s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("bmw-motorrad")>-1?"bmw-motorrad":""))+"/"+(window.location.href.split("country=").length>1?window.location.href.split("country=")[1].split("&")[0]:window.location.href.split("country=").length>1?window.location.href.split("country_origin=")[1].split("&")[0]:s("page.pageInfo.geoRegion")||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[1]:window.location.host.indexOf("bmwusa")>-1?"US":""))+"_"+(s("page.pageInfo.language").slice(0,2)||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":""))+"/"+TRON.componentName},attributes:{touchpoint:this.component.attributes.touchpoint||""}}];var a=JSON.parse(JSON.stringify(t));this._debug("ðŸ’¡ event triggered:"+e,a),this._checkParamsPassed(e,a),this.message=this._loadEventData(e,t);try{this._checkmandatoryData(e,t),this.events[e].optionalData&&this._checkOptionalData(e,t)}catch(t){return this._throwError("wrong mandatoryData input for function "+e,t),!1}var o=n.prefix;if(t&&t.componentType){let a=t.componentType;if(!this.allowedComponentTypes.includes(a)){if(this.events[e].mandatoryData.indexOf("componentType")>-1)return console.error("Incorrect TRON implementation: â›” componentType value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentTypes.join(", ").toString()),void this._throwError("componentType value is incorrect. Pick a standard value : "+this.allowedComponentTypes.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: âš ï¸ componentType value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentTypes.join(", ").toString()),t.componentType=""}}if(t&&t.componentName){let a=t.componentName;if(!this.allowedComponentNames.includes(a)){if(this.events[e].mandatoryData.indexOf("componentName")>-1)return console.error("Incorrect TRON implementation: â›” componentName value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentNames.join(", ").toString()),void this._throwError("componentName value is incorrect. Pick a standard value : "+this.allowedComponentNames.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: âš ï¸ componentName value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentNames.join(", ").toString()),t.componentName=""}}if(t&&t.componentSubCat1){let a=t.componentSubCat1;if(!this.allowedComponentSubCat1.includes(a)){if(this.events[e].mandatoryData.indexOf("componentSubCat1")>-1)return console.error("Incorrect TRON implementation: â›” componentSubCat1 value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentSubCat1.join(", ").toString()),void this._throwError("componentSubCat1 value is incorrect. Pick a standard value : "+this.allowedComponentSubCat1.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: âš ï¸ componentSubCat1 value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedComponentSubCat1.join(", ").toString()),t.componentSubCat1=""}}if(t&&t.componentPlatform){let a=t.componentPlatform;if(!this.allowedcomponentPlatform.includes(a)){if(this.events[e].mandatoryData.indexOf("componentPlatform")>-1)return console.error("Incorrect TRON implementation: â›” componentPlatform value is incorrect, hence this event cannot be tracked. Pick a standard value or a comma separated combination of any of those values: "+this.allowedcomponentPlatform.join(", ").toString()),void this._throwError("componentPlatform value is incorrect. Pick a standard value : "+this.allowedcomponentPlatform.reduce(((e,t)=>`${e},${t}`)),new RangeError);console.warn("Incorrect TRON implementation: âš ï¸ componentPlatform value is incorrect and won't be passed to the web tracking tool. Pick a standard value or a comma separated combination of any of those values: "+this.allowedcomponentPlatform.join(", ").toString()),t.componentPlatform=""}}void 0!==t&&(t.componentVersion&&(this.message.component[0].attributes.componentVersion=t.componentVersion),this.message.component[0].category.componentType=t.componentType||this.component.category.componentType,this.message.component[0].category.subCategory1=t.componentSubCat1||this.component.category.subCategory1,this.message.component[0].componentInfo.componentName=t.componentName||((this.component||"").componentInfo||"").componentName||"",delete this.message.custom.componentVersion),void 0!==t.componentDEVagency&&(this.message.component[0].attributes.componentDEVagency=t.componentDEVagency),void 0!==t.componentPlatform&&(this.message.component[0].attributes.platform=t.componentPlatform);var r={"con >":"configurator","stock >":"stock locator","sales >":"sales","fin >":"finance","rent >":"rental"},c=void 0!==r[o]?r[o]:this.message.component[0].category.primaryCategory;if(""==c||"shared > "==o||"local > "==o)if([".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"].some((e=>window.location.href.includes(e))))if([".bmw.com"].some((e=>window.location.href.includes(e)))){var l=window.location.pathname.split("/");void 0!==l[1]&&"nsc website"==(c=l[1].indexOf("-")>-1?"nsc website":"special website")&&(o="nsc > ")}else c="special website",o="special > ";else c="special website",o="special > ";this.message.component[0].category.primaryCategory=c,void 0!==t&&(this.message.event[0].category.primaryCategory=t.componentName||((this.component||"").componentInfo||"").componentName||""),void 0!==this.message.custom&&"interaction"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].category.subCategory1=t.hashName,this.message.event[0].category.subCategory2=t.linkLocation,"internal click"==this.message.event[0].eventInfo.eventAction&&(this.message.event[0].eventInfo.effect="user clicked on "+t.anchorName+" anchor navigation link"),"scroll"==this.message.event[0].eventInfo.eventAction&&(this.message.event[0].eventInfo.effect="user scrolled to "+t.anchorName+" page section"));var g="undefined"!=typeof scope?scope:this;g.allowedVehicleBodyType=["ca","hb","ko","co","cp","li","mp","ro","sc","st","gf","hc","sh","to","gs","ga","x","xr","gt","gl","r","rs","rr","rt","9p","9s","9u","b","s","9t"],g.allowedVehicleBusinessDivision=["new vehicle","used vehicle","after sales","other"],g.allowedVehicleCategory1=["build to order","pre-order","build to stock","young used car","demonstration car","young used bike","demonstration bike"],g.allowedVehicleFuelType=["b","o","d","e","g","h","m","t","x","y","z"],g.allowedVehicleHybridVersion=["beve","erex","hybr","phev","nohy"],g.allowedVehiclePrimaryCategory=["new car","used car","used bike","new bike","rental bike","rental car","owned bike","owned car"],g.allowedVehicleSeries=["1","2","3","4","5","6","7","8","x","i","m","z","clubman","5-doors","3-doors","cabrio","countryman","ad","gs","he","lt","ms","na","sp"],g.allowedVehicleStatus=["available for sale","sold out","order confirmed","pre-order confirmed","contract concluded","vehicle delivered"],g.allowedVehiclecodeAG=["value should contain only 4 characters"],g.allowedVehiclecodeVG=["value should contain only 4 characters"],g.allowedVehiclerange=["value should contain only 3 characters"],g.allowedVehiclerangeVG=["value should contain only 3 characters OR 4 if the last is 'E'"],g.allowedVehicleItemBasePrice=["value should be numeric"],g.allowedVehicleItemDiscountAmount=["value should be numeric"],g.allowedVehicleItemDiscountPercent=["value should be numeric"],g.allowedVehicleItemPriceWithTax=["value should be numeric"],g.allowedVehicleItemQuantity=["value should be numeric"],g.allowedVehicleItemShippingCost=["value should be numeric"],g.allowedVehicleItemTaxAmount=["value should be numeric"],g.allowedVehicleItemTaxRate=["value should be numeric"],g.allowedTotalBasePrice=["value should be numeric"],g.allowedTotalDiscountAmount=["value should be numeric"],g.allowedTotalDiscountPercent=["value should be numeric"],g.allowedTotalFinalPrice=["value should be numeric"],g.allowedTotalPriceWithTax=["value should be numeric"],g.allowedTotalShippingCost=["value should be numeric"],g.allowedTotalTaxAmount=["value should be numeric"];var p=0;function d(e,t){["codeAG","codeVG","rangeAG","rangeVG"].indexOf(e)<0&&(t="String"==typeof t?(t||"").toLowerCase():t);let a,o={bodyType:{values:g.allowedVehicleBodyType},businessDivision:{values:g.allowedVehicleBusinessDivision},category1:{values:g.allowedVehicleCategory1},codeAG:{condition:"only 4 characters"},codeVG:{condition:"only 4 characters"},fuelType:{values:g.allowedVehicleFuelType},hybridVersion:{values:g.allowedVehicleHybridVersion},primaryCategory:{values:g.allowedVehiclePrimaryCategory},range:{condition:"only 3 characters"},series:{values:g.allowedVehicleSeries},rangeVG:{condition:"only 3 characters OR 4 if the last is 'E'"}};if(o[e]){let n=o[e];n.condition?"only 4 characters"==n.condition?a=4==t.length:"only 3 characters"==n.condition?a=3==t.length:"only 3 characters OR 4 if the last is 'E'"==n.condition&&(a=4==t.length&&"E"==t[t.length-1]||3==t.length):a=o[e].values.indexOf(t)>-1}else a=!0;return a}try{!function(e){let t=["codeAG","codeVG","rangeAG","rangeVG","name","productID","range","modelCode","modelCodeAG","mmdr","mmdrVG"];if(e&&null!=e.vehicle)for(var a=0;a<=e.vehicle.length;a++)for(var o in e.vehicle[a])t.indexOf(o)<0&&(e.vehicle[a][o]="string"==typeof e.vehicle[a][o]?e.vehicle[a][o].toLowerCase():e.vehicle[a][o])}(t),function(e,t,a,o){let n,r=a,i=[],s=Object.keys(o).map((e=>e.toLowerCase()));for(let e=0;e<r.length;e++){let a=r[e];if(a.indexOf("[n]")>-1){let e=a.split("[n]");if("vehicle"==e[0]){let r;void 0!==t[a.split("[n]")[0]]?(n=t[a.split("[n]")[0]][0][a.split("[n]")[1].replace(".","")],r=d(e[1].replace(".",""),n)):r=!1;let c=s.filter((e=>e.includes("vehicle"+a.split("[n]")[1].replace(".","").toLowerCase())));c=c.length>0?c[0]:"";let l=o[Object.keys(o)[s.indexOf(c||"")]]||[];0==r&&(i.push(a),console.error("Incorrect TRON implementation: â›” "+a+" value is incorrect, hence this event cannot be tracked. Pick a standard value: "+l)),void 0===n&&console.error("Incorrect TRON implementation:  â›” mandatory parameter is missing, hence this event cannot be tracked. Please provide the parameter: "+a),"string"==typeof n&&0==n.trim().length&&console.error("Incorrect TRON implementation: â›” "+a+" value is empty, hence this event cannot be tracked. Please provide a valid value: "+l)}}}if(i.length>0)throw`value does not match expected values: ${i}`}(0,t,this.events[e].mandatoryData,this),this.events[e].optionalData&&function(e,t,a,o){let n=a,r=[],i=Object.keys(o).map((e=>e.toLowerCase()));for(let e=0;e<n.length;e++){let a,c=n[e];if(c.indexOf("[n]")>-1){let e=c.split("[n]");if("vehicle"==c.split("[n]")[0]&&t.vehicle&&t.vehicle.length>0)for(var s=0;s<=t.vehicle.length-1;s++)if(a=t[c.split("[n]")[0]][s][c.split("[n]")[1].replace(".","")],a&&""!=a&&0==d(e[1].replace(".",""),a)){let e=i.filter((e=>e.includes("vehicle"+c.split("[n]")[1].replace(".","").toLowerCase())));e=e.length>0?e[0]:"";let a=o[Object.keys(o)[i.indexOf(e)]]||[];t[c.split("[n]")[0]][s][c.split("[n]")[1].replace(".","")]="",r.push(c),console.warn("Incorrect TRON implementation: âš ï¸ "+c+" value is incorrect and won't be passed to the web tracking tool. Pick a standard value: "+a)}}}r.length}(0,t,this.events[e].optionalData,this)}catch(t){return this._throwError("wrong mandatoryData input for function "+e,t),!1}if(this.message.product=[],void 0!==t&&t.vehicle&&t.vehicle.forEach((e=>{let t=JSON.parse(JSON.stringify(this.defaultDatalayer.product[0]));t.productInfo.productID=n&&n.vehicle&&n.vehicle.productID&&""!=n.vehicle.productID?n.vehicle.productID:e.productID||e.codeVG||e.codeAG||"product"+(p+1),t.productInfo.productID.indexOf("product")>-1&&(p+=1),t.productInfo.productName=n&&n.vehicle&&n.vehicle.productName&&""!=n.vehicle.productName?n.vehicle.productName:e.name,t.category.productType=n&&n.vehicle&&n.vehicle.productType&&""!=n.vehicle.productType?n.vehicle.productType:e.businessDivision,t.category.primaryCategory=n&&n.vehicle&&n.vehicle.primaryCategory&&""!=n.vehicle.primaryCategory?n.vehicle.primaryCategory:e.primaryCategory,t.category.subCategory1=n&&n.vehicle&&n.vehicle.subCategory1&&""!=n.vehicle.subCategory1?n.vehicle.subCategory1:e.category1,t.category.subCategory2=n&&n.vehicle&&n.vehicle.subCategory2&&""!=n.vehicle.subCategory2?n.vehicle.subCategory2:e.category2,t.productInfo.manufacturer=n&&n.vehicle&&n.vehicle.manufacturer&&""!=n.vehicle.manufacturer?n.vehicle.manufacturer:e.manufacturer,t.attributes.bodyType=n&&n.vehicle&&n.vehicle.bodyType&&""!=n.vehicle.bodyType?n.vehicle.bodyType:e.bodyType,t.attributes.modelCodeAG=n&&n.vehicle&&n.vehicle.modelCodeAG&&""!=n.vehicle.modelCodeAG?n.vehicle.modelCodeAG:e.codeAG,t.attributes.modelCode=n&&n.vehicle&&n.vehicle.modelCode&&""!=n.vehicle.modelCode?n.vehicle.modelCode:e.codeVG,t.productInfo.color=n&&n.vehicle&&n.vehicle.color&&""!=n.vehicle.color?n.vehicle.color:e.color,t.attributes.motorization=n&&n.vehicle&&n.vehicle.motorization&&""!=n.vehicle.motorization?n.vehicle.motorization:e.engine,t.attributes.fuelType=n&&n.vehicle&&n.vehicle.fuelType&&""!=n.vehicle.fuelType?n.vehicle.fuelType:e.fuelType,t.attributes.gearing=n&&n.vehicle&&n.vehicle.gearing&&""!=n.vehicle.gearing?n.vehicle.gearing:e.gearing,t.attributes.hybridVersion=n&&n.vehicle&&n.vehicle.hybridVersion&&""!=n.vehicle.hybridVersion?n.vehicle.hybridVersion:e.hybridVersion,t.attributes.mmdr=n&&n.vehicle&&n.vehicle.mmdr&&""!=n.vehicle.mmdr?n.vehicle.mmdr:e.range,t.attributes.mmdrVG=n&&n.vehicle&&n.vehicle.mmdrVG&&""!=n.vehicle.mmdrVG?n.vehicle.mmdrVG:e.rangeVG,t.attributes.series=n&&n.vehicle&&n.vehicle.series&&""!=n.vehicle.series?n.vehicle.series:e.series,t.attributes.modelName=n&&n.vehicle&&n.vehicle.modelName&&""!=n.vehicle.modelName?n.vehicle.modelName:e.subSeries,t.attributes.status=n&&n.vehicle&&n.vehicle.status&&""!=n.vehicle.status?n.vehicle.status:e.status,t.attributes.trim=n&&n.vehicle&&n.vehicle.trim&&""!=n.vehicle.trim?n.vehicle.trim:e.trim,t.attributes.productionYear=n&&n.vehicle&&n.vehicle.productionYear&&""!=n.vehicle.productionYear?n.vehicle.productionYear:e.yearOfProduction,t.attributes.yearOfRegistration=n&&n.vehicle&&n.vehicle.yearOfRegistration&&""!=n.vehicle.yearOfRegistration?n.vehicle.yearOfRegistration:e.yearOfRegistration,t.attributes.encVIN=n&&n.vehicle&&n.vehicle.encVIN&&""!=n.vehicle.encVIN?n.vehicle.encVIN:e.encVIN,this.message.product.push(t)})),void 0!==t&&t.componentVersion&&(this.message.component[0].attributes.componentVersion=t.componentVersion,this.message.event[0].category.primaryCategory=t.componentName||this.message.component[0].componentInfo.componentName),void 0!==t&&(this.message.component[0].componentInfo.componentID=t.pageBrand||s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("motorrad")>-1?"motorrad":""),this.message.component[0].componentInfo.componentID+=" > "+(t.pageGeoRegion||s("page.pageInfo.geoRegion")||""),this.message.component[0].componentInfo.componentID+=" > "+(t.componentName||this.message.component[0].componentInfo.componentName),"form"==this.message.event[0].eventInfo.eventName&&(this.message.component[0].componentInfo.componentID+=" "+t.formType)),void 0!==this.message.event[0].eventInfo.effect&&(this.message.event[0].eventInfo.effect=o+this.message.event[0].eventInfo.effect,this.message.event[0].eventInfo.timeStamp=this.message.event[0].timeStamp,delete this.message.event[0].timeStamp),("page view"!=this.message.event[0].eventInfo.eventName||"aem page loaded"!=(((window.adobeDataLayer||"")[0]||"").event||""))&&void 0!==i("page")&&"string"!=typeof i("page")){var m=JSON.parse(JSON.stringify(s("page.attributes")))||{};m.brand=s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("bmw-motorrad")>-1?"bmw-motorrad":""),m.pageTitle=s("page.title")||s("page.pageInfo.pageTitle")||document.title,m.timeZone=s("page.attributes.timeZone")||"",this.message.page={attributes:JSON.parse(JSON.stringify(m)),category:{pageType:s("page.category.pageType")||s("page.category.formType")||s("page.category.primaryTags"),primaryCategory:"NBC"==s("page.attributes.template")?"configurator":"object"==typeof s("page.category.primaryTags")?s("page.category.primaryTags.0"):s("page.pageHier")||s("page.category.subCategory01")||s("page.category.primaryCategory")||s("page.primarySection")||s("page.category.primaryTags")||"homepage",subCategory1:"object"==typeof s("page.category.secondaryTags")?s("page.category.secondaryTags.0"):s("page.pageLevel2")||s("page.category.subCategory01")||s("page.category.purchaseReason")||s("page.category.subCategory1")||"content",subCategory2:s("page.pageLevel3")||s("page.category.subCategory02")||s("page.category.subCategory2"),subCategory3:s("page.pageLevel4")||s("page.category.subCategory03")||s("page.category.subCategory3")},pageInfo:{author:s("page.pageInfo.author"),destinationURL:s("page.url")||s("page.pageInfo.destinationUrl")||s("page.pageInfo.destinationURL"),geoRegion:window.location.href.split("country=").length>1?window.location.href.split("country=")[1].split("&")[0]:window.location.href.split("country=").length>1?window.location.href.split("country_origin=")[1].split("&")[0]:s("page.pageInfo.geoRegion")||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[1]:window.location.host.indexOf("bmwusa")>-1?"US":""),language:s("page.pageInfo.language").slice(0,2)||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":""),pageID:s("page.path")||s("page.name")||s("page.pageInfo.pageInstanceId")||window.dataLayer&&window.dataLayer.pages&&(window.dataLayer.pages[0]||"").pageInstanceId||s("page.pageInfo.pageID"),pageName:s("page.name")||s("page.pageInfo.pageName"),referringURL:s("page.pageInfo.referringUrl")||s("page.pageInfo.referringURL")||document.referrer,sysEnv:s("page.pageInfo.devEnv")||s("page.pageInfo.envWork")||s("page.pageInfo.sysEnv"),variant:s("page.pageInfo.variant")||"true"==s("page.attributes.virtualPage")?"virtual page":"real page",version:"acdl: "+s("page.pageInfo.version")}}}void 0!==t&&void 0===t.vehicle&&"error"!=t.eventName&&void 0!==i("product")&&"string"!=typeof i("product")&&(this.message.product=i("product")),void 0!==i("user")&&"string"!=typeof i("user")&&(this.message.user=i("user")),void 0!==t&&void 0===t.dealer&&void 0!==i("dealer")&&"string"!=typeof i("dealer")&&(this.message.dealer=i("dealer")),void 0!==this.message.custom&&"error"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].eventInfo.effect=t.errorMessage?o+t.errorMessage:"",this.message.event[0].eventInfo.eventAction=t.errorAction,this.message.event[0].eventInfo.cause=t.errorCause,this.message.event[0].eventInfo.type=t.errorType,this.message.event[0].category.primaryCategory=t.componentName||this.message.component[0].componentInfo.componentName,this.message.event[0].category.subCategory1=t.errorCode,this.message.event[0].category.subCategory2=t.errorOrigin,this.message.event[0].attributes.requestedURL=t.errorURL,delete this.message.event[0].type,delete this.message.event[0].action,delete this.message.event[0].cause,delete this.message.event[0].effect),this.message.component[0].componentInfo.componentID=this.message.page.attributes.brand+"/"+this.message.page.pageInfo.geoRegion+"_"+this.message.page.pageInfo.language+"/"+this.message.component[0].componentInfo.componentName,this.message.page.pageInfo.pageID="/"+this.message.page.category.pageType+"/"+this.message.page.attributes.brand+"/"+this.message.page.pageInfo.geoRegion+"/"+this.message.page.pageInfo.language+"/"+this.message.page.category.primaryCategory+"/",void 0!==this.message.page.category.subCategory1&&""!=this.message.page.category.subCategory1&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory1+"/"),void 0!==this.message.page.category.subCategory2&&""!=this.message.page.category.subCategory2&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory2+"/"),void 0!==this.message.page.category.subCategory3&&""!=this.message.page.category.subCategory3&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory3+"/"),this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+(this.message.page.pageInfo.pageName.split(" > ").length>0&&this.message.page.pageInfo.pageName.split(" > ")[1]||this.message.page.pageInfo.pageName),this._debug("ðŸ’² payload created",this.message),this._sendMessage()}_checkmandatoryData(e,t){let a,o=this.events[e].mandatoryData,n=!0,r="";for(let e=0;e<o.length;e++){let i,s=o[e];if(s.indexOf("[n]")>-1){let e=s.split("[n]");r=e[1].replace(".",""),i=t[e[0]]&&t[e[0]][0][r]}else i=t[s];if(void 0===i)switch(s){case"componentType":i=this.component.category.componentType;break;case"componentName":i=this.component.componentInfo.componentName;break;case"componentSubCat1":i=this.component.category.subCategory01}a=this._checkValidValue("mandatory",s,r,i),0==a&&(n=!1)}if(0==n)throw new SyntaxError(`value does not match expected values: ${n}`);return!0}_checkOptionalData(e,t){let a,o=this.events[e].optionalData,n=!0,r="";for(let e=0;e<o.length;e++){let i,s=o[e];if(s.indexOf("[n]")>-1){let e=s.split("[n]");t[e[0]]&&t[e[0]].length>0&&(r=e[1].replace(".",""),i=t[e[0]][0][r],i&&""==i&&errArrayVal.push(s))}else i=t[s];void 0===i&&void 0===t[s]||(a=this._checkValidValue("optional",s,r,i),0==a&&(s.indexOf("[n]")>-1?t[s.split("[n]")[0]][0][s.split("[n]")[1].replace(".","")]="":t[s]="",n=!1))}return!0}_checkValidValue(e,t,a,o){let n=!0,r=Object.keys(this).map((e=>e.toLowerCase()));a=""!=a&&t.indexOf("[n]")>-1?t.replace("[n].",""):t;let i=r.filter((e=>e.includes(a.toLowerCase()))),s="object"==typeof this[Object.keys(this)[r.indexOf(i[0])]]?this[Object.keys(this)[r.indexOf(i[0])]]:[];if(s=s.filter((function(e){return""!==e})),void 0===(o="string"==typeof o?(o||"").toLowerCase():o)&&"mandatory"==e&&(console.error("Incorrect TRON implementation: â›” mandatory parameter is missing, hence this event cannot be tracked. Please provide the parameter: "+t),n=!1),"string"==typeof o&&0==o.trim().length&&"mandatory"==e&&(console.error("Incorrect TRON implementation: â›” "+t+" value is empty, hence this event cannot be tracked. Please provide a valid value: "+s.join(", ").toString()),n=!1),Array.isArray(s)&&s.length>0&&!s.includes(o)){if(t.indexOf("vehicle")>-1&&(t=t.split(".")[1],["codeAG","codeVG","range","rangeVG"].indexOf(t)>-1))return!0;if(["formLeadType","formComChannel","dealer[n].selectionState","options[n].code","options[n].codeVG","options[n].category1"].indexOf(t)>-1&&void 0!==o)return!0;if(1==s.length&&"value should be numeric"==s[0])return!0;"mandatory"==e?(console.error("Incorrect TRON implementation: â›” "+t+" value is incorrect, hence this event cannot be tracked. Pick a standard value: "+s.join(", ").toString()),n=!1):"optional"==e&&(console.warn("Incorrect TRON implementation: âš ï¸ "+t+" value is incorrect and won't be passed to the web tracking tool. Pick a standard value: "+s.join(", ").toString()),n=!1)}return n}_checkValidOption(e,t){let a=[];switch(e){case"errorType":a=this._validErrorTypes;break;case"errorAction":a=this._validErrorActions}if(!a.includes(t))throw new TypeError(`provided value '${t}' for field '${e}' is not part of standard list`);return!0}_loadEventData(e,t){const a=Object.assign({},JSON.parse(JSON.stringify(this.defaultDatalayer)));a.component[0]=Object.assign({},JSON.parse(JSON.stringify(this.component)));const o=JSON.parse(JSON.stringify(this.defaultDatalayer.event[0])),r=JSON.parse(JSON.stringify(this.baseEvent)),i=JSON.parse(JSON.stringify(this.events[e].event));a.event[0]=[o,r,i].reduce(this._deepMerge.bind(this),{}),a.event[0].timeStamp=(new Date).getTime(),n.pageExist&&void 0!==a.page&&(this.events[e].page?a.page=Object.assign({},JSON.parse(JSON.stringify(this.page)),JSON.parse(JSON.stringify(this.events[e].page))):a.page=Object.assign({},JSON.parse(JSON.stringify(this.page)))),n.projConditionCheck&&n.projectCondition(this,e,t),this.events[e].custom=this.events[e].custom?this.events[e].custom:{};const s=JSON.parse(JSON.stringify(this.baseCustom)),c=JSON.parse(JSON.stringify(this.events[e].custom));return a.custom=[s,c].reduce(this._deepMerge.bind(this),{}),a.version="tron_"+this._TronVersion+"__"+this._componentTrackingVersion,a}_throwError(e,t){e.indexOf("value does not match")>-1||e.indexOf("input for function")>-1||e.indexOf("in mandatoryData")>-1||e.indexOf("could not create/send")>-1||e.indexOf("incorrect")>-1||e.indexOf("SyntaxError: value does not match expected values")>-1?console.error(this.version):console.error("Incorrect TRON implementation: â›” ",this.version,"\r\n",e,"\r\n",t.name+":"+t.message)}_debug(e,t){this.debug&&console.info(this.version,"\r\n",e,"\r\n",t)}_sendMessage(){this._debug("âŒ› sending data..."),this._sendCustomEvent(),this._sendGenericEvent(),this._sendPostMessage(),this.message={}}_sendCustomEvent(){let e=!1;try{e=new CustomEvent(this.customEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(e)}catch(e){return console.error("Incorrect TRON implementation: â›” custom event created was not sent, hence this event cannot be tracked. Please check the error:",e),this._throwError("could not create/send custom event",e),!1}this._debug("âœ… custom event successfully sent",e)}_sendGenericEvent(){let e=!1;try{e=new CustomEvent(this.genericEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(e)}catch(e){return console.error("Incorrect TRON implementation: â›” custom event created was not sent, hence this event cannot be tracked. Please check the error:",e),this._throwError("could not create/send generic event",e),!1}this._debug("âœ… generic event successfully sent",e)}_sendPostMessage(){let e=!1;try{e=JSON.parse(JSON.stringify({methodName:"TRON: postMessage",detail:this.message,type:"TRON: generic iframe event listener"})),window.top.postMessage(JSON.stringify(e),"*")}catch(e){return console.error("Incorrect TRON implementation: â›” custom event created was not sent, hence this event cannot be tracked. Please check the error:",e),this._throwError("could not create/send postMessage",e),!1}this._debug("âœ… postmessage successful sent",e)}_deepMerge(e,t){return Object.entries(t).forEach((([t,a])=>{a&&"object"==typeof a?this._deepMerge(e[t]=e[t]||{},a):e[t]=a})),e}},window.onerror=function(){if(arguments.length>0&&"string"==typeof arguments[0]&&arguments[0].indexOf("Uncaught TypeError: ")>-1&&arguments[0].indexOf("not a function")>-1){var e=arguments[0].split("Uncaught TypeError: ")[1].split("is not a function")[0];return console.error("Incorrect TRON implementation: â›” this function "+e+" does not exist , hence this event cannot be tracked. Please make sure to use a correct reference name!","\n","Error Occured at:",arguments),!0}return!1},TRON.isInitialized||(window.addEventListener("TRON: adobeDataLayer generic event listener",(function(e){if(window.tronDetailDL=e.detail,window.adobeDataLayer=window.adobeDataLayer||[],tronDetailDL.page&&tronDetailDL.page.pageInfo&&void 0!==tronDetailDL.page.pageInfo.pageName&&"tbd"!=tronDetailDL.page.pageInfo.pageName&&window.adobeDataLayer.push({page:tronDetailDL.page}),tronDetailDL.page&&tronDetailDL.page.pageInfo&&"tbd"==tronDetailDL.page.pageInfo.pageName&&void 0!==i("page")&&"string"!=typeof i("page")){var t=JSON.parse(JSON.stringify(s("page.attributes")))||{};t.brand=s("page.attributes.brand")||(window.location.hostname.indexOf("bmw")>-1?"bmw":window.location.hostname.indexOf("mini")>-1?"mini":window.location.hostname.indexOf("bmw-motorrad")>-1?"bmw-motorrad":""),t.pageTitle=s("page.title")||s("page.pageInfo.pageTitle")||document.title,t.timeZone=s("page.attributes.timeZone")||"";var a={page:{attributes:JSON.parse(JSON.stringify(t)),category:{pageType:s("page.category.pageType")||s("page.category.formType")||s("page.category.primaryTags"),primaryCategory:"NBC"==s("page.attributes.template")?"configurator":"object"==typeof s("page.category.primaryTags")?s("page.category.primaryTags.0"):s("page.pageHier")||s("page.category.subCategory01")||s("page.category.primaryCategory")||s("page.primarySection")||s("page.category.primaryTags")||"homepage",subCategory1:"object"==typeof s("page.category.secondaryTags")?s("page.category.secondaryTags.0"):s("page.pageLevel2")||s("page.category.subCategory01")||s("page.category.purchaseReason")||s("page.category.subCategory1")||"content",subCategory2:s("page.pageLevel3")||s("page.category.subCategory02")||s("page.category.subCategory2"),subCategory3:s("page.pageLevel4")||s("page.category.subCategory03")||s("page.category.subCategory3")},pageInfo:{author:s("page.pageInfo.author"),destinationURL:s("page.url")||s("page.pageInfo.destinationUrl")||s("page.pageInfo.destinationURL"),geoRegion:window.location.href.split("country=").length>1?window.location.href.split("country=")[1].split("&")[0]:window.location.href.split("country=").length>1?window.location.href.split("country_origin=")[1].split("&")[0]:s("page.pageInfo.geoRegion")||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[1]:window.location.host.indexOf("bmwusa")>-1?"US":""),language:s("page.pageInfo.language").slice(0,2)||(s("page.pageInfo.language").indexOf("-")>-1?s("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":""),pageID:s("page.path")||s("page.name")||s("page.pageInfo.pageInstanceId")||window.dataLayer&&window.dataLayer.pages&&(window.dataLayer.pages[0]||"").pageInstanceId||s("page.pageInfo.pageID"),pageName:s("page.name")||s("page.pageInfo.pageName"),referringURL:s("page.pageInfo.referringUrl")||s("page.pageInfo.referringURL")||document.referrer,sysEnv:s("page.pageInfo.devEnv")||s("page.pageInfo.envWork")||s("page.pageInfo.sysEnv"),variant:s("page.pageInfo.variant")||"true"==s("page.attributes.virtualPage")?"virtual page":"real page",version:"acdl: "+s("page.pageInfo.version")}}};a.pageInfo.pageID="/"+a.category.pageType+"/"+a.attributes.brand+"/"+a.pageInfo.geoRegion+"/"+a.pageInfo.language+"/"+a.category.primaryCategory+"/"+a.category.subCategory1+"/"+a.category.subCategory2+"/"+a.category.subCategory3+"/"+(a.pageInfo.pageName.split(" > ").length>0&&a.pageInfo.pageName.split(" > ")[1]||a.pageInfo.pageName),window.adobeDataLayer.push(a)}let o={},n=tronDetailDL.component[0].componentInfo.componentID;o[n]=tronDetailDL.component[0],window.adobeDataLayer.push({component:o,version:tronDetailDL.version});var r={},c={},l=tronDetailDL.product;if(l.length>0&&"string"!=typeof l){for(var g in l){var p=l[g].productInfo.productID;void 0===p&&(p="product"+(g+1)),r[p]=l[g]}Object.keys(r).forEach((e=>c[e]="")),window.adobeDataLayer.push({product:r})}var d={},m=e.detail.cart;if(m&&m.item.length>0&&"string"!=typeof m){("commerce"!=tronDetailDL.event[0].eventInfo.eventName||"cart"!=tronDetailDL.event[0].eventInfo.type&&"checkout"!=tronDetailDL.event[0].eventInfo.type)&&""==(((e.detail||"").cart||"").cartID||"")||(d=Object.assign({},r));var u={item:d,price:e.detail.cart.price||{},cartID:e.detail.cart.cartID||""};window.adobeDataLayer.push({cart:u})}var h={},v=e.detail.transaction;if(v&&v.item.length>0&&"string"!=typeof v){("commerce"==tronDetailDL.event[0].eventInfo.eventName&&"order"==tronDetailDL.event[0].eventInfo.type||""!=(((e.detail||"").transaction||"").transactionID||""))&&(h=Object.assign({},r));var f={item:h,total:e.detail.transaction.total||{},transactionID:e.detail.transaction.transactionID||""};window.adobeDataLayer.push({transaction:f})}var y={},b={},w=tronDetailDL.dealer;if(w.length>0&&"string"!=typeof w){for(var g in w)y[w[g].dealerInfo.dealerOutletBuno]=w[g];Object.keys(y).forEach((e=>b[e]="")),window.adobeDataLayer.push({dealer:y})}if(tronDetailDL.user.length>0&&"string"!=typeof tronDetailDL.user){var I={},O=tronDetailDL.user;for(var g in O){var N={};if(Array.isArray(O[g].profile)&&O[g].profile.length>0)for(var D in O[g].profile)N[T=null!=O[g].profile[D].profileInfo.profileID?O[g].profile[D].profileInfo.profileID:"profile"+(D+1)]=JSON.parse(JSON.stringify(O[g].profile[D]));else if(void 0===O[g].profile&&void 0!==O[g].profileInfo&&!Array.isArray(O[g].profileInfo)){var T="profile"+(g+1);N.profile={},N.profile[T]=JSON.parse(JSON.stringify(O[g].profileInfo))}var C="user"+(g+1);I[C]=JSON.parse(JSON.stringify(O[g])),I[C].profile=JSON.parse(JSON.stringify(N))}tronDetailDL.user=JSON.parse(JSON.stringify(I)),window.adobeDataLayer.push({user:tronDetailDL.user})}var k={event:"page view"==tronDetailDL.event[0].eventInfo.eventName?"tron page view":"tron event",eventInfo:{cause:tronDetailDL.event[0].eventInfo.cause,effect:tronDetailDL.event[0].eventInfo.effect,eventAction:tronDetailDL.event[0].eventInfo.eventAction,eventName:tronDetailDL.event[0].eventInfo.eventName,eventPoints:tronDetailDL.event[0].eventInfo.eventPoints,timeStamp:tronDetailDL.event[0].eventInfo.timeStamp,type:tronDetailDL.event[0].eventInfo.type,category:tronDetailDL.event[0].category,attributes:tronDetailDL.event[0].attributes,reference:{linkedComponent:n,linkedProducts:c,linkedDealers:b}}};window.adobeDataLayer.push(k)})),TRON.isInitialized=!0)},690:function(e,t,a){var o,n;o=[t,a(579)],void 0===(n=function(e,a){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0;var n=(a=(o=a)&&o.__esModule?o:{default:o}).default;t.default=n}.apply(t,o))||(e.exports=n)}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,a),r.exports}return a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(690)}()}));